<!DOCTYPE html>
<html lang="en-US"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Giải Thuật Lập Trình · Cây hậu tố — Suffix Tree</title>
    <link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Cây hậu tố -- Suffix Tree Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=420">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.giaithuatlaptrinh.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.2"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="woocommerce-layout-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/woocommerce-layout.css" type="text/css" media="all">
<link rel="stylesheet" id="woocommerce-smallscreen-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/woocommerce-smallscreen.css" type="text/css" media="only screen and (max-width: 768px)">
<link rel="stylesheet" id="woocommerce-general-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/woocommerce.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/dashicons.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-jquery-ui-dialog-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jquery-ui-dialog.css" type="text/css" media="all">
<link rel="stylesheet" id="ajax_shoutbox-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/ajax_shoutbox.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jquery_002.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/related-posts.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/tarski.js"></script>
<meta name="description" content="Wiki về giải thuật">
<meta name="robots" content="all">
<link rel="profile" href="http://gmpg.org/xfn/11">

<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/style.css" type="text/css" media="all">
<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/print.css" type="text/css" media="print">

<link rel="https://api.w.org/" href="http://www.giaithuatlaptrinh.com/?rest_route=/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.giaithuatlaptrinh.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.giaithuatlaptrinh.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Thuật toán Pollard-Rho phân tích ra thừa số-- Pollard-Rho algorithm" href="http://www.giaithuatlaptrinh.com/?p=393">
<link rel="next" title="Thuật toán  McCreight xây dựng cây hậu tố --  McCreight Algorithm" href="http://www.giaithuatlaptrinh.com/?p=451">
<meta name="generator" content="WordPress 4.5.2">
<meta name="generator" content="WooCommerce 2.5.5">
<link rel="canonical" href="http://www.giaithuatlaptrinh.com/?p=420">
<link rel="shortlink" href="http://wp.me/p6zINC-6M">
<link rel="alternate" type="application/json+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D420">
<link rel="alternate" type="text/xml+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D420&amp;format=xml">

<link rel="dns-prefetch" href="http://v0.wordpress.com/">
<link rel="dns-prefetch" href="http://i0.wp.com/">
<link rel="dns-prefetch" href="http://i1.wp.com/">
<link rel="dns-prefetch" href="http://i2.wp.com/">
<style type="text/css">img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Cây hậu tố -- Suffix Tree">
<meta property="og:url" content="http://www.giaithuatlaptrinh.com/?p=420">
<meta property="og:description" content="Trong bài trước ta đã tìm hiểu các thuật toán tìm kiếm xâu với thời gian $$O(n+m)$$ trong đó $$n$$ là độ dài của văn bản và $$m$$ là độ dài của xâu tìm kiếm. Mỗi thuật toán có đặc tính và ứng dụng …">
<meta property="article:published_time" content="2015-08-18T19:39:58+00:00">
<meta property="article:modified_time" content="2015-08-28T06:02:19+00:00">
<meta property="og:site_name" content="Giải Thuật Lập Trình">
<meta property="og:image" content="http://www.giaithuatlaptrinh.com/wp-content/uploads/2015/08/insert-suffix.png">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary">
<link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/shCore.css" type="text/css" rel="stylesheet"><link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/shThemeDefault.css" type="text/css" rel="stylesheet"><style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/services.css"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body id="post-cay-hau-to-suffix-tree" class="single single-post postid-420 single-format-standard centre"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div style="display: none;" id="MathJax_Message"></div>

<div id="wrapper" class="tarski">
    <div id="header">
        <div id="title">
	<h1 id="blog-title"><a title="Return to main page" href="http://www.giaithuatlaptrinh.com/" rel="home">Giải Thuật Lập Trình</a></h1>
	<p id="tagline">Wiki về giải thuật</p></div>
<div id="navigation" class="clearfix">        <ul id="menu-primary-navigation" class="primary xoxo">
            <li><a title="Return to front page" href="http://www.giaithuatlaptrinh.com/">Home</a></li>
            <li class="page_item page-item-2"><a href="http://www.giaithuatlaptrinh.com/?page_id=2">About</a></li>
<li class="page_item page-item-4"><a href="http://www.giaithuatlaptrinh.com/?page_id=4">Các bài đã viết</a></li>

    </ul><div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div></div><script type="text/javascript">
    jQuery(document).ready(function() {
        var container = jQuery('#navigation > ul'),
            navbar;
        
        if (container.length > 0) {
            navbar = new Tarski.Navbar(container);
        }
    });
</script><p class="primary-span articlenav"><span class="previous-entry"><a href="http://www.giaithuatlaptrinh.com/?p=393" rel="prev">‹ Thuật toán Pollard-Rho phân tích ra thừa số-- Pollard-Rho algorithm</a></span> <span class="separator">&nbsp;•&nbsp;</span> <span class="next-entry"><a href="http://www.giaithuatlaptrinh.com/?p=451" rel="next">Thuật toán  McCreight xây dựng cây hậu tố --  McCreight Algorithm ›</a></span></p>
    </div>
    
    <div id="content" class="clearfix">

<div class="primary">
        
                
                        
                <div class="entry post-420 post type-post status-publish format-standard hentry category-uncategorized tag-string-matching tag-string-query tag-suffix-tree">
                
                    <div class="meta">
                        <h1 class="title entry-title">Cây hậu tố -- Suffix Tree</h1>                        
                        <p class="metadata"><span class="date updated">August 18, 2015</span> in <span class="categories"><a href="http://www.giaithuatlaptrinh.com/?cat=1" rel="category">Uncategorized</a></span> | <a class="comments-link" href="http://www.giaithuatlaptrinh.com/?p=420#respond">No comments</a></p>                    </div>
                    
                    <div class="content clearfix">
                                                <p>Trong bài trước ta đã tìm hiểu các thuật toán tìm kiếm xâu với thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-1-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-1" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.11em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-3" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-4" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-5" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-6" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-7" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-8" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-1" type="math/tex">O(n+m)</script> trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-2-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-9" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-10" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-11" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-2" type="math/tex">n</script> là độ dài của văn bản và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-3-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-12" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.84em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-13" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-14" class="mi">m</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script id="MathJax-Element-3" type="math/tex">m</script> là độ dài của xâu tìm kiếm. Mỗi thuật toán có đặc tính và ứng dụng riêng [2]: <a href="http://www.giaithuatlaptrinh.com/?p=250" target="_blank">thuật toán Z</a> là thuật toán tìm kiếm tuyến tính đơn giản nhất, <a href="http://www.giaithuatlaptrinh.com/?p=245" target="_blank">thuật toán Boyer-Moore</a> là thuật toán có thời gian sublinear trong thực tế, <a href="http://www.giaithuatlaptrinh.com/?p=238" target="_blank">thuật toán Knuth-Morris-Pratt</a>
 có ý nghĩa về mặt lịch sử cũng như ý tưởng của thuật toán và thuật toán
 này còn có thể được mở rộng ra trong trường hợp thời gian thực và tìm 
kiếm một tập nhiều mẫu, <a href="http://www.giaithuatlaptrinh.com/?p=290" target="_blank">thuật toán Rabin-Karp</a> được <a href="https://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_algorithm" target="_blank">mở rộng và áp dụng</a> trong phát hiện đạo văn.  </p>
<p>Tuy nhiên, tất cả các thuật toán này đều rất khó mở rộng khi chúng ta
 muốn thực hiện các truy vấn (query) văn bản. Một số truy vấn thường gặp
 như:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Problem 1: </b></a> Cho một văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-4-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-15" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-16" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-17" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-18" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-19" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-20" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-21" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-22" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-23" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-24" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-25" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-26" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-4" type="math/tex">T[1,2,\ldots,n]</script> và một xâu mẫu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-5-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-27" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-28" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-29" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-30" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-31" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-32" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-33" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-34" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-35" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-36" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-37" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-38" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-5" type="math/tex">P[1,2,\ldots,m]</script> với các kí tự trong bảng chữ cái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-6-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-39" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.69em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-40" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-41" class="mi">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi></math></span></span><script id="MathJax-Element-6" type="math/tex">\Sigma</script>, thực hiện các truy vấn sau:<p></p>
<ol>
<li> Xác định xem <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-7-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-42" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-43" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-44" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-7" type="math/tex">P</script> có phải là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-8-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-45" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-46" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-47" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-8" type="math/tex">T</script> hay không?</li>
<li> Xác định xem <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-9-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-48" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-49" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-50" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-9" type="math/tex">P</script> có phải là một hậu tố<sup><a href="#suffix">[1]</a></sup> (suffix) của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-10-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-51" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-52" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-53" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-10" type="math/tex">T</script> hay không?</li>
<li> Đếm sự xuất hiện của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-11-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-54" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-55" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-56" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-11" type="math/tex">P</script> trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-12-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-57" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-58" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-59" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-12" type="math/tex">T</script>?</li>
<li> Tìm xâu con chung dài nhất của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-13-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-60" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-61" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-62" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-13" type="math/tex">T</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-14-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-63" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-64" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-65" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-14" type="math/tex">P</script>?</li>
<li> Tìm xâu con dài nhất xuất hiện ít nhất 2 lần trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-15-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-66" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-67" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-68" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-15" type="math/tex">T</script>?</li>
<li> Tìm hậu tố xuất hiện đầu tiên theo thứ tự từ điển của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-16-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-69" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-70" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-71" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-16" type="math/tex">T</script>?</li>
</ol>
</div>
<p>&nbsp;<br>
Ngoài hai truy vấn cuối cùng, các truy vấn còn lại có thể được thực hiện lặp đi lặp lại với các xâu mẫu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-17-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-72" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-73" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-74" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-17" type="math/tex">P</script> khác nhau. Ta có thể tưởng tượng trong thực tế văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-18-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-75" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-76" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-77" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-18" type="math/tex">T</script> có kích thước lớn còn xâu mẫu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-19-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-78" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-79" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-80" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-19" type="math/tex">P</script> có kích thước nhỏ. Do đó, một truy vấn có thể coi là <b>hiệu quả</b> nếu thời gian thực hiện truy vấn chỉ phụ thuộc vào độ dài của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-20-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-81" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-82" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-83" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-20" type="math/tex">P</script>, không phụ thuộc vào độ dài của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-21-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-84" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-85" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-86" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-21" type="math/tex">T</script>. Phương pháp đầu tiên chúng ta có thể nghĩ tới đó là tìm một cách biểu diễn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-22-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-87" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-88" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-89" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-22" type="math/tex">T</script> sao cho việc thực hiện các truy vấn được thực hiện hiệu quả. Thời gian để biểu diễn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-23-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-90" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-91" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-92" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-23" type="math/tex">T</script> sẽ được tính vào thời gian tiền xử lí. Thông thường, thời gian tiền xử lí là khá lớn. </p>
<p>Cây hậu tố (suffix tree), được đề xuất bởi Weiner [1] vào năm 1973, là một trong những cách biểu diễn có thể trả lời <b>tất cả</b> các truy vấn trên một cách hiệu quả. Điều đặc biệt là cây hậu tố có thể được xây dựng trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-24-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.815em; display: inline-block;" role="math" id="MathJax-Span-93" class="math"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.01em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-94" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-95" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-96" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-97" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-98" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-24" type="math/tex">O(n)</script>.  Knuth, theo <a href="https://en.wikipedia.org/wiki/Suffix_tree" target="_blank">Wikipedia</a>, đã gọi thuật toán xây dựng cây hậu tố của Winer là "giải thuật của năm 1973".</p>
<p><strong><font size="4">Cây hậu tố là gì?</font></strong></p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Definition (Suffix Tree): </b></a> Cây hậu tố, kí hiệu là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-25-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-99" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-100" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-101" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-102" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-25" type="math/tex">Ts</script>, của một văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-26-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-103" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-104" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-105" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-106" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-107" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-108" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-109" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-110" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-111" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-112" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-113" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-114" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-26" type="math/tex">T[1,2,\ldots,n]</script> là một cây biểu diễn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-27-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-115" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-116" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-117" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-27" type="math/tex">T</script> với các tính chất sau:<p></p>
<ol>
<li> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-28-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-118" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-119" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-120" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-121" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-28" type="math/tex">Ts</script> có <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-29-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-122" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-123" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-124" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-29" type="math/tex">n</script> nút lá được đánh số <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-30-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.856em; display: inline-block;" role="math" id="MathJax-Span-125" class="math"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1004.37em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-126" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-127" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-128" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-129" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-130" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-131" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-132" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-133" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.308em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi></math></span></span><script id="MathJax-Element-30" type="math/tex">1,2,\ldots,n</script>, mỗi lá tương ứng với một hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-31-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-134" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-135" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-136" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-31" type="math/tex">T</script>.</li>
<li>Mỗi nút trong (internal node) có ít nhất 2 nút con. </li>
<li>Mỗi cạnh của cây được gán cho một nhãn là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-32-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-137" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-138" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-139" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-32" type="math/tex">T</script>.</li>
<li>Ghép (concatenation) nhãn của các cạnh trên đương đi từ gốc của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-33-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-140" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-141" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-142" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-143" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-33" type="math/tex">Ts</script> tới lá thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-34-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-144" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-145" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-146" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-34" type="math/tex">i</script> là hậu tố bắt đầu từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-35-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-147" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-148" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-149" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-35" type="math/tex">i</script> (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-36-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.555em; display: inline-block;" role="math" id="MathJax-Span-150" class="math"><span style="display: inline-block; position: relative; width: 7.169em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.05em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-151" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-152" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-153" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-154" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-155" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-156" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-157" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-158" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-159" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-160" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-161" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-162" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-163" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-36" type="math/tex">T[i,i+1,\ldots,n]</script>) của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-37-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-164" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-165" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-166" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-37" type="math/tex">T</script>.</li>
<li>Nhãn của các cạnh cùng một nút cha tới các nút con bắt đầu từ các kí tự khác nhau.</li>
</ol>
</div>
<p>&nbsp;<br>
Ví dụ: <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-38-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.336em; display: inline-block;" role="math" id="MathJax-Span-167" class="math"><span style="display: inline-block; position: relative; width: 10.011em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1009.98em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-168" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-169" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-170" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-171" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-172" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-173" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-174" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-175" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-176" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-177" class="mn">6</span><span style="font-family: MathJax_Main;" id="MathJax-Span-178" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-179" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-180" class="texatom"><span id="MathJax-Span-181" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-182" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-183" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-184" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-185" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-186" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-187" class="mi">c</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>6</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">x</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi></mrow></math></span></span><script id="MathJax-Element-38" type="math/tex">T[1,2,\ldots,6] = \mathrm{xabxac}</script>, hình dưới đây biểu diễn cây hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-39-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-188" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-189" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-190" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-191" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-39" type="math/tex">Ts</script> với 6 nút lá.<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/suffix-ex.png" alt="suffix-ex" width="295" height="185"><br>
Một điều đặc biệt chú ý là <b>không phải mọi xâu đều có cây hậu tố biểu diễn tương ứng</b>. Ví dụ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-40-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-192" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.6em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-193" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-194" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-195" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-196" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-197" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-198" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-199" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-200" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-201" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-202" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-203" class="texatom"><span id="MathJax-Span-204" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-205" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-206" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-207" class="mi">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">x</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">x</mi></mrow></math></span></span><script id="MathJax-Element-40" type="math/tex">T[1,2,3] = \mathrm{xcx}</script>
 không có cây hậu tố biểu diễn nào thỏa mãn 5 tính chất ở trên (mình 
khuyến khích bạn đọc nên thử xây dựng). Lí do (sau khi bạn thử xây dựng 
 bạn sẽ thấy)  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-41-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-208" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.6em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-209" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-210" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-211" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-212" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-213" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-214" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-215" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-216" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-217" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-218" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-219" class="texatom"><span id="MathJax-Span-220" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-221" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-222" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-223" class="mi">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">x</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">x</mi></mrow></math></span></span><script id="MathJax-Element-41" type="math/tex">T[1,2,3] = \mathrm{xcx}</script> không có cây hậu tố tương ứng là vì hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-42-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-224" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-225" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-226" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-42" type="math/tex">x</script> là tiền tố của hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-43-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-227" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.653em, 1001.53em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-228" class="mrow"><span id="MathJax-Span-229" class="texatom"><span id="MathJax-Span-230" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-231" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-232" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-233" class="mi">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.775em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">x</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">x</mi></mrow></math></span></span><script id="MathJax-Element-43" type="math/tex">\mathrm{xcx}</script>. Tổng quát hóa ta sẽ thấy:</p>
<p style="margin-left:3em;"><b>Nhận xét:</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-44-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-234" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-235" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-236" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-44" type="math/tex">T</script> <i>không</i> có cây hậu tố biểu diễn nó khi và chỉ khi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-45-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-237" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-238" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-239" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-45" type="math/tex">T</script> có một hậu tố là tiền tố của một hậu tố khác.</p>
<p>Do đó, để đảm bảo ta luôn có thể xây dựng được cây hậu tố cho mọi văn bản đầu vào, ta sẽ thêm kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-46-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.349em; display: inline-block;" role="math" id="MathJax-Span-240" class="math"><span style="display: inline-block; position: relative; width: 0.247em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(2.101em, 999.997em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-241" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-242" class="mtext">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.164em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext></math></span></span><script id="MathJax-Element-46" type="math/tex">\</script>$ không thuộc bảng chữ cái vào cuối của văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-47-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-243" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-244" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-245" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-47" type="math/tex">T</script>. Dễ thấy sau khi thêm <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-48-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.349em; display: inline-block;" role="math" id="MathJax-Span-246" class="math"><span style="display: inline-block; position: relative; width: 0.247em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(2.101em, 999.997em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-247" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-248" class="mtext">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.164em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext></math></span></span><script id="MathJax-Element-48" type="math/tex">\</script>$, trường hợp của nhận xét trên không bao giờ xảy ra. Từ đoạn này trở đi của bài viết, ta luôn giả sử <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-49-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-249" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.27em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-250" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-251" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-252" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-253" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-254" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-255" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-256" class="mtext">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mtext>&nbsp;</mtext></math></span></span><script id="MathJax-Element-49" type="math/tex">T[n] = \</script>$.</p>
<p><b>Biểu diễn cây hậu tố:</b> Ta sẽ biểu diễn cây hậu tố dưới dạng cấu trúc cây. Về cơ bản, mỗi nút của cây hậu tố sẽ có các thông tin sau: </p>
<ol>
<li>Trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-50-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.363em; display: inline-block;" role="math" id="MathJax-Span-257" class="math"><span style="display: inline-block; position: relative; width: 4.017em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1004em, 2.678em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-258" class="mrow"><span id="MathJax-Span-259" class="texatom"><span id="MathJax-Span-260" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-261" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-262" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-263" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-264" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-265" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-266" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-267" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-268" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-269" class="mi">l</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></math></span></span><script id="MathJax-Element-50" type="math/tex">\mathrm{edgelabel}</script>: trường này lưu nhãn của cạnh (là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-51-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-270" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-271" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-272" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-51" type="math/tex">T</script>) giữa một nút và nút cha của nó. Nhãn được biểu diễn bằng hai số nguyên <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-52-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.897em; display: inline-block;" role="math" id="MathJax-Span-273" class="math"><span style="display: inline-block; position: relative; width: 6.674em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1006.63em, 2.678em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-274" class="mrow"><span id="MathJax-Span-275" class="texatom"><span id="MathJax-Span-276" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-277" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-278" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-279" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-280" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-281" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-282" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-283" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-284" class="texatom"><span id="MathJax-Span-285" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-286" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-287" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-288" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-289" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-290" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-291" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-292" class="mi">L</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow></math></span></span><script id="MathJax-Element-52" type="math/tex">\mathrm{leftEL},\mathrm{rightEL}</script> cho biết xâu con của nhãn này là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-53-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 19.664em; display: inline-block;" role="math" id="MathJax-Span-293" class="math"><span style="display: inline-block; position: relative; width: 14.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1014.65em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-294" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-295" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-296" class="mo">[</span><span id="MathJax-Span-297" class="texatom"><span id="MathJax-Span-298" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-299" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-300" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-301" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-302" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-303" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-304" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-305" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-306" class="texatom"><span id="MathJax-Span-307" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-308" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-309" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-310" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-311" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-312" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-313" class="mi">L</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-314" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-315" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-316" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-317" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-318" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-319" class="texatom"><span id="MathJax-Span-320" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-321" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-322" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-323" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-324" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-325" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-326" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-327" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-328" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-53" type="math/tex">T[\mathrm{leftEL},\mathrm{leftEL}+1,\ldots,\mathrm{rightEL}]</script>. Trường này của nút gốc là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-54-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.979em; display: inline-block;" role="math" id="MathJax-Span-329" class="math"><span style="display: inline-block; position: relative; width: 2.225em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.13em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-330" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-331" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-332" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-333" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-334" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-335" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-54" type="math/tex">(0,0)</script>. </li>
<li>Trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-55-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-336" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1004.13em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-337" class="mrow"><span id="MathJax-Span-338" class="texatom"><span id="MathJax-Span-339" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-340" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-341" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-342" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-343" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-344" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-345" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-346" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-347" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-348" class="mi">l</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></math></span></span><script id="MathJax-Element-55" type="math/tex">\mathrm{nodelabel}</script>: trường này chỉ có ở nút lá và lưu số thứ tự của hậu tố tại nút lá đó. Trường này sẽ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-56-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-349" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-350" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-351" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-56" type="math/tex">0</script> cho các nút khác.</li>
<li>Trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-57-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-352" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1003.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-353" class="mrow"><span id="MathJax-Span-354" class="texatom"><span id="MathJax-Span-355" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-356" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-357" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-358" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-359" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-360" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-361" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-362" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-363" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">c</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-57" type="math/tex">\mathrm{children}</script>: trường này lưu con trỏ để trỏ tới  các nút con của một nút. Với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-58-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-364" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-365" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-366" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-58" type="math/tex">v</script>, chúng ta sẽ sử dụng mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-59-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.788em; display: inline-block;" role="math" id="MathJax-Span-367" class="math"><span style="display: inline-block; position: relative; width: 8.096em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.98em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-368" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-369" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-370" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-371" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-372" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-373" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-374" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-375" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-376" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-377" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-378" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-379" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-380" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-381" class="texatom"><span id="MathJax-Span-382" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-383" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-384" class="mi">Σ</span><span id="MathJax-Span-385" class="texatom"><span id="MathJax-Span-386" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-387" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-388" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-59" type="math/tex">Cr[v][1,2,\ldots, |\Sigma|]</script>. Với kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-60-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.39em; display: inline-block;" role="math" id="MathJax-Span-389" class="math"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1002.48em, 2.574em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-390" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-391" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-392" class="mo">∈</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-393" class="mi">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.135em; border-left: 0px solid; width: 0px; height: 1.126em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi></math></span></span><script id="MathJax-Element-60" type="math/tex">\sigma \in \Sigma</script>, để đơn giản, chúng ta sử dụng kí hiệu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-61-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-394" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.4em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-395" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-396" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-397" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-398" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-399" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-400" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-401" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-402" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-403" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>σ</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-61" type="math/tex">Cr[v][\sigma]</script> thay vì <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-62-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-404" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.65em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-405" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-406" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-407" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-408" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-409" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-410" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-411" class="mo">[</span><span id="MathJax-Span-412" class="msubsup"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.3em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-413" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.345em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-414" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-415" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>i</mi><mi>σ</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-62" type="math/tex">Cr[v][i_\sigma]</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-63-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.089em; display: inline-block;" role="math" id="MathJax-Span-416" class="math"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.8em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-417" class="mrow"><span id="MathJax-Span-418" class="msubsup"><span style="display: inline-block; position: relative; width: 0.824em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.3em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-419" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.345em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-420" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>i</mi><mi>σ</mi></msub></math></span></span><script id="MathJax-Element-63" type="math/tex">i_\sigma</script> là chỉ số của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-64-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-421" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.732em, 1000.56em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-422" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-423" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.752em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script id="MathJax-Element-64" type="math/tex">\sigma</script> trong  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-65-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-424" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.24em, 2.721em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-425" class="mrow"><span id="MathJax-Span-426" class="texatom"><span id="MathJax-Span-427" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-428" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-429" class="mi">Σ</span><span id="MathJax-Span-430" class="texatom"><span id="MathJax-Span-431" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-432" class="mo">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.493em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script id="MathJax-Element-65" type="math/tex">|\Sigma|</script>. Phần tử <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-66-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-433" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.4em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-434" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-435" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-436" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-437" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-438" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-439" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-440" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-441" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-442" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>σ</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-66" type="math/tex">Cr[v][\sigma]</script> sẽ trỏ tới nút con <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-67-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-443" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-444" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-445" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-67" type="math/tex">u</script> sao cho kí tự đầu tiên trong nhãn của cạnh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-68-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.418em; display: inline-block;" role="math" id="MathJax-Span-446" class="math"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1001.03em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-447" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-448" class="mi">u</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-449" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mi>v</mi></math></span></span><script id="MathJax-Element-68" type="math/tex">uv</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-69-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-450" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.732em, 1000.56em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-451" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-452" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.752em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script id="MathJax-Element-69" type="math/tex">\sigma</script>. Dựa vào định nghĩa của cây hậu tố, ta có thể dễ dàng suy ra giá trị của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-70-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-453" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.4em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-454" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-455" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-456" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-457" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-458" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-459" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-460" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-461" class="mi">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-462" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>σ</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-70" type="math/tex">Cr[v][\sigma]</script>
 là duy nhất. Chúng ta sẽ thấy (ở dưới) rằng cách biểu diễn này hơi thừa
 vì số nút con không phải lúc nào cũng chiếm toàn bộ mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-71-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.308em; display: inline-block;" role="math" id="MathJax-Span-463" class="math"><span style="display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.86em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-464" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-465" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-466" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-467" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-468" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-469" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-470" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-471" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-472" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-473" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-474" class="texatom"><span id="MathJax-Span-475" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-476" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-477" class="mi">Σ</span><span id="MathJax-Span-478" class="texatom"><span id="MathJax-Span-479" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-480" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-481" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-71" type="math/tex">Cr[1,2,\ldots, |\Sigma|]</script>.
 Tuy nhiên, các biểu diễn này làm cho giả mã trở nên đơn giản hơn. Trong
 thực tế nếu kích thước của bảng chữ cái lớn thì có lẽ biểu diễn bằng 
danh sách liên kết hoặc bằng cây là tốt hơn. Với nút lá, trường này có 
giá trị rỗng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-72-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-482" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1000.45em, 2.55em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-483" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-484" class="mi">∅</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.186em; border-left: 0px solid; width: 0px; height: 1.295em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∅</mi></math></span></span><script id="MathJax-Element-72" type="math/tex">\emptyset</script>.</li>
<li>Trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-73-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.719em; display: inline-block;" role="math" id="MathJax-Span-485" class="math"><span style="display: inline-block; position: relative; width: 2.781em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1002.72em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-486" class="mrow"><span id="MathJax-Span-487" class="texatom"><span id="MathJax-Span-488" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-489" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-490" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-491" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-492" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-493" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-494" class="mi">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.24em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow></math></span></span><script id="MathJax-Element-73" type="math/tex">\mathrm{parent}</script>: trường này lưu con trỏ để trỏ tới nút cha của một nút.</li>
</ol>
<p>Nếu có các thông tin khác lưu trữ để tăng tốc thuật toán xây dựng thì chúng ta sẽ bổ sung sau.</p>
<p><b>Một số khái niệm</b></p>
<p>Hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-74-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.555em; display: inline-block;" role="math" id="MathJax-Span-495" class="math"><span style="display: inline-block; position: relative; width: 7.169em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.05em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-496" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-497" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-498" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-499" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-500" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-501" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-502" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-503" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-504" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-505" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-506" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-507" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-508" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-74" type="math/tex">T[i,i+1,\ldots,n]</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-75-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-509" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1004.18em, 2.672em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-510" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-511" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-512" class="mo">≤</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-513" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-514" class="mo">≤</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-515" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left: 0px solid; width: 0px; height: 1.234em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></math></span></span><script id="MathJax-Element-75" type="math/tex">1 \leq i \leq n</script> được gọi là hậu tố thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-76-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-516" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-517" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-518" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-76" type="math/tex">i</script> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-77-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-519" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-520" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-521" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-77" type="math/tex">T</script> và kí hiệu là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-78-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-522" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-523" class="mrow"><span id="MathJax-Span-524" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-525" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-526" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-78" type="math/tex">S_i</script>. Với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-79-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-527" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-528" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-529" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-79" type="math/tex">v</script> của cây hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-80-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-530" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-531" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-532" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-533" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-80" type="math/tex">Ts</script>, <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-81-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-534" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-535" class="mrow"><span id="MathJax-Span-536" class="texatom"><span id="MathJax-Span-537" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-538" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-539" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-540" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-541" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-542" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-543" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-544" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-545" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-546" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-547" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-548" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-549" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-81" type="math/tex">\mathrm{pathlabel}(v)</script> là xâu con thu được bằng cách ghép (concatenation) các xâu con của các cạnh trên đường đi từ nút gốc đến <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-82-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-550" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-551" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-552" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-82" type="math/tex">v</script> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-83-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-553" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-554" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-555" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-556" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-83" type="math/tex">Ts</script>. Độ dài của xâu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-84-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-557" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-558" class="mrow"><span id="MathJax-Span-559" class="texatom"><span id="MathJax-Span-560" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-561" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-562" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-563" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-564" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-565" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-566" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-567" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-568" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-569" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-570" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-571" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-572" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-84" type="math/tex">\mathrm{pathlabel}(v)</script> được gọi là string depth và kí hiệu là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-85-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.432em; display: inline-block;" role="math" id="MathJax-Span-573" class="math"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.72em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-574" class="mrow"><span id="MathJax-Span-575" class="texatom"><span id="MathJax-Span-576" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-577" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-578" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-579" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-580" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-581" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-582" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-583" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-584" class="mi">h</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-585" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-586" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-587" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-85" type="math/tex">\mathrm{strdepth}(v)</script> (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-86-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-588" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1003.57em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-589" class="mrow"><span id="MathJax-Span-590" class="texatom"><span id="MathJax-Span-591" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-592" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-593" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-594" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-595" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-596" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-597" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-598" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-599" class="mi">h</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow></math></span></span><script id="MathJax-Element-86" type="math/tex">\mathrm{strdepth}</script> là viết tắt của string depth).  </p>
<p><strong><font size="4">Truy vấn sử dụng cây hậu tố</font></strong></p>
<p>Giả sử chúng ta đã xây dựng được cây hậu tố cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-87-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.568em; display: inline-block;" role="math" id="MathJax-Span-600" class="math"><span style="display: inline-block; position: relative; width: 1.916em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.8em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-601" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-602" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-603" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-604" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-605" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-87" type="math/tex">T[n]</script>. Sử dụng cây hậu tố, ta có thể trả lời một số truy vấn ở trên như sau:</p>
<ol>
<li>Để kiểm tra xem <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-88-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-606" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-607" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-608" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-88" type="math/tex">P</script> có là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-89-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-609" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-610" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-611" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-89" type="math/tex">T</script> hay không, ta duyệt <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-90-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-612" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-613" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-614" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-90" type="math/tex">T</script> bắt đầu từ gốc, tìm một nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-91-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-615" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-616" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-617" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-91" type="math/tex">v</script> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-92-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-618" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-619" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-620" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-92" type="math/tex">T</script> sao cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-93-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-621" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-622" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-623" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-93" type="math/tex">P</script> là xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-94-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-624" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-625" class="mrow"><span id="MathJax-Span-626" class="texatom"><span id="MathJax-Span-627" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-628" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-629" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-630" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-631" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-632" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-633" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-634" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-635" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-636" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-637" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-638" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-639" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-94" type="math/tex">\mathrm{pathlabel}(v)</script>. Duyệt kết hợp với kiểm tra có thể được thực hiện trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-95-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-640" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-641" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-642" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-643" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-644" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-645" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-95" type="math/tex">O(m)</script>.</li>
<li> Tương tự như truy vấn đầu tiên, để kiểm tra xem <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-96-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-646" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-647" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-648" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-96" type="math/tex">P</script> có là một hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-97-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-649" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-650" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-651" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-97" type="math/tex">T</script> hay không, ta duyệt <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-98-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-652" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-653" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-654" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-98" type="math/tex">T</script> bắt đầu từ gốc, tìm <b>nút lá</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-99-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-655" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-656" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-657" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-99" type="math/tex">v</script> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-100-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-658" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-659" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-660" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-100" type="math/tex">T</script> sao cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-101-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.884em; display: inline-block;" role="math" id="MathJax-Span-661" class="math"><span style="display: inline-block; position: relative; width: 7.416em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.32em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-662" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-663" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-664" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-665" class="texatom"><span id="MathJax-Span-666" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-667" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-668" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-669" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-670" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-671" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-672" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-673" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-674" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-675" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-676" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-677" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-678" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-101" type="math/tex">P = \mathrm{pathlabel}(v)</script>. Nếu nút lá <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-102-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-679" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-680" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-681" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-102" type="math/tex">v</script> như vậy không tồn tại thì <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-103-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-682" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-683" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-684" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-103" type="math/tex">P</script> không phải là hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-104-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-685" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-686" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-687" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-104" type="math/tex">P</script>. Truy vấn này có thể được thực hiện trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-105-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-688" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-689" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-690" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-691" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-692" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-693" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-105" type="math/tex">O(m)</script>.</li>
<li> Để đếm sự xuất hiện của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-106-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-694" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-695" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-696" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-106" type="math/tex">P</script> trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-107-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-697" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-698" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-699" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-107" type="math/tex">P</script>, ta duyệt <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-108-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-700" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-701" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-702" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-108" type="math/tex">T</script> bắt đầu từ gốc, tìm nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-109-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-703" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-704" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-705" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-109" type="math/tex">v</script> gần gốc nhất của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-110-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-706" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-707" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-708" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-110" type="math/tex">T</script> sao cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-111-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-709" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-710" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-711" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-111" type="math/tex">P</script> là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-112-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-712" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-713" class="mrow"><span id="MathJax-Span-714" class="texatom"><span id="MathJax-Span-715" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-716" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-717" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-718" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-719" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-720" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-721" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-722" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-723" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-724" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-725" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-726" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-727" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-112" type="math/tex">\mathrm{pathlabel}(v)</script>. Số lần xuất hiện của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-113-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-728" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-729" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-730" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-113" type="math/tex">P</script> trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-114-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-731" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-732" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-733" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-114" type="math/tex">T</script> chính là số nút lá của cây con với gốc <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-115-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-734" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-735" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-736" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-115" type="math/tex">v</script>. Trong quá trình xây dựng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-116-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-737" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-738" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-739" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-116" type="math/tex">T</script>, ta có thể đưa thêm thông tin này vào mỗi nút trong của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-117-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-740" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-741" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-742" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-743" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-117" type="math/tex">Ts</script>, do đó truy vấn này có thể được thực hiện trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-118-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-744" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-745" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-746" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-747" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-748" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-749" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-118" type="math/tex">O(m)</script>.</li>
<li> Để tìm xâu con dài nhất xuất hiện ít nhất 2 lần trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-119-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-750" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-751" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-752" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-119" type="math/tex">P</script>, ta tìm một nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-120-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-753" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-754" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-755" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-120" type="math/tex">v</script> có string depth lớn nhất và có ít nhất 2 nút con.  Xâu con đầu ra chính là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-121-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-756" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-757" class="mrow"><span id="MathJax-Span-758" class="texatom"><span id="MathJax-Span-759" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-760" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-761" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-762" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-763" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-764" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-765" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-766" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-767" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-768" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-769" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-770" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-771" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-121" type="math/tex">\mathrm{pathlabel}(v)</script>. Truy vấn này có thể được thực hiện trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-122-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.815em; display: inline-block;" role="math" id="MathJax-Span-772" class="math"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.01em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-773" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-774" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-775" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-776" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-777" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-122" type="math/tex">O(n)</script>.</li>
<li> Để tìm hậu tố nhỏ nhất theo thứ tự từ điển, ta duyệt <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-123-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-778" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-779" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-780" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-123" type="math/tex">T</script>
  bắt đầu từ gốc. Tại mỗi nút, ta thăm nút con có nhãn của cạnh bắt đầu 
bằng kí tự nhỏ nhất theo thứ tự từ điển. Duyệt đến khi nào ta tới một 
nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-124-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-781" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-782" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-783" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-124" type="math/tex">v</script> là nút lá hoặc có một nút con <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-125-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-784" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-785" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-786" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-125" type="math/tex">u</script> sao cho nhãn của cạnh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-126-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.418em; display: inline-block;" role="math" id="MathJax-Span-787" class="math"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1001.03em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-788" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-789" class="mi">u</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-790" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mi>v</mi></math></span></span><script id="MathJax-Element-126" type="math/tex">uv</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-127-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.349em; display: inline-block;" role="math" id="MathJax-Span-791" class="math"><span style="display: inline-block; position: relative; width: 0.247em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(2.101em, 999.997em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-792" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-793" class="mtext">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.164em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext></math></span></span><script id="MathJax-Element-127" type="math/tex">\</script>$  thì <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-128-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-794" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-795" class="mrow"><span id="MathJax-Span-796" class="texatom"><span id="MathJax-Span-797" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-798" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-799" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-800" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-801" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-802" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-803" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-804" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-805" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-806" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-807" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-808" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-809" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-128" type="math/tex">\mathrm{pathlabel}(v)</script> chính là hậu tố cần tìm. </li>
</ol>
<p>Giả mã của các truy vấn này được cho ở phần phụ lục ở cuối bài. Dưới đây, chúng ta giới thiệu thuật toán đơn giản với thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-129-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.39em; display: inline-block;" role="math" id="MathJax-Span-810" class="math"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1002.44em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-811" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-812" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-813" class="mo">(</span><span id="MathJax-Span-814" class="msubsup"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.58em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-815" class="mi">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.6em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-816" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-817" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.606em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-129" type="math/tex">O(n^2)</script> xây dựng cây hậu tố.  Bài tiếp theo chúng ta sẽ làm quen với thuật toán <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-130-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.815em; display: inline-block;" role="math" id="MathJax-Span-818" class="math"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.01em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-819" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-820" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-821" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-822" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-823" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-130" type="math/tex">O(n)</script>.</p>
<p><strong><font size="4">Thuật toán <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-131-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.347em; display: inline-block;" role="math" id="MathJax-Span-824" class="math"><span style="display: inline-block; position: relative; width: 2.584em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.363em, 1002.49em, 2.705em, -1000em); top: -2.326em; left: 0em;"><span id="MathJax-Span-825" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-826" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-827" class="mo">(</span><span id="MathJax-Span-828" class="msubsup"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.434em, 1000.58em, 4.145em, -1000em); top: -4.005em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-829" class="mi">n</span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span><span style="position: absolute; top: -4.368em; left: 0.6em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-830" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.005em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-831" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.326em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.509em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-131" type="math/tex">O(n^2)</script></font></strong></p>
<p>Ta lần lượt xây dựng cây hậu tố bằng cách chèn lần lượt các hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-132-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-832" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1005.99em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-833" class="mrow"><span id="MathJax-Span-834" class="msubsup"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-835" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-836" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-837" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-838" class="msubsup"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-839" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-840" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-841" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-842" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-843" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-844" class="msubsup"><span style="display: inline-block; position: relative; width: 1.112em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-845" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-846" class="mi">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.36em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mn>1</mn></msub><mo>,</mo><msub><mi>S</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>S</mi><mi>n</mi></msub></math></span></span><script id="MathJax-Element-132" type="math/tex">S_1,S_2,\ldots, S_n</script>, trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-133-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-847" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-848" class="mrow"><span id="MathJax-Span-849" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-850" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-851" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-133" type="math/tex">S_i</script> là hậu tố thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-134-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-852" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-853" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-854" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-134" type="math/tex">i</script> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-135-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-855" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-856" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-857" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-135" type="math/tex">T</script>, vào cây hậu tố hiện tại. Cây hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-136-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-858" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.54em, 2.684em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-859" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-860" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span id="MathJax-Span-861" class="msubsup"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-862" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.469em;"><span id="MathJax-Span-863" class="texatom"><span id="MathJax-Span-864" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-865" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.264em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script id="MathJax-Element-136" type="math/tex">Ts_{1}</script> chỉ có 1 nút lá (và một nút gốc) biểu diễn hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-137-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.418em; display: inline-block;" role="math" id="MathJax-Span-866" class="math"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1001.05em, 2.622em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-867" class="mrow"><span id="MathJax-Span-868" class="msubsup"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-869" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-870" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.302em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mn>1</mn></msub></math></span></span><script id="MathJax-Element-137" type="math/tex">S_1</script>. Tại bước thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-138-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-871" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-872" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-873" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-138" type="math/tex">i</script>, thuật toán chèn hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-139-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-874" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-875" class="mrow"><span id="MathJax-Span-876" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-877" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-878" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-139" type="math/tex">S_i</script> vào cây hậu tố hiện tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-140-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-879" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1002.35em, 2.692em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-880" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-881" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span id="MathJax-Span-882" class="msubsup"><span style="display: inline-block; position: relative; width: 1.692em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-883" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.469em;"><span id="MathJax-Span-884" class="texatom"><span id="MathJax-Span-885" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-886" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-887" class="mo">−</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-888" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.275em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script id="MathJax-Element-140" type="math/tex">Ts_{i-1}</script>. Để chèn hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-141-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-889" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-890" class="mrow"><span id="MathJax-Span-891" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-892" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-893" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-141" type="math/tex">S_i</script> vào cây hậu tố hiện tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-142-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-894" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1002.35em, 2.692em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-895" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-896" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span id="MathJax-Span-897" class="msubsup"><span style="display: inline-block; position: relative; width: 1.692em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-898" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.469em;"><span id="MathJax-Span-899" class="texatom"><span id="MathJax-Span-900" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-901" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-902" class="mo">−</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-903" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.275em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script id="MathJax-Element-142" type="math/tex">Ts_{i-1}</script>, ta sẽ:</p>
<ol>
<li>Tìm một nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-143-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-904" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-905" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-906" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-143" type="math/tex">v</script> sao cho: (a) độ dài của <b>tiền tố chung</b> của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-144-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-907" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-908" class="mrow"><span id="MathJax-Span-909" class="texatom"><span id="MathJax-Span-910" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-911" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-912" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-913" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-914" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-915" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-916" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-917" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-918" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-919" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-920" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-921" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-922" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-144" type="math/tex">\mathrm{pathlabel}(v)</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-145-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-923" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-924" class="mrow"><span id="MathJax-Span-925" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-926" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-927" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-145" type="math/tex">S_i</script> là lớn nhất và (b) <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-146-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-928" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-929" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-930" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-146" type="math/tex">v</script> gần gốc nhất . Thủ tục <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-147-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.39em; display: inline-block;" role="math" id="MathJax-Span-931" class="math"><span style="display: inline-block; position: relative; width: 7.045em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.99em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-932" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-933" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-934" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-935" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-936" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-937" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-938" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-939" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-940" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-941" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-942" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-943" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-944" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-945" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>i</mi><mo stretchy="false">]</mo><mo>,</mo><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-147" type="math/tex">T[1,2,\ldots,i],Ts</script>) dưới đây sẽ thực hiện thao tác này, trả lại 3 thông tin:<p></p>
<ol>
<li>Nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-148-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-946" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-947" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-948" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-148" type="math/tex">v</script>.</li>
<li>Vị trí cuối cùng của đoạn khớp của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-149-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-949" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-950" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-951" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-149" type="math/tex">P</script>, kí hiệu là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-150-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-952" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.64em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-953" class="mrow"><span id="MathJax-Span-954" class="texatom"><span id="MathJax-Span-955" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-956" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-957" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-958" class="mi">p</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow></math></span></span><script id="MathJax-Element-150" type="math/tex">\mathrm{mlp}</script> (là viết tắt của <b>m</b>atched <b>l</b>ocation of the <b>p</b>attern )</li>
<li>Vị trí cuối cùng của đoạn khớp của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-151-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-959" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-960" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-961" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-151" type="math/tex">T</script>, kí hiệu là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-152-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-962" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.43em, 2.482em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-963" class="mrow"><span id="MathJax-Span-964" class="texatom"><span id="MathJax-Span-965" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-966" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-967" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-968" class="mi">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow></math></span></span><script id="MathJax-Element-152" type="math/tex">\mathrm{mlt}</script> (là viết tắt của <b>m</b>atched <b>l</b>ocation of the <b>t</b>ext)</li>
</ol>
</li>
<li>Có hai trường hợp: (I) Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-153-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.253em; display: inline-block;" role="math" id="MathJax-Span-969" class="math"><span style="display: inline-block; position: relative; width: 9.95em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1009.85em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-970" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-971" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-972" class="mo">&lt;</span><span style="padding-left: 0.278em;" id="MathJax-Span-973" class="texatom"><span id="MathJax-Span-974" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-975" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-976" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-977" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-978" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-979" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-980" class="mo">(</span><span id="MathJax-Span-981" class="texatom"><span id="MathJax-Span-982" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-983" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-984" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-985" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-986" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-987" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-988" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-989" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-990" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-991" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-992" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-993" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-994" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-995" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>&lt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-153" type="math/tex">s < \mathrm{right}(\mathrm{edgelabel}(v))</script> thì ta sẽ thêm vào một nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-154-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-996" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-997" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-998" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-154" type="math/tex">x</script> vào giữa cạnh nối <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-155-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-999" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1000" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1001" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-155" type="math/tex">v</script> và cha của nó tại vị trí kí tự ứng với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-156-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1002" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.44em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1003" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1004" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 0.766em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script id="MathJax-Element-156" type="math/tex">s</script>,  thêm một nút lá <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-157-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1005" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1006" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1007" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-157" type="math/tex">u</script>, gán <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-158-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1008" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1009" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1010" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-158" type="math/tex">u</script> là con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-159-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1011" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1012" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1013" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-159" type="math/tex">x</script> và gắn hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-160-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1014" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1015" class="mrow"><span id="MathJax-Span-1016" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1017" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1018" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-160" type="math/tex">S_i</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-161-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1019" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1020" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1021" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-161" type="math/tex">u</script>. (II) Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-162-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.253em; display: inline-block;" role="math" id="MathJax-Span-1022" class="math"><span style="display: inline-block; position: relative; width: 9.95em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1009.85em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1023" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1024" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1025" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1026" class="texatom"><span id="MathJax-Span-1027" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1028" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1029" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1030" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1031" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1032" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1033" class="mo">(</span><span id="MathJax-Span-1034" class="texatom"><span id="MathJax-Span-1035" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1036" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1037" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1038" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1039" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1040" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1041" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1042" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1043" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1044" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1045" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1046" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1047" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1048" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-162" type="math/tex">s = \mathrm{right}(\mathrm{edgelabel}(v))</script> thì ta sẽ thêm một nút lá <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-163-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1049" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1050" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1051" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-163" type="math/tex">u</script>  là con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-164-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1052" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1053" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1054" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-164" type="math/tex">v</script> và gắn hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-165-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1055" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1056" class="mrow"><span id="MathJax-Span-1057" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1058" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1059" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-165" type="math/tex">S_i</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-166-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1060" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1061" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1062" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-166" type="math/tex">u</script>.</li>
</ol>
<p>Ví dụ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0024;&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-167-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.788em; display: inline-block;" role="math" id="MathJax-Span-1063" class="math"><span style="display: inline-block; position: relative; width: 12.607em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1012.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1064" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1065" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1066" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1067" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1068" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1069" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1070" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1071" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1072" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1073" class="mn">10</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1074" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1075" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1076" class="texatom"><span id="MathJax-Span-1077" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1078" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1079" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1080" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1081" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1082" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1083" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1084" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1085" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1086" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1087" class="mi">$</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>10</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">x</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">$</mi></mrow></math></span></span><script id="MathJax-Element-167" type="math/tex">T[1,2,\ldots,10] = \mathrm{xabxacxad\$}</script> Cây hậu tối khi chèn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-168-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.418em; display: inline-block;" role="math" id="MathJax-Span-1088" class="math"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1001.05em, 2.622em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1089" class="mrow"><span id="MathJax-Span-1090" class="msubsup"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1091" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1092" class="mn">4</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.302em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mn>4</mn></msub></math></span></span><script id="MathJax-Element-168" type="math/tex">S_4</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-169-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.418em; display: inline-block;" role="math" id="MathJax-Span-1093" class="math"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1001.05em, 2.637em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1094" class="mrow"><span id="MathJax-Span-1095" class="msubsup"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1096" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1097" class="mn">7</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.302em; border-left: 0px solid; width: 0px; height: 1.322em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mn>7</mn></msub></math></span></span><script id="MathJax-Element-169" type="math/tex">S_7</script> lần lượt tương ứng với trường hợp (I) và (II) sẽ như ở hình vẽ sau:<br>
 <img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/insert-suffix.png" alt="insert-suffix" width="500" height="376"></p>
<p>Giả mã của thuật toán như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> NativeSuffixTree</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-170-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-1098" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1099" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1100" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1101" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1102" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1103" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1104" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1105" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1106" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1107" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1108" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1109" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-170" type="math/tex">T[1,2,\ldots, n]</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp;<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-171-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1110" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1002.35em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1111" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1112" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1113" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1114" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-171" type="math/tex">Ts \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> InitSuffixTree</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-172-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-1115" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.57em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1116" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1117" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1118" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1119" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1120" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1121" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1122" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1123" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1124" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1125" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1126" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-172" type="math/tex">T[1,2,\ldots,n]</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-173-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-1127" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1128" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1129" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1130" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1131" class="texatom"><span id="MathJax-Span-1132" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1133" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1134" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1135" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1136" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1137" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1138" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1139" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1140" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-173" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-174-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1141" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.36em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1142" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1143" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1144" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1145" class="mn">2</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>2</mn></math></span></span><script id="MathJax-Element-174" type="math/tex">i \leftarrow 2</script> to <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-175-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1146" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.6em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1147" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1148" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-175" type="math/tex">n</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-176-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1149" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.56em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1150" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1151" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1152" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1153" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1154" class="texatom"><span id="MathJax-Span-1155" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1156" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1157" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1158" class="mi">p</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1159" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1160" class="texatom"><span id="MathJax-Span-1161" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1162" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1163" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1164" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1165" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1166" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-176" type="math/tex">(v,\mathrm{mlp}, \mathrm{mlt})\leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-177-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.788em; display: inline-block;" role="math" id="MathJax-Span-1167" class="math"><span style="display: inline-block; position: relative; width: 8.096em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.08em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1168" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1169" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1170" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1171" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1172" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1173" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1174" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1175" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1176" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1177" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1178" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1179" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1180" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1181" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1182" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo><mo>,</mo><mi>r</mi></math></span></span><script id="MathJax-Element-177" type="math/tex">T[i,i+1,\ldots,n],r</script>)<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-178-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-1183" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.39em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1184" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1185" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1186" class="mi">v</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1187" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1188" class="texatom"><span id="MathJax-Span-1189" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1190" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1191" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1192" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1193" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1194" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1195" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1196" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1197" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1198" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mi>v</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-178" type="math/tex">\ell v \leftarrow \mathrm{leftEL}(v)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-179-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.473em; display: inline-block;" role="math" id="MathJax-Span-1199" class="math"><span style="display: inline-block; position: relative; width: 7.107em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.01em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1200" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1201" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1202" class="mi">v</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1203" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1204" class="texatom"><span id="MathJax-Span-1205" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1206" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1207" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1208" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1209" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1210" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1211" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1212" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1213" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1214" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1215" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>v</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-179" type="math/tex">rv \leftarrow \mathrm{rightEL}(v)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-180-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-1216" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.345em, 1001.43em, 2.42em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-1217" class="mrow"><span id="MathJax-Span-1218" class="texatom"><span id="MathJax-Span-1219" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1220" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1221" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1222" class="mi">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow></math></span></span><script id="MathJax-Element-180" type="math/tex">\mathrm{mlt}</script> &lt; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-181-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1223" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.658em, 1000.91em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1224" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1225" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1226" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>v</mi></math></span></span><script id="MathJax-Element-181" type="math/tex">rv</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-182-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.692em; display: inline-block;" role="math" id="MathJax-Span-1227" class="math"><span style="display: inline-block; position: relative; width: 8.775em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.7em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1228" class="mrow"><span id="MathJax-Span-1229" class="texatom"><span id="MathJax-Span-1230" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1231" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1232" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1233" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1234" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1235" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1236" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1237" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1238" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1239" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1240" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1241" class="texatom"><span id="MathJax-Span-1242" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1243" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1244" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1245" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1246" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1247" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-182" type="math/tex">\mathrm{leftEL}(v) \leftarrow \mathrm{mlt}+1</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-183-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1248" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1249" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1250" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1251" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-183" type="math/tex">x \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> MakeNode</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-184-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.884em; display: inline-block;" role="math" id="MathJax-Span-1252" class="math"><span style="display: inline-block; position: relative; width: 2.905em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1002.85em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1253" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1254" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1255" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1256" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1257" class="texatom"><span id="MathJax-Span-1258" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1259" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1260" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1261" class="mi">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.36em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mi>v</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow></math></span></span><script id="MathJax-Element-184" type="math/tex">\ell v,\mathrm{mlt}</script>)<br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> ReplaceParent</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-185-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-1262" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.658em, 1001.49em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1263" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1264" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1265" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1266" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>,</mo><mi>x</mi></math></span></span><script id="MathJax-Element-185" type="math/tex">v,x</script>)<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-186-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.473em; display: inline-block;" role="math" id="MathJax-Span-1267" class="math"><span style="display: inline-block; position: relative; width: 2.596em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1002.58em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1268" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1269" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1270" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1271" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo><mi>v</mi></math></span></span><script id="MathJax-Element-186" type="math/tex">x \leftarrow v</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-187-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1272" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1273" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1274" class="mi">u</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1275" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-187" type="math/tex">u \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> MakeLeaf</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-188-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.925em; display: inline-block;" role="math" id="MathJax-Span-1276" class="math"><span style="display: inline-block; position: relative; width: 5.191em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1005.15em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1277" class="mrow"><span id="MathJax-Span-1278" class="texatom"><span id="MathJax-Span-1279" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1280" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1281" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1282" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1283" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1284" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1285" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1286" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1287" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1288" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo>+</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo>,</mo><mi>i</mi></math></span></span><script id="MathJax-Element-188" type="math/tex">\mathrm{mlt}+1,n,i</script>)<br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-189-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.24em; display: inline-block;" role="math" id="MathJax-Span-1289" class="math"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.13em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1290" class="mrow"><span id="MathJax-Span-1291" class="texatom"><span id="MathJax-Span-1292" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1293" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1294" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1295" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1296" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1297" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1298" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1299" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1300" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1301" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1302" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1303" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-189" type="math/tex">\mathrm{parent}(u) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-190-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.089em; display: inline-block;" role="math" id="MathJax-Span-1304" class="math"><span style="display: inline-block; position: relative; width: 9.826em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.8em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1305" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1306" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1307" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1308" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1309" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1310" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1311" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1312" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1313" class="mo">[</span><span id="MathJax-Span-1314" class="texatom"><span id="MathJax-Span-1315" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1316" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1317" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1318" class="mi">p</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1319" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1320" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1321" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1322" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1323" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1324" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>u</mi></math></span></span><script id="MathJax-Element-190" type="math/tex">Cr[x][T[\mathrm{mlp}+1]] \leftarrow u</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> FindPath</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-191-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-1325" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.84em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1326" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1327" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1328" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1329" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1330" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1331" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1332" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1333" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1334" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1335" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1336" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1337" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1338" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>r</mi></math></span></span><script id="MathJax-Element-191" type="math/tex">P[1,2,\ldots,m], r</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-192-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1339" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.34em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1340" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1341" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1342" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1343" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-192" type="math/tex">i \leftarrow 1</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-193-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1344" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.49em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1345" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1346" class="mi">c</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1347" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1348" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1349" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1350" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1351" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1352" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1353" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1354" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1355" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1356" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1357" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1358" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo stretchy="false">←</mo><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-193" type="math/tex">c \leftarrow Cr[r][P[i]]</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-194-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.911em; display: inline-block;" role="math" id="MathJax-Span-1359" class="math"><span style="display: inline-block; position: relative; width: 5.933em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.84em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1360" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1361" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1362" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1363" class="texatom"><span id="MathJax-Span-1364" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1365" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1366" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1367" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1368" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1369" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1370" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1371" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1372" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1373" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-194" type="math/tex">j \leftarrow \mathrm{leftEL}(c)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-195-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.308em; display: inline-block;" role="math" id="MathJax-Span-1374" class="math"><span style="display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.89em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1375" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1376" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1377" class="mi">c</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1378" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1379" class="texatom"><span id="MathJax-Span-1380" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1381" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1382" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1383" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1384" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1385" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1386" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1387" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1388" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1389" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1390" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>c</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-195" type="math/tex">rc \leftarrow \mathrm{rightEL}(c)</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-196-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-1391" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1001.49em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1392" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1393" class="mi">c</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1394" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo></math></span></span><script id="MathJax-Element-196" type="math/tex">c = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font> or <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-197-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.637em; display: inline-block;" role="math" id="MathJax-Span-1395" class="math"><span style="display: inline-block; position: relative; width: 2.719em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.68em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1396" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1397" class="mi">m</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1398" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1399" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>=</mo><mn>0</mn></math></span></span><script id="MathJax-Element-197" type="math/tex"> m = 0</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-198-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.938em; display: inline-block;" role="math" id="MathJax-Span-1400" class="math"><span style="display: inline-block; position: relative; width: 8.961em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.87em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1401" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1402" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1403" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1404" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1405" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1406" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1407" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1408" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1409" class="texatom"><span id="MathJax-Span-1410" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1411" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1412" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1413" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1414" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1415" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1416" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1417" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1418" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1419" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1420" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1421" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-198" type="math/tex">(v,i-1,\mathrm{rightEL}(v))</script><br>
   &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-199-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-1422" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.64em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1423" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1424" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1425" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1426" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1427" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1428" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1429" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1430" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1431" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1432" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-199" type="math/tex">T[i] = T[j]</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-200-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.527em; display: inline-block;" role="math" id="MathJax-Span-1433" class="math"><span style="display: inline-block; position: relative; width: 8.652em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1008.58em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1434" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1435" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1436" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1437" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1438" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1439" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1440" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1441" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1442" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1443" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1444" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1445" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-200" type="math/tex">i \leftarrow i+1, j \leftarrow j+1</script><br>
   &nbsp;&nbsp;&nbsp;   <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-201-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.555em; display: inline-block;" role="math" id="MathJax-Span-1446" class="math"><span style="display: inline-block; position: relative; width: 2.657em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1002.65em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1447" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1448" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1449" class="mo">&gt;</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1450" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1451" class="mi">c</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>&gt;</mo><mi>r</mi><mi>c</mi></math></span></span><script id="MathJax-Element-201" type="math/tex">j > rc</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   return <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-202-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.116em; display: inline-block;" role="math" id="MathJax-Span-1452" class="math"><span style="display: inline-block; position: relative; width: 8.343em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1453" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1454" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1455" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1456" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1457" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1458" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1459" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1460" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1461" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1462" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1463" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1464" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1465" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1466" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1467" class="mi">c</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>c</mi></math></span></span><script id="MathJax-Element-202" type="math/tex">P[i,i+1,\ldots,m], c</script>)<br>
   &nbsp;&nbsp;&nbsp;   <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-203-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.568em; display: inline-block;" role="math" id="MathJax-Span-1468" class="math"><span style="display: inline-block; position: relative; width: 6.427em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.33em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1469" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1470" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1471" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1472" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1473" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1474" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1475" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1476" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1477" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1478" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1479" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1480" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>c</mi><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-203" type="math/tex">(c,i-1,j-1)</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> ReplaceParent</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-204-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-1481" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1001.49em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1482" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1483" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1484" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1485" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>,</mo><mi>x</mi></math></span></span><script id="MathJax-Element-204" type="math/tex">v, x</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-205-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.733em; display: inline-block;" role="math" id="MathJax-Span-1486" class="math"><span style="display: inline-block; position: relative; width: 6.551em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.46em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1487" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1488" class="mi">p</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1489" class="mi">v</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1490" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1491" class="texatom"><span id="MathJax-Span-1492" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1493" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1494" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1495" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1496" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1497" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1498" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1499" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1500" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1501" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>v</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-205" type="math/tex">pv \leftarrow \mathrm{parent}(v)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-206-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1502" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.52em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1503" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1504" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1505" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1506" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1507" class="texatom"><span id="MathJax-Span-1508" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1509" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1510" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1511" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1512" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1513" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1514" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1515" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1516" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1517" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mi>x</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-206" type="math/tex">\ell x \leftarrow \mathrm{leftEL}(x)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-207-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-1518" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.39em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1519" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1520" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1521" class="mi">v</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1522" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1523" class="texatom"><span id="MathJax-Span-1524" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1525" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1526" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1527" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1528" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1529" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1530" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1531" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1532" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1533" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mi>v</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-207" type="math/tex">\ell v \leftarrow \mathrm{leftEL}(v)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-208-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.459em; display: inline-block;" role="math" id="MathJax-Span-1534" class="math"><span style="display: inline-block; position: relative; width: 7.848em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.8em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1535" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1536" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1537" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1538" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1539" class="mi">p</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1540" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1541" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1542" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1543" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1544" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1545" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1546" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1547" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1548" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1549" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1550" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>p</mi><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-208" type="math/tex">Cr[pv][T[\ell x]] \leftarrow x</script>     &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <i>[[set <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-209-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1551" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1552" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1553" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-209" type="math/tex">x</script> to be a child of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-210-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-1554" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.658em, 1000.97em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1555" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1556" class="mi">p</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1557" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>v</mi></math></span></span><script id="MathJax-Element-210" type="math/tex">pv</script>]]</i><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-211-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.719em; display: inline-block;" role="math" id="MathJax-Span-1558" class="math"><span style="display: inline-block; position: relative; width: 7.292em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.27em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1559" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1560" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1561" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1562" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1563" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1564" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1565" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1566" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1567" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1568" class="mi">ℓ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1569" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1570" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1571" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1572" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1573" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mi>v</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>v</mi></math></span></span><script id="MathJax-Element-211" type="math/tex">Cr[x][T[\ell v]] \leftarrow v</script>     &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;<i>[[set <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-212-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1574" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.658em, 1000.48em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1575" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1576" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-212" type="math/tex">v</script> to be a child of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-213-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1577" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1578" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1579" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-213" type="math/tex">x</script>]]</i><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-214-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-1580" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1581" class="mrow"><span id="MathJax-Span-1582" class="texatom"><span id="MathJax-Span-1583" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1584" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1585" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1586" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1587" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1588" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1589" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1590" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1591" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1592" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1593" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1594" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-214" type="math/tex">\mathrm{parent}(v) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-215-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1595" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1596" class="mrow"><span id="MathJax-Span-1597" class="texatom"><span id="MathJax-Span-1598" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1599" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1600" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1601" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1602" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1603" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1604" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1605" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1606" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1607" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1608" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1609" class="mi">p</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1610" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>p</mi><mi>v</mi></math></span></span><script id="MathJax-Element-215" type="math/tex">\mathrm{parent}(x) \leftarrow pv</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> InitSuffixTree</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-216-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-1611" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1612" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1613" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1614" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1615" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1616" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1617" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1618" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1619" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1620" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1621" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1622" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-216" type="math/tex">T[1,2,\ldots,n]</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-217-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1623" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1624" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1625" class="mi">u</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1626" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-217" type="math/tex">u \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> MakeLeaf</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-218-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.39em; display: inline-block;" role="math" id="MathJax-Span-1627" class="math"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.46em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1628" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1629" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1630" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1631" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1632" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1633" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.308em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mi>n</mi><mo>,</mo><mn>1</mn></math></span></span><script id="MathJax-Element-218" type="math/tex">1,n,1</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-219-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-1634" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.67em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1635" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1636" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1637" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-219" type="math/tex">r \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> MakeNode</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-220-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-1638" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.373em, 1001.44em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-1639" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1640" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1641" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1642" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.308em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>,</mo><mn>0</mn></math></span></span><script id="MathJax-Element-220" type="math/tex">0,0</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-221-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1643" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.78em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1644" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1645" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1646" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1647" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1648" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1649" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1650" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1651" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1652" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1653" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1654" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1655" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1656" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1657" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>u</mi></math></span></span><script id="MathJax-Element-221" type="math/tex">Cr[r][T[1]] \leftarrow u</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-222-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-1658" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1659" class="mrow"><span id="MathJax-Span-1660" class="texatom"><span id="MathJax-Span-1661" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1662" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1663" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1664" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1665" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1666" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1667" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1668" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1669" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1670" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1671" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1672" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>r</mi></math></span></span><script id="MathJax-Element-222" type="math/tex">\mathrm{parent}(u) \leftarrow r</script><br>
   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-223-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1673" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.41em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1674" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1675" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-223" type="math/tex">r</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> MakeNode</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-224-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-1676" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1001.29em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1677" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1678" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1679" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1680" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>,</mo><mi>j</mi></math></span></span><script id="MathJax-Element-224" type="math/tex">i, j</script>):</a> <font face="verdana"><br>
    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-225-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.171em; display: inline-block;" role="math" id="MathJax-Span-1681" class="math"><span style="display: inline-block; position: relative; width: 5.376em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.32em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1682" class="mrow"><span id="MathJax-Span-1683" class="texatom"><span id="MathJax-Span-1684" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1685" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1686" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1687" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1688" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1689" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1690" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1691" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1692" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1693" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1694" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-225" type="math/tex">\mathrm{parent}(u) \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-226-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.87em; display: inline-block;" role="math" id="MathJax-Span-1695" class="math"><span style="display: inline-block; position: relative; width: 3.646em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1696" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1697" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1698" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1699" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1700" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1701" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1702" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-226" type="math/tex">Cr[u] \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-227-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-1703" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.95em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1704" class="mrow"><span id="MathJax-Span-1705" class="texatom"><span id="MathJax-Span-1706" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1707" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1708" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1709" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1710" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1711" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1712" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1713" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1714" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1715" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1716" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1717" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>i</mi></math></span></span><script id="MathJax-Element-227" type="math/tex">\mathrm{leftEL}(u) \leftarrow  i</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-228-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.897em; display: inline-block;" role="math" id="MathJax-Span-1718" class="math"><span style="display: inline-block; position: relative; width: 6.674em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.66em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1719" class="mrow"><span id="MathJax-Span-1720" class="texatom"><span id="MathJax-Span-1721" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1722" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1723" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1724" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1725" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1726" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1727" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1728" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1729" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1730" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1731" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1732" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1733" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>j</mi></math></span></span><script id="MathJax-Element-228" type="math/tex">\mathrm{rightEL}(u) \leftarrow  j</script><br>
   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-229-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1734" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.53em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1735" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1736" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-229" type="math/tex">u</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> MakeLeaf</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-230-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1737" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1002.39em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1738" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1739" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1740" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1741" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1742" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1743" class="mi">k</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>,</mo><mi>n</mi><mo>,</mo><mi>k</mi></math></span></span><script id="MathJax-Element-230" type="math/tex">i,n, k</script>):</a> <font face="verdana"><br>
    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-231-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1744" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1745" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1746" class="mi">u</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1747" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-231" type="math/tex">u \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> MakeNode</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-232-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-1748" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1001.46em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1749" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1750" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1751" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1752" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.302em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>,</mo><mi>n</mi></math></span></span><script id="MathJax-Element-232" type="math/tex">i,n</script>)<br>
    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-233-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.966em; display: inline-block;" role="math" id="MathJax-Span-1753" class="math"><span style="display: inline-block; position: relative; width: 7.478em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.46em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1754" class="mrow"><span id="MathJax-Span-1755" class="texatom"><span id="MathJax-Span-1756" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1757" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1758" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1759" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1760" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1761" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1762" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1763" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1764" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1765" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1766" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1767" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1768" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1769" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1770" class="mi">k</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>k</mi></math></span></span><script id="MathJax-Element-233" type="math/tex">\mathrm{nodelabel}(u) \leftarrow k</script><br>
   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-234-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1771" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.53em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1772" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1773" class="mi">u</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script id="MathJax-Element-234" type="math/tex">u</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code của giả mã bằng C. Code đầy đủ được đính ở cuối bài.</p>
<div><div id="highlighter_513138" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#define ALPHABET_SIZE 27 // the size of the alphabet</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">char</code> <code class="cpp plain">*T;</code></div><div class="line number3 index2 alt2"><code class="cpp color1 bold">char</code> <code class="cpp plain">Alphabet[ALPHABET_SIZE]= </code><code class="cpp string">"abcdefghijklmnopqrstuvwxyz{"</code><code class="cpp plain">;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="cpp keyword bold">typedef</code> <code class="cpp keyword bold">struct</code> <code class="cpp plain">snode {</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">leftEL;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">rightEL;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">node_label;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code> <code class="cpp plain">snode** Cr; </code><code class="cpp comments">// children pointers</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code> <code class="cpp plain">snode *parent;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">leafcnt;&nbsp; </code><code class="cpp comments">// the number of leaves of the subtree rooted at this node</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">strdepth; </code><code class="cpp comments">// the string depth</code></div><div class="line number13 index12 alt2"><code class="cpp plain">} snode;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp plain">snode *native_suffix_tree(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*Txt){</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">T = Txt;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">n = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(T)-1;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *root = init_suffix_tree(n);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlt = 0,mlp=0;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *v = NULL;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">rv,lv;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *x;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 2; i &lt;= n ;i++){</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">v = find_path(T,i,n,root, &amp;mlp, &amp;mlt);</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">lv = v-&gt;leftEL;</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">rv = v-&gt;rightEL;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(mlt &lt; rv){</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">v-&gt;leftEL = mlt+1;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x = make_node(lv,mlt);</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">replace_parent(x,v);</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x = v;</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *u = make_leaf(mlp+1,n,i);</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;parent = x;</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;Cr[get_index(T[mlp+1])]&nbsp; = u; </code><code class="cpp comments">// T[mlp+1] is the first character of the edge xu</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">root;</code></div><div class="line number40 index39 alt1"><code class="cpp plain">}</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="cpp plain">snode *find_path(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*P, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">first, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">last, snode *r, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">*mlp, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">*mlt){</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *c = r-&gt;Cr[get_index(P[first])];</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(c == NULL || first &gt; last){</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*mlt = r-&gt;rightEL;</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*mlp = first-1;</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = first;</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = c-&gt;leftEL;</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">rc = c-&gt;rightEL;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(P[i] == T[j] &amp;&amp; j &lt;= rc){</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">i++; j++;</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( j &gt; rc){</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">find_path(P,i, last,c,mlp,mlt);</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*mlt = j-1;</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*mlp = i-1;</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">c;</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number63 index62 alt2"><code class="cpp plain">}</code></div><div class="line number64 index63 alt1">&nbsp;</div><div class="line number65 index64 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">replace_parent(snode *x, snode *v){</code></div><div class="line number66 index65 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *pv = v-&gt;parent;</code></div><div class="line number67 index66 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">lx = x-&gt;leftEL;</code></div><div class="line number68 index67 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">lv = v-&gt;leftEL;</code></div><div class="line number69 index68 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pv-&gt;Cr[get_index(T[lx])] = x;</code></div><div class="line number70 index69 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;Cr[get_index(T[lv])] = v;</code></div><div class="line number71 index70 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">v-&gt;parent = x;</code></div><div class="line number72 index71 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;parent = pv;</code></div><div class="line number73 index72 alt2"><code class="cpp plain">}</code></div><div class="line number74 index73 alt1">&nbsp;</div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1"><code class="cpp plain">snode *init_suffix_tree(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">n){</code></div><div class="line number77 index76 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *r = make_node(0,0);</code></div><div class="line number78 index77 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *u = make_leaf(1,n,1);</code></div><div class="line number79 index78 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">r-&gt;Cr[get_index(T[1])] = u;</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;parent = r;</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number82 index81 alt1"><code class="cpp plain">}</code></div><div class="line number83 index82 alt2">&nbsp;</div><div class="line number84 index83 alt1">&nbsp;</div><div class="line number85 index84 alt2"><code class="cpp plain">snode *make_node(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">j){</code></div><div class="line number86 index85 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *u&nbsp; = </code><code class="cpp functions bold">malloc</code><code class="cpp plain">(</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(snode));</code></div><div class="line number87 index86 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;leftEL = i;</code></div><div class="line number88 index87 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;rightEL = j;</code></div><div class="line number89 index88 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;node_label = 0;</code></div><div class="line number90 index89 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;Cr = </code><code class="cpp functions bold">malloc</code><code class="cpp plain">(ALPHABET_SIZE*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(snode));</code></div><div class="line number91 index90 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;parent = NULL;</code></div><div class="line number92 index91 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;leafcnt = 0;</code></div><div class="line number93 index92 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;strdepth = 0;</code></div><div class="line number94 index93 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memset</code><code class="cpp plain">(u-&gt;Cr, 0, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(*u-&gt;Cr));</code></div><div class="line number95 index94 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">u;</code></div><div class="line number96 index95 alt1"><code class="cpp plain">}</code></div><div class="line number97 index96 alt2">&nbsp;</div><div class="line number98 index97 alt1"><code class="cpp plain">snode *make_leaf(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i,</code><code class="cpp color1 bold">int</code> <code class="cpp plain">n, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">k){</code></div><div class="line number99 index98 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *u = make_node(i,n);</code></div><div class="line number100 index99 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">u-&gt;node_label = k;</code></div><div class="line number101 index100 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">u;</code></div><div class="line number102 index101 alt1"><code class="cpp plain">}</code></div><div class="line number103 index102 alt2">&nbsp;</div><div class="line number104 index103 alt1"><code class="cpp comments">// Get the index of a character in the alphabet</code></div><div class="line number105 index104 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">get_index(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">c){</code></div><div class="line number106 index105 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">c - </code><code class="cpp string">'a'</code><code class="cpp plain">;</code></div><div class="line number107 index106 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Phân tích thuật toán:</b> Trước hết ta phân tích xem cây hậu tố ở trên có tối đa bao nhiêu nút. Dễ dàng thấy số nút lá của cây hậu tố là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-235-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1774" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1775" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1776" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-235" type="math/tex">n</script>,
 bằng kích thước của văn bản đầu vào, vì mỗi nút lá ứng với một hậu tố. 
Trong quá trình xây dựng cây hậu tố, một nút trong chỉ xuất hiện khi 
chèn thêm một hậu tố mới. Do đó, số nút trong của cây không thể vượt quá
 <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-236-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1777" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1778" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1779" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-236" type="math/tex">n</script> là số nút lá. Do đó, cây hậu tố có tối đa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-237-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.5em; display: inline-block;" role="math" id="MathJax-Span-1780" class="math"><span style="display: inline-block; position: relative; width: 1.112em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1001.09em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1781" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1782" class="mn">2</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1783" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi></math></span></span><script id="MathJax-Element-237" type="math/tex">2n</script> nút. </p>
<p>Nếu biểu diễn con trỏ tới các nút con bằng mảng như thực hiện ở trên, thì cần <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-238-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-1784" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.24em, 2.721em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1785" class="mrow"><span id="MathJax-Span-1786" class="texatom"><span id="MathJax-Span-1787" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1788" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1789" class="mi">Σ</span><span id="MathJax-Span-1790" class="texatom"><span id="MathJax-Span-1791" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1792" class="mo">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.493em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script id="MathJax-Element-238" type="math/tex">|\Sigma|</script> con trỏ cho mỗi nút trong của cây. Do đó, mỗi nút chiếm bộ nhớ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-239-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.979em; display: inline-block;" role="math" id="MathJax-Span-1793" class="math"><span style="display: inline-block; position: relative; width: 2.225em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.13em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1794" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1795" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1796" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1797" class="mi">Σ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1798" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-239" type="math/tex">O(\Sigma)</script> để biểu diễn và tổng bộ nhớ cần để biểu diễn cây là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-240-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.623em; display: inline-block;" role="math" id="MathJax-Span-1799" class="math"><span style="display: inline-block; position: relative; width: 3.461em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.37em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1800" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1801" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1802" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1803" class="mi">n</span><span id="MathJax-Span-1804" class="texatom"><span id="MathJax-Span-1805" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1806" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1807" class="mi">Σ</span><span id="MathJax-Span-1808" class="texatom"><span id="MathJax-Span-1809" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1810" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1811" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-240" type="math/tex">O(n|\Sigma|)</script>.
 Tuy nhiên, nếu ta biểu diễn con trỏ tới các nút con là một danh sách, 
thì số lượng con trỏ của tất cả các nút trong không lớn hơn số cạnh của 
cây hậu tố. Vì cây hậu tố có tối đa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-241-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.5em; display: inline-block;" role="math" id="MathJax-Span-1812" class="math"><span style="display: inline-block; position: relative; width: 1.112em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1001.09em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1813" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1814" class="mn">2</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1815" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi></math></span></span><script id="MathJax-Element-241" type="math/tex">2n</script> nút, nó sẽ có tối đa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-242-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1816" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1002.77em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1817" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1818" class="mn">2</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1819" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1820" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1821" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-242" type="math/tex">2n-1</script> cạnh và do đó số con trỏ đó không quá <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-243-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1822" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1002.77em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1823" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1824" class="mn">2</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1825" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1826" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1827" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-243" type="math/tex">2n-1</script>. Như vậy, bộ nhớ để biểu diễn cây trong trường hợp này là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-244-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.815em; display: inline-block;" role="math" id="MathJax-Span-1828" class="math"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.01em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1829" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1830" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1831" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1832" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1833" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-244" type="math/tex">O(n)</script>.</p>
<p>Về mặt thời gian, có thể thấy rằng thuật toán xây dựng cây hậu tố trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-245-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1834" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1835" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1836" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-245" type="math/tex">n</script> bước. Bước thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-246-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1837" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1838" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1839" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-246" type="math/tex">i</script> tìm kiếm hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-247-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.555em; display: inline-block;" role="math" id="MathJax-Span-1840" class="math"><span style="display: inline-block; position: relative; width: 7.169em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.05em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1841" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1842" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1843" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1844" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1845" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1846" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1847" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1848" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1849" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1850" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1851" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1852" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1853" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-247" type="math/tex">T[i,i+1,\ldots,n]</script> trong cây hậu tố đang xây dựng hiện tại. Bước này sử dụng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-248-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.281em; display: inline-block;" role="math" id="MathJax-Span-1854" class="math"><span style="display: inline-block; position: relative; width: 3.955em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1003.88em, 2.616em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1855" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1856" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1857" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1858" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1859" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1860" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.191em; border-left: 0px solid; width: 0px; height: 1.159em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-248" type="math/tex">n-i+1</script> (là chiều dài của hậu tố <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-249-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1861" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.93em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1862" class="mrow"><span id="MathJax-Span-1863" class="msubsup"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.126em, 1000.65em, 4.224em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1864" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.613em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1865" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-249" type="math/tex">S_i</script>) phép so sánh để tìm kiếm. Do đó, tổng thời gian của thuật toán là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-250-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 18.267em; display: inline-block;" role="math" id="MathJax-Span-1866" class="math"><span style="display: inline-block; position: relative; width: 13.719em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1013.62em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1867" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1868" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1869" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1870" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1871" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1872" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1873" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1874" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1875" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1876" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1877" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1878" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1879" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1880" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1881" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1882" class="mo">(</span><span id="MathJax-Span-1883" class="msubsup"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.58em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1884" class="mi">n</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.6em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1885" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1886" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.606em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>+</mo><mo>…</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-250" type="math/tex">O(n+ n-1+\ldots + 1) = O(n^2)</script>.</p>
<p><strong> <font size="4"> Phụ lục các truy vấn</font> </strong></p>
<p><b>Truy vấn 1</b></p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> IsSubstring</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-251-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.13em; display: inline-block;" role="math" id="MathJax-Span-1887" class="math"><span style="display: inline-block; position: relative; width: 7.601em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1888" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1889" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1890" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1891" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1892" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1893" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1894" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1895" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1896" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1897" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1898" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1899" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1900" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1901" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-251" type="math/tex">P[1,2,\ldots,m], Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-252-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-1902" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1903" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1904" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1905" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1906" class="texatom"><span id="MathJax-Span-1907" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1908" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1909" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1910" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1911" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1912" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1913" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1914" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1915" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-252" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-253-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1916" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.56em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1917" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1918" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1919" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1920" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1921" class="texatom"><span id="MathJax-Span-1922" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1923" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1924" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1925" class="mi">p</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1926" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1927" class="texatom"><span id="MathJax-Span-1928" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1929" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1930" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1931" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1932" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1933" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-253" type="math/tex">(v,\mathrm{mlp},\mathrm{mlt}) \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-254-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-1934" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.84em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1935" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1936" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1937" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1938" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1939" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1940" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1941" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1942" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1943" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1944" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1945" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1946" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1947" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>r</mi></math></span></span><script id="MathJax-Element-254" type="math/tex">P[1,2,\ldots,m], r</script>)<br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-255-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-1948" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1003.87em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1949" class="mrow"><span id="MathJax-Span-1950" class="texatom"><span id="MathJax-Span-1951" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1952" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1953" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1954" class="mi">p</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1955" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1956" class="mi">m</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>=</mo><mi>m</mi></math></span></span><script id="MathJax-Element-255" type="math/tex">\mathrm{mlp} = m</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> True</font><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> False</font><br>
 </font>
</div>
<p>&nbsp;</p>
<p>Code của giả mã bằng C:</p>
<div><div id="highlighter_70597" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">is_substring(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*P, snode *r){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlp = 0;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlt = 0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">m = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(P)-1;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">find_path(P, 1, m, r, &amp;mlp, &amp;mlt);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( m == mlp){</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">TRUE;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">FALSE;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Truy vấn 2</b></p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> IsSuffix</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-256-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.13em; display: inline-block;" role="math" id="MathJax-Span-1957" class="math"><span style="display: inline-block; position: relative; width: 7.601em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1958" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1959" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1960" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1961" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1962" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1963" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1964" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1965" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1966" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1967" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1968" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1969" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1970" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1971" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-256" type="math/tex">P[1,2,\ldots,m], Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-257-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-1972" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1973" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1974" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1975" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1976" class="texatom"><span id="MathJax-Span-1977" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1978" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1979" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1980" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1981" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1982" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1983" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1984" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1985" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-257" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-258-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1986" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.56em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1987" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1988" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1989" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1990" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1991" class="texatom"><span id="MathJax-Span-1992" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1993" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1994" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1995" class="mi">p</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1996" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1997" class="texatom"><span id="MathJax-Span-1998" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1999" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2000" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2001" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2002" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2003" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-258" type="math/tex">(v,\mathrm{mlp},\mathrm{mlt}) \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-259-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-2004" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.84em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2005" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2006" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2007" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2008" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2009" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2010" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2011" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2012" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2013" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2014" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2015" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2016" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2017" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>r</mi></math></span></span><script id="MathJax-Element-259" type="math/tex">P[1,2,\ldots,m], r</script>)<br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-260-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-2018" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.43em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2019" class="mrow"><span id="MathJax-Span-2020" class="texatom"><span id="MathJax-Span-2021" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2022" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2023" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2024" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2025" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2026" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2027" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2028" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2029" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2030" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2031" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2032" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2033" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2034" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≠</mo></math></span></span><script id="MathJax-Element-260" type="math/tex">\mathrm{nodelabel}(v) \not= </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-261-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.966em; display: inline-block;" role="math" id="MathJax-Span-2035" class="math"><span style="display: inline-block; position: relative; width: 7.478em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.38em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2036" class="mrow"><span id="MathJax-Span-2037" class="texatom"><span id="MathJax-Span-2038" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2039" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2040" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2041" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2042" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-2043" class="texatom"><span id="MathJax-Span-2044" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2045" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2046" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2047" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2048" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2049" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2050" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2051" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2052" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2053" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2054" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-261" type="math/tex">\mathrm{mlt} = \mathrm{rightEL}(v)</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> True</font><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> False</font><br>
 </font>
</div>
<p>&nbsp;<br>
Code của giả mã bằng C:</p>
<div><div id="highlighter_242147" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">is_suffix(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*P, </code><code class="cpp color1 bold">char</code> <code class="cpp plain">*T){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *root = native_suffix_tree(T);</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlp = 0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlt = 0;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">m = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(P)-1;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *v = find_path(P, 1, m, root, &amp;mlp, &amp;mlt);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( v-&gt;node_label != 0 &amp;&amp; v-&gt;rightEL == mlt){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">TRUE;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">FALSE;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number12 index11 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Truy vấn 3</b></p>
<p>Như đã nhắc đến ở trên, để thực hiện truy vấn này, với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-262-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2055" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2056" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2057" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-262" type="math/tex">v</script>, chúng ta lưu thêm một trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-263-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-2058" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.11em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2059" class="mrow"><span id="MathJax-Span-2060" class="texatom"><span id="MathJax-Span-2061" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2062" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2063" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2064" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2065" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2066" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2067" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2068" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2069" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2070" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2071" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-263" type="math/tex">\mathrm{leafcnt}(v)</script> lưu số lượng nút lá của cây con gốc <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-264-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2072" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2073" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2074" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-264" type="math/tex">v</script>. Thông tin này có thể được cập nhật trong quá trình xây dựng cây mà không làm giảm thời gian tiệm cận xây dựng cây.  </p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> CountOccurence</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-265-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.13em; display: inline-block;" role="math" id="MathJax-Span-2075" class="math"><span style="display: inline-block; position: relative; width: 7.601em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2076" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2077" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2078" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2079" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2080" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2081" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2082" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2083" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2084" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2085" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2086" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2087" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2088" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2089" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-265" type="math/tex">P[1,2,\ldots,m],Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-266-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-2090" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2091" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2092" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2093" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2094" class="texatom"><span id="MathJax-Span-2095" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2096" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2097" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2098" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2099" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2100" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2101" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2102" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2103" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-266" type="math/tex">r \leftarrow\mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-267-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-2104" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.56em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2105" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2106" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2107" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2108" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2109" class="texatom"><span id="MathJax-Span-2110" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2111" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2112" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2113" class="mi">p</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2114" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2115" class="texatom"><span id="MathJax-Span-2116" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2117" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2118" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2119" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2120" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2121" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-267" type="math/tex">(v,\mathrm{mlp},\mathrm{mlt}) \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> FindPath</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-268-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-2122" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.84em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2123" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2124" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2125" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2126" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2127" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2128" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2129" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2130" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2131" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2132" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2133" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2134" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2135" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo><mo>,</mo><mi>r</mi></math></span></span><script id="MathJax-Element-268" type="math/tex">P[1,2,\ldots,m], r</script>)<br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-269-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-2136" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.385em, 1003.87em, 2.687em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2137" class="mrow"><span id="MathJax-Span-2138" class="texatom"><span id="MathJax-Span-2139" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2140" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2141" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2142" class="mi">p</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2143" class="mo">≠</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2144" class="mi">m</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">p</mi></mrow><mo>≠</mo><mi>m</mi></math></span></span><script id="MathJax-Element-269" type="math/tex">\mathrm{mlp} \not= m</script>    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;<i>[[<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-270-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-2145" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.74em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2146" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2147" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script id="MathJax-Element-270" type="math/tex">P</script> is not  a substring of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-271-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2148" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1000.68em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2149" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2150" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-271" type="math/tex">T</script>]]</i><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return 0<br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-272-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-2151" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.11em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2152" class="mrow"><span id="MathJax-Span-2153" class="texatom"><span id="MathJax-Span-2154" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2155" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2156" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2157" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2158" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2159" class="mi">c</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2160" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2161" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2162" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2163" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2164" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-272" type="math/tex">\mathrm{leafcnt}(v)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code của giả mã bằng C:</p>
<div><div id="highlighter_758278" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">count_occurence(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*P, snode *r){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlp = 0;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">mlt = 0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">m = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(P)-1;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *v = find_path(P, 1, m, r, &amp;mlp, &amp;mlt);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(mlp &lt; m) </code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">v-&gt;leafcnt;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Truy vấn 4</b></p>
<p>Để thực hiện truy vấn này, với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-273-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2165" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2166" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2167" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-273" type="math/tex">v</script>, chúng ta lưu thêm một trường <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-274-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.432em; display: inline-block;" role="math" id="MathJax-Span-2168" class="math"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.72em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2169" class="mrow"><span id="MathJax-Span-2170" class="texatom"><span id="MathJax-Span-2171" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2172" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2173" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2174" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2175" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2176" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2177" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2178" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2179" class="mi">h</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2180" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2181" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2182" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-274" type="math/tex">\mathrm{strdepth}(v)</script> lưu string depth của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-275-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2183" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2184" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2185" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-275" type="math/tex">v</script>. Thông tin này có thể được cập nhật trong quá trình xây dựng cây mà không làm giảm thời gian tiệm cận xây dựng cây.  </p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> LongestRepeatedSubstring</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-276-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-2186" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2187" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2188" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2189" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-276" type="math/tex">Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-277-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-2190" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2191" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2192" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2193" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2194" class="texatom"><span id="MathJax-Span-2195" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2196" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2197" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2198" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2199" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2200" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2201" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2202" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2203" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-277" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-278-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.966em; display: inline-block;" role="math" id="MathJax-Span-2204" class="math"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.345em, 1002.91em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2205" class="mrow"><span id="MathJax-Span-2206" class="texatom"><span id="MathJax-Span-2207" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2208" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2209" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2210" class="mi">n</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2211" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-278" type="math/tex">\mathrm{dpn} \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> FindNonleafDeepestNode</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-279-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-2212" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1001.12em, 2.482em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2213" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2214" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2215" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-279" type="math/tex">Ts</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-280-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-2216" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.345em, 1003.88em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2217" class="mrow"><span id="MathJax-Span-2218" class="texatom"><span id="MathJax-Span-2219" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2220" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2221" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2222" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2223" class="texatom"><span id="MathJax-Span-2224" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2225" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2226" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2227" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-280" type="math/tex">\mathrm{it} \leftarrow \mathrm{dpn}</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-281-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-2228" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.37em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2229" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2230" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2231" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2232" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-281" type="math/tex">i \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-282-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-2233" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.385em, 1002.45em, 2.687em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2234" class="mrow"><span id="MathJax-Span-2235" class="texatom"><span id="MathJax-Span-2236" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2237" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2238" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2239" class="mo">≠</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2240" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo>≠</mo><mi>r</mi></math></span></span><script id="MathJax-Element-282" type="math/tex">\mathrm{it} \not= r</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-283-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.24em; display: inline-block;" role="math" id="MathJax-Span-2241" class="math"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.09em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2242" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2243" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2244" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2245" class="texatom"><span id="MathJax-Span-2246" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2247" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2248" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2249" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2250" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2251" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2252" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2253" class="mo">(</span><span id="MathJax-Span-2254" class="texatom"><span id="MathJax-Span-2255" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2256" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2257" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2258" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-283" type="math/tex">j \leftarrow \mathrm{leftEL}(\mathrm{it})</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-284-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-2259" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.52em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2260" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2261" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2262" class="mo">≤</span><span style="padding-left: 0.278em;" id="MathJax-Span-2263" class="texatom"><span id="MathJax-Span-2264" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2265" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2266" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2267" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2268" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2269" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2270" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2271" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2272" class="mo">(</span><span id="MathJax-Span-2273" class="texatom"><span id="MathJax-Span-2274" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2275" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2276" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2277" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≤</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-284" type="math/tex">j \leq \mathrm{rightEL}(\mathrm{it})</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-285-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.514em; display: inline-block;" role="math" id="MathJax-Span-2278" class="math"><span style="display: inline-block; position: relative; width: 4.882em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.76em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2279" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2280" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2281" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2282" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2283" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2284" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2285" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2286" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2287" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2288" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>T</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-285" type="math/tex">S[i] \leftarrow T[j]</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-286-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.527em; display: inline-block;" role="math" id="MathJax-Span-2289" class="math"><span style="display: inline-block; position: relative; width: 8.652em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1008.58em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2290" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2291" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2292" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2293" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2294" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2295" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2296" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2297" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2298" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2299" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2300" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2301" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-286" type="math/tex">i \leftarrow i+1, j \leftarrow j+1</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-287-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.568em; display: inline-block;" role="math" id="MathJax-Span-2302" class="math"><span style="display: inline-block; position: relative; width: 6.427em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.289em, 1006.33em, 2.66em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2303" class="mrow"><span id="MathJax-Span-2304" class="texatom"><span id="MathJax-Span-2305" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2306" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2307" class="mi">t</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2308" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2309" class="texatom"><span id="MathJax-Span-2310" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2311" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2312" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2313" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2314" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2315" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2316" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2317" class="mo">(</span><span id="MathJax-Span-2318" class="texatom"><span id="MathJax-Span-2319" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2320" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2321" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2322" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-287" type="math/tex">\mathrm{it} \leftarrow \mathrm{parent}(\mathrm{it})</script><br>
   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> Reverse</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-288-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2323" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.68em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2324" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2325" class="mi">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script id="MathJax-Element-288" type="math/tex">S</script>)<br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> FindNonleafDeepestNode</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-289-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-2326" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2327" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2328" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2329" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-289" type="math/tex">Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-290-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-2330" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2331" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2332" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2333" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2334" class="texatom"><span id="MathJax-Span-2335" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2336" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2337" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2338" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2339" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2340" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2341" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2342" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2343" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-290" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-291-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-2344" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.43em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2345" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2346" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2347" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2348" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-291" type="math/tex">j \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-292-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.048em; display: inline-block;" role="math" id="MathJax-Span-2349" class="math"><span style="display: inline-block; position: relative; width: 3.028em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1002.97em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2350" class="mrow"><span id="MathJax-Span-2351" class="texatom"><span id="MathJax-Span-2352" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2353" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2354" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2355" class="mi">p</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2356" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.24em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-292" type="math/tex">\mathrm{tmp} \leftarrow </script>  <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-293-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.87em; display: inline-block;" role="math" id="MathJax-Span-2357" class="math"><span style="display: inline-block; position: relative; width: 3.646em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1003.63em, 2.666em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2358" class="mrow"><span id="MathJax-Span-2359" class="texatom"><span id="MathJax-Span-2360" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2361" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2362" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2363" class="mi">n</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2364" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2365" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">←</mo><mi>r</mi></math></span></span><script id="MathJax-Element-293" type="math/tex">\mathrm{dpn} \leftarrow r</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-294-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-2366" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.34em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2367" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2368" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2369" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2370" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-294" type="math/tex">i \leftarrow 1</script> to <font style="font: normal verdana; font-variant: small-caps"> AlphabetSize</font><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-295-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.774em; display: inline-block;" role="math" id="MathJax-Span-2371" class="math"><span style="display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.27em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2372" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2373" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2374" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2375" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2376" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2377" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2378" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2379" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2380" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2381" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>≠</mo></math></span></span><script id="MathJax-Element-295" type="math/tex">Cr[r][i] \not= </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-296-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.336em; display: inline-block;" role="math" id="MathJax-Span-2382" class="math"><span style="display: inline-block; position: relative; width: 10.011em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.97em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2383" class="mrow"><span id="MathJax-Span-2384" class="texatom"><span id="MathJax-Span-2385" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2386" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2387" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2388" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2389" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2390" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2391" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2392" class="mi">b</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2393" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2394" class="mi">l</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2395" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2396" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2397" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2398" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2399" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2400" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2401" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2402" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2403" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2404" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2405" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2406" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>≠</mo><mn>0</mn></math></span></span><script id="MathJax-Element-296" type="math/tex">\mathrm{nodelabel}(Cr[r][i]) \not= 0</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-297-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.048em; display: inline-block;" role="math" id="MathJax-Span-2407" class="math"><span style="display: inline-block; position: relative; width: 3.028em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1002.97em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2408" class="mrow"><span id="MathJax-Span-2409" class="texatom"><span id="MathJax-Span-2410" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2411" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2412" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2413" class="mi">p</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2414" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.24em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-297" type="math/tex">\mathrm{tmp} \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> FindNonleafDeepestNode</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-298-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.377em; display: inline-block;" role="math" id="MathJax-Span-2415" class="math"><span style="display: inline-block; position: relative; width: 3.275em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.16em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2416" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2417" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2418" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2419" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2420" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2421" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2422" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2423" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2424" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-298" type="math/tex">Cr[r][i]</script>)<br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-299-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 17.856em; display: inline-block;" role="math" id="MathJax-Span-2425" class="math"><span style="display: inline-block; position: relative; width: 13.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.289em, 1013.32em, 2.66em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2426" class="mrow"><span id="MathJax-Span-2427" class="texatom"><span id="MathJax-Span-2428" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2429" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2430" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2431" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2432" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2433" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2434" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2435" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2436" class="mi">h</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2437" class="mo">(</span><span id="MathJax-Span-2438" class="texatom"><span id="MathJax-Span-2439" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2440" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2441" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2442" class="mi">p</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2443" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2444" class="mo">&gt;</span><span style="padding-left: 0.278em;" id="MathJax-Span-2445" class="texatom"><span id="MathJax-Span-2446" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2447" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2448" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2449" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2450" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2451" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2452" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2453" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2454" class="mi">h</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2455" class="mo">(</span><span id="MathJax-Span-2456" class="texatom"><span id="MathJax-Span-2457" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2458" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2459" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2460" class="mi">n</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2461" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">)</mo><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-299" type="math/tex">\mathrm{strdepth}(\mathrm{tmp}) > \mathrm{strdepth}(\mathrm{dpn})</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-300-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.596em; display: inline-block;" role="math" id="MathJax-Span-2462" class="math"><span style="display: inline-block; position: relative; width: 4.944em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.345em, 1004.91em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2463" class="mrow"><span id="MathJax-Span-2464" class="texatom"><span id="MathJax-Span-2465" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2466" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2467" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2468" class="mi">n</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2469" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2470" class="texatom"><span id="MathJax-Span-2471" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2472" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2473" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2474" class="mi">p</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">p</mi></mrow></math></span></span><script id="MathJax-Element-300" type="math/tex">\mathrm{dpn} \leftarrow \mathrm{tmp}</script><br>
   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-301-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-2475" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.345em, 1001.66em, 2.604em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2476" class="mrow"><span id="MathJax-Span-2477" class="texatom"><span id="MathJax-Span-2478" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2479" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2480" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2481" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.345em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-301" type="math/tex">\mathrm{dpn}</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code của giả mã bằng C:</p>
<div><div id="highlighter_297280" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">char</code> <code class="cpp plain">*longest_repeated_substr(snode *r){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode * dpn = find_nonleaf_deepest_node(r);</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*S;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">S = (</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(dpn-&gt;strdepth*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">char</code><code class="cpp plain">));</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = -1, j = 0;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *it = dpn;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(it != r){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(j = it-&gt;rightEL; j &gt;= it-&gt;leftEL; j--){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">S[++i] = T[j];</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">it = it-&gt;parent;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">strrev(S);</code></div><div class="line number14 index13 alt1"><code class="cpp plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="cpp plain">snode *find_nonleaf_deepest_node(snode *r){</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snode *dpn, *tmp;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dpn = r;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 0; i &lt; ALPHABET_SIZE; i++){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;Cr[i] != NULL &amp;&amp; r-&gt;Cr[i]-&gt;node_label == 0){</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">tmp = find_nonleaf_deepest_node(r-&gt;Cr[i]);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(tmp-&gt;strdepth &gt; j){</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = tmp-&gt;strdepth;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dpn = tmp;</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">dpn;</code></div><div class="line number31 index30 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Truy vấn 5</b></p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> PrintSmallestLexSuffix</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-302-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-2482" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1001.12em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2483" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2484" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2485" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.078em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>s</mi></math></span></span><script id="MathJax-Element-302" type="math/tex">Ts</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-303-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-2486" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2487" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2488" class="mi">r</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2489" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-2490" class="texatom"><span id="MathJax-Span-2491" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2492" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2493" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2494" class="mi">o</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2495" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2496" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2497" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2498" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2499" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-303" type="math/tex">r \leftarrow \mathrm{root}(Ts)</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-304-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.747em; display: inline-block;" role="math" id="MathJax-Span-2500" class="math"><span style="display: inline-block; position: relative; width: 5.809em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.77em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2501" class="mrow"><span id="MathJax-Span-2502" class="texatom"><span id="MathJax-Span-2503" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2504" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2505" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2506" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2507" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2508" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2509" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2510" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2511" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2512" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2513" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2514" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script id="MathJax-Element-304" type="math/tex">\mathrm{leftEL}(r) = 0</script> or <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0024;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-305-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.938em; display: inline-block;" role="math" id="MathJax-Span-2515" class="math"><span style="display: inline-block; position: relative; width: 4.449em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.39em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2516" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2517" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2518" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2519" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2520" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2521" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2522" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2523" class="mi">$</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2524" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2525" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi mathvariant="normal">$</mi><mo stretchy="false">]</mo><mo>≠</mo></math></span></span><script id="MathJax-Element-305" type="math/tex">Cr[r][\$] \not=</script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-306-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-2526" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.37em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2527" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2528" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2529" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2530" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-306" type="math/tex">i \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-307-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-2531" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2532" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2533" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-307" type="math/tex">i</script> &lt; <font style="font: normal verdana; font-variant: small-caps"> AlphabetSize</font> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-308-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.774em; display: inline-block;" role="math" id="MathJax-Span-2534" class="math"><span style="display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.27em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2535" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2536" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2537" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2538" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2539" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2540" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2541" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2542" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2543" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2544" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo></math></span></span><script id="MathJax-Element-308" type="math/tex">Cr[r][i] = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-309-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.363em; display: inline-block;" role="math" id="MathJax-Span-2545" class="math"><span style="display: inline-block; position: relative; width: 4.017em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1003.94em, 2.554em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2546" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2547" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2548" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2549" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2550" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2551" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.191em; border-left: 0px solid; width: 0px; height: 1.159em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-309" type="math/tex">i \leftarrow i+1</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-310-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-2552" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.385em, 1001.43em, 2.687em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2553" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2554" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2555" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.368em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≠</mo></math></span></span><script id="MathJax-Element-310" type="math/tex">i \not= </script> <font style="font: normal verdana; font-variant: small-caps"> AlphabetSize</font><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; print <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;E&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-311-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 23.692em; display: inline-block;" role="math" id="MathJax-Span-2556" class="math"><span style="display: inline-block; position: relative; width: 17.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1017.68em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2557" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2558" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2559" class="mo">[</span><span id="MathJax-Span-2560" class="texatom"><span id="MathJax-Span-2561" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2562" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2563" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2564" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2565" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2566" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2567" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2568" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2569" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2570" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2571" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2572" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2573" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2574" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2575" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2576" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2577" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2578" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2579" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2580" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2581" class="texatom"><span id="MathJax-Span-2582" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2583" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2584" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2585" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2586" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2587" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2588" class="mi">E</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2589" class="mi">L</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2590" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2591" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2592" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2593" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2594" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2595" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2596" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2597" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2598" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2599" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2600" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">(</mo><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-311" type="math/tex">T[\mathrm{leftEL}(Cr[r][i]), \ldots, \mathrm{rightEL}(Cr[r][i])]</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> PrintSmallestLexSuffix</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-312-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.377em; display: inline-block;" role="math" id="MathJax-Span-2601" class="math"><span style="display: inline-block; position: relative; width: 3.275em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.16em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2602" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2603" class="mi">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2604" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2605" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2606" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2607" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2608" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2609" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2610" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>r</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-312" type="math/tex">Cr[r][i]</script>):<br>
 </font>
</div>
<p>&nbsp;<br>
Code của giả mã bằng C:</p>
<div><div id="highlighter_113045" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">print_smallest_lex_suffix(snode *r){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0, j, jj = 0;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;leftEL == 0 || r-&gt;Cr[get_index(</code><code class="cpp string">'{'</code><code class="cpp plain">)] == NULL){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(i &lt; ALPHABET_SIZE &amp;&amp; r-&gt;Cr[i] == NULL)i++;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(i != ALPHABET_SIZE){</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = r-&gt;Cr[i]-&gt;leftEL;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jj = r-&gt;Cr[i]-&gt;rightEL;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; j &lt;= jj; j++){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%c"</code><code class="cpp plain">, T[j]);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">print_smallest_lex_suffix(r-&gt;Cr[i]);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number14 index13 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Code: <a href="http://www.giaithuatlaptrinh.com/wp-content/uploads/2015/08/NativeSuffixTree.c.tar.gz" target="_blank">suffixtree-and-queries</a>. </p>
<p><strong><font size="4">Tham khảo</font></strong></p>
<p>[1] Weiner, Peter. <i>Linear pattern matching algorithms.</i> Switching and Automata Theory, 1973. SWAT'08. IEEE Conference Record of 14th Annual Symposium on. IEEE, 1973.<br>
[2] Gusfield, Dan. <i>Algorithms on strings, trees and sequences: computer science and computational biology, Chapter 5,6</i>. Cambridge university press, 1997.<br>
[3]  Carl Kingsford. <i><a href="https://www.cs.cmu.edu/%7Eckingsf/bioinfo-lectures/suffixtrees.pdf" target="_blank">Suffix Tree Lecture Note</a></i>. CMSC 423, CMU.</p>
<p><strong><font size="3">Footnotes</font></strong></p>
<p>[<a id="suffix">1</a>] Hậu tố của một xâu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-313-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-2611" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2612" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2613" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2614" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2615" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2616" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2617" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2618" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2619" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2620" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2621" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2622" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-313" type="math/tex">T[1,2,\ldots,n]</script> là một xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-314-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2623" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2624" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2625" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-314" type="math/tex">T</script> có dạng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-315-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.555em; display: inline-block;" role="math" id="MathJax-Span-2626" class="math"><span style="display: inline-block; position: relative; width: 7.169em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.05em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2627" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2628" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2629" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2630" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2631" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2632" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2633" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2634" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2635" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2636" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2637" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2638" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2639" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-315" type="math/tex">T[i,i+1,\ldots,n]</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-316-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-2640" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2641" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2642" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-316" type="math/tex">i</script> là một số nào đó thỏa mãn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-317-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-2643" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1004.18em, 2.672em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2644" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2645" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2646" class="mo">≤</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2647" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2648" class="mo">≤</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2649" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left: 0px solid; width: 0px; height: 1.234em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></math></span></span><script id="MathJax-Element-317" type="math/tex">1 \leq i \leq n</script>. Ví dụ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;A&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;B&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;C&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;D&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;A&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-318-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-2650" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.447em, 1006.31em, 2.555em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2651" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2652" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2653" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-2654" class="texatom"><span id="MathJax-Span-2655" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2656" class="mi">A</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2657" class="mi">B</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2658" class="mi">C</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2659" class="mi">D</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2660" class="mi">A</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2661" class="mi">B</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.11em; border-left: 0px solid; width: 0px; height: 1.145em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">A</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">D</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">B</mi></mrow></math></span></span><script id="MathJax-Element-318" type="math/tex">T = \mathrm{ABCDAB}</script> thì <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;D&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;A&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-319-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.897em; display: inline-block;" role="math" id="MathJax-Span-2662" class="math"><span style="display: inline-block; position: relative; width: 2.163em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.385em, 1002.11em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2663" class="mrow"><span id="MathJax-Span-2664" class="texatom"><span id="MathJax-Span-2665" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2666" class="mi">D</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2667" class="mi">A</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2668" class="mi">B</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.117em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">D</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">B</mi></mrow></math></span></span><script id="MathJax-Element-319" type="math/tex">\mathrm{DAB}</script> là một hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-320-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2669" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2670" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2671" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-320" type="math/tex">T</script>. Chú ý <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-321-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2672" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2673" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2674" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-321" type="math/tex">T</script> là hậu tố của chính nó. </p>
<p>[<a id="proper-suffix">2</a>] Một hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-322-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2675" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2676" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2677" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-322" type="math/tex">T</script> được gọi là một hậu tố riêng (proper suffix) nếu hậu tố đó khác <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-323-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2678" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2679" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2680" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-323" type="math/tex">T</script>. </p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-420" class="share-twitter sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=420&amp;share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-420" class="share-facebook sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=420&amp;share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-420" class="share-google-plus-1 sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=420&amp;share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div style="display: block;" id="jp-relatedposts" class="jp-relatedposts" data-exclude="703">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="488" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="0" data-origin="420" rel="nofollow" title="Mảng hậu tố-- Suffix Array

Nhưng đã giới thiệu ở bài trước, cây hậu tố là một cấu trúc dữ liệu rất mạnh để thực hiện nhiều truy vấn văn bản với thời gian $$O(n)$$. Tuy nhiên, điểm yếu chính của cây hậu tố là bộ nhớ lớn do mỗi nút của cây phải lưu…" href="http://www.giaithuatlaptrinh.com/?p=488" class="jp-relatedposts-post-a">Mảng hậu tố-- Suffix Array</a></span><span class="jp-relatedposts-post-date">September 6, 2015</span><span class="jp-relatedposts-post-context">In "Rabin Karp"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="238" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="1" data-origin="420" rel="nofollow" title="Thuật toán Knuth-Morris-Pratt -- KMP string matching

Trong loạt bài này mình giới thiệu các thuật toán thao tác với các xâu kí tự. Chúng ta bắt đầu bằng bài toán cơ bản nhất: tìm sự xuất hiện của một xâu kí tự trong một văn bản. Problem 1: Cho một văn bản $$T[1,2,\ldots,n]$$ có chiều dài…" href="http://www.giaithuatlaptrinh.com/?p=238" class="jp-relatedposts-post-a">Thuật toán Knuth-Morris-Pratt -- KMP string matching</a></span><span class="jp-relatedposts-post-date">July 19, 2015</span><span class="jp-relatedposts-post-context">In "kmp"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="290" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="2" data-origin="420" rel="nofollow" title="Thuật toán Rabin-Karp--- Rabin-Karp algorithm

Trong bài này chúng ta sẽ tìm hiểu thuật toán Rabin-Karp áp dụng trong bài toán tìm kiếm xâu. Thuật toán được phát triển bởi Richard Karp và Michael Rabin [1] vào năm 1987. Ý tưởng trung tâm của thuật toán là coi mỗi xâu là một số nguyên và…" href="http://www.giaithuatlaptrinh.com/?p=290" class="jp-relatedposts-post-a">Thuật toán Rabin-Karp--- Rabin-Karp algorithm</a></span><span class="jp-relatedposts-post-date">August 4, 2015</span><span class="jp-relatedposts-post-context">In "Rabin Karp"</span></p></div></div>                    </div>
                    
                    <p class="tagdata"><strong>Tags:</strong> <a href="http://www.giaithuatlaptrinh.com/?tag=string-matching" rel="tag">string matching</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=string-query" rel="tag">string query</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=suffix-tree" rel="tag">suffix tree</a></p>
                
                </div> <!-- /entry -->
            
                    
            
        
        <div id="comments-header">
        <div class="clearfix">
            <h2 class="title">No comments</h2>
                      <p class="comments-feed"><a href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=420">Comments feed for this article</a></p>
                    </div>
                  <p class="trackback-link">Trackback link: <a href="http://www.giaithuatlaptrinh.com/wp-trackback.php?p=420">http://www.giaithuatlaptrinh.com/wp-trackback.php?p=420</a></p>
            </div>
    
            				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.giaithuatlaptrinh.com/?p=420&amp;relatedposts_hit=1&amp;relatedposts_origin=703&amp;relatedposts_position=1#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.giaithuatlaptrinh.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>    <div class="response textarea-wrap">
        <label for="comment">Your comment</label>
        <textarea name="comment" id="comment" cols="60" rows="10" aria-required="true" aria-multiline="true"></textarea>
    </div><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="420" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="d6ff52800a" type="hidden"></p><p class="comment-subscription-form"><input name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1465414869275" type="hidden"></form>
					</div><!-- #respond -->
		    </div>

<div id="sidebar" class="secondary">

        
</div>
</div> <!-- /main content -->



<div id="footer" class="clearfix">
    
    <div class="secondary">
        
                
    </div> <!-- /secondary -->
    
    <div class="primary">
        
                
    </div> <!-- /primary -->
    
    <div id="theme-info" class="clearfix">
        
        <div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div><div class="primary content">
    <p>Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://tarskitheme.com/">Tarski</a></p>
</div>
        
    </div> <!-- /theme-info -->
    
</div> <!-- /footer -->

</div><script type="text/x-mathjax-config;executed=true"> 
        MathJax.Hub.Config({ 
                TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}}, 
                "HTML-CSS": {linebreaks: {automatic: true}}, 
                SVG: {linebreaks: {automatic: true}}
        }); 
</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/MathJax.js">MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>	<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/www.giaithuatlaptrinh.com\/?p=420":420};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/form.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/shCore.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/shBrushCpp.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/photon.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=420&relatedposts_hit=1&relatedposts_origin=703&relatedposts_position=1&wc-ajax=%%endpoint%%","i18n_view_cart":"View Cart","cart_url":"","is_cart":"","cart_redirect_after_add":"no"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/add-to-cart.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jquery_003.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=420&relatedposts_hit=1&relatedposts_origin=703&relatedposts_position=1&wc-ajax=%%endpoint%%"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/woocommerce.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_cart_fragments_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=420&relatedposts_hit=1&relatedposts_origin=703&relatedposts_position=1&wc-ajax=%%endpoint%%","fragment_name":"wc_fragments"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/cart-fragments.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/devicepx-jetpack.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/wpgroho.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/comment-reply.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/wp-embed.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/sharing.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/e-201623.js" async="" defer="defer"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.0.3',blog:'97171708',post:'420',tz:'0',srv:'www.giaithuatlaptrinh.com'} ]);
	_stq.push([ 'clickTrackerInit', '97171708', '420' ]);
</script>

<img id="wpstats" alt=":)" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20h%E1%BA%ADu%20t%E1%BB%91%20%E2%80%94%20Suffix%20Tree_files/g.gif" width="6" height="5"><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Main,sans-serif;" id="MathJax_Font_Test"></div></div></body></html>