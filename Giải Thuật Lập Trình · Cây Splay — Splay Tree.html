<!DOCTYPE html>
<html lang="en-US"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Giải Thuật Lập Trình · Cây Splay — Splay Tree</title>
    <link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Cây Splay -- Splay Tree Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=613">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.giaithuatlaptrinh.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.2"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="woocommerce-layout-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/woocommerce-layout.css" type="text/css" media="all">
<link rel="stylesheet" id="woocommerce-smallscreen-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/woocommerce-smallscreen.css" type="text/css" media="only screen and (max-width: 768px)">
<link rel="stylesheet" id="woocommerce-general-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/woocommerce.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/dashicons.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-jquery-ui-dialog-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jquery-ui-dialog.css" type="text/css" media="all">
<link rel="stylesheet" id="ajax_shoutbox-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/ajax_shoutbox.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jquery_002.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/related-posts.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/tarski.js"></script>
<meta name="description" content="Wiki về giải thuật">
<meta name="robots" content="all">
<link rel="profile" href="http://gmpg.org/xfn/11">

<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/style.css" type="text/css" media="all">
<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/print.css" type="text/css" media="print">

<link rel="https://api.w.org/" href="http://www.giaithuatlaptrinh.com/?rest_route=/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.giaithuatlaptrinh.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.giaithuatlaptrinh.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="DFS, phân loại cung và sắp xếp Topo -- DFS, Arc Classification and Topological Sort" href="http://www.giaithuatlaptrinh.com/?p=590">
<link rel="next" title="Cây tìm kiếm ưu tiên -- Priority Search Tree" href="http://www.giaithuatlaptrinh.com/?p=643">
<meta name="generator" content="WordPress 4.5.2">
<meta name="generator" content="WooCommerce 2.5.5">
<link rel="canonical" href="http://www.giaithuatlaptrinh.com/?p=613">
<link rel="shortlink" href="http://wp.me/p6zINC-9T">
<link rel="alternate" type="application/json+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D613">
<link rel="alternate" type="text/xml+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D613&amp;format=xml">

<link rel="dns-prefetch" href="http://v0.wordpress.com/">
<link rel="dns-prefetch" href="http://i0.wp.com/">
<link rel="dns-prefetch" href="http://i1.wp.com/">
<link rel="dns-prefetch" href="http://i2.wp.com/">
<style type="text/css">img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Cây Splay -- Splay Tree">
<meta property="og:url" content="http://www.giaithuatlaptrinh.com/?p=613">
<meta property="og:description" content="Trong bài này mình sẽ giới thiệu về cấu trúc dữ liệu splay tree (do không tìm được thuật ngữ Tiếng Việt nên mình giữ nguyên thuật ngữ tiếng anh). Splay Tree được giới thiệu bởi Sleator và Tarjan và…">
<meta property="article:published_time" content="2015-12-18T02:42:53+00:00">
<meta property="article:modified_time" content="2015-12-19T08:35:43+00:00">
<meta property="og:site_name" content="Giải Thuật Lập Trình">
<meta property="og:image" content="http://www.giaithuatlaptrinh.com/wp-content/uploads/2015/12/deletion.png">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary">
<link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/shCore.css" type="text/css" rel="stylesheet"><link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/shThemeDefault.css" type="text/css" rel="stylesheet"><style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/services.css"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.6.1') format('opentype')}
</style></head>

<body id="post-cay-splay-splay-tree" class="single single-post postid-613 single-format-standard centre"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div style="display: none;" id="MathJax_Message"></div>

<div id="wrapper" class="tarski">
    <div id="header">
        <div id="title">
	<h1 id="blog-title"><a title="Return to main page" href="http://www.giaithuatlaptrinh.com/" rel="home">Giải Thuật Lập Trình</a></h1>
	<p id="tagline">Wiki về giải thuật</p></div>
<div id="navigation" class="clearfix">        <ul id="menu-primary-navigation" class="primary xoxo">
            <li><a title="Return to front page" href="http://www.giaithuatlaptrinh.com/">Home</a></li>
            <li class="page_item page-item-2"><a href="http://www.giaithuatlaptrinh.com/?page_id=2">About</a></li>
<li class="page_item page-item-4"><a href="http://www.giaithuatlaptrinh.com/?page_id=4">Các bài đã viết</a></li>

    </ul><div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div></div><script type="text/javascript">
    jQuery(document).ready(function() {
        var container = jQuery('#navigation > ul'),
            navbar;
        
        if (container.length > 0) {
            navbar = new Tarski.Navbar(container);
        }
    });
</script><p class="primary-span articlenav"><span class="previous-entry"><a href="http://www.giaithuatlaptrinh.com/?p=590" rel="prev">‹ DFS, phân loại cung và sắp xếp Topo -- DFS, Arc Classification and Topological Sort</a></span> <span class="separator">&nbsp;•&nbsp;</span> <span class="next-entry"><a href="http://www.giaithuatlaptrinh.com/?p=643" rel="next">Cây tìm kiếm ưu tiên -- Priority Search Tree ›</a></span></p>
    </div>
    
    <div id="content" class="clearfix">

<div class="primary">
        
                
                        
                <div class="entry post-613 post type-post status-publish format-standard hentry category-uncategorized tag-amortized-analysis tag-binary-search-tree tag-data-structure tag-spaly-tree">
                
                    <div class="meta">
                        <h1 class="title entry-title">Cây Splay -- Splay Tree</h1>                        
                        <p class="metadata"><span class="date updated">December 18, 2015</span> in <span class="categories"><a href="http://www.giaithuatlaptrinh.com/?cat=1" rel="category">Uncategorized</a></span> | <a class="comments-link" href="http://www.giaithuatlaptrinh.com/?p=613#respond">No comments</a></p>                    </div>
                    
                    <div class="content clearfix">
                                                <p>Trong bài này mình sẽ
 giới thiệu về cấu trúc dữ liệu splay tree (do không tìm được thuật ngữ 
Tiếng Việt nên mình giữ nguyên thuật ngữ tiếng anh). Splay Tree được 
giới thiệu bởi Sleator và Tarjan vào năm 1985 [1]. Cấu trúc Splay Tree 
thuộc về lớp các cây tìm kiếm nhị phân tự cân bằng (Self-Adjusting 
Binary Search Tree - BST), có nghĩa là nó sẽ tự điều chỉnh cấu trúc của 
nó mỗi khi có một thao tác thực hiên trên cây. So với cây cân bằng AVL 
Tree và Red Black Tree (mình sẽ blog về cây này vào một ngày đẹp trời 
nào đó), Splay Tree có một số ưu điểm sau [2]:</p>
<ul>
<li>Dễ thực thi hơn cây AVL Tree và cây Red Black Tree. Cái này các bạn nên code thử để tự so sánh.</li>
<li>Cần ít bộ nhớ hơn vì chúng ta không cần phải lưu thêm các thông tin phụ để đảm bảo cân bằng.</li>
<li> Hiệu quả hơn nhiều nếu như phân phối truy nhập các khóa là không 
đồng nhất (skew). Cụ thể, nếu một khóa được truy nhập liện tục nhiều lần
 thì lần truy nhập đầu tiên mất thời gian ( khấu trừ) <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-1-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-1" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.04em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-3" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-4" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-5" class="mi">log</span><span id="MathJax-Span-6" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-7" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-8" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-9" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-10" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-1" type="math/tex">O(\log (n))</script> còn các lần sau đó là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-2-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-11" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-12" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-13" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-14" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-15" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-16" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-2" type="math/tex">O(1)</script>.</li>
</ul>
<p>Tuy nhiên, điểm yếu của Splay Tree là chiều cao của cây có thể <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-3-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.815em; display: inline-block;" role="math" id="MathJax-Span-17" class="math"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.01em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-18" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-19" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-20" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-21" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-22" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-3" type="math/tex">O(n)</script> và một số thao tác có thể rất tốn kém (nhưng trung bình sẽ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-4-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-23" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-24" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-25" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-26" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-27" class="mi">log</span><span id="MathJax-Span-28" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-29" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-30" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-4" type="math/tex">O(\log n)</script>). Ok, tóm lại Splay Tree tốt hơn về một số mặt. Bây giờ chúng ta sẽ tìm hiểu cụ thể hơn. </p>
<p>Cây Splay Tree là một cây nhị phân tự cân bằng. Các thao tác cơ bản bao gồm:</p>
<ul>
<li><b>Tìm kiếm (Search)</b>: Tìm và trả lại giá trị của một nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-5-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-31" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-32" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-33" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-5" type="math/tex">K</script> cho trước trong cây.</li>
<li> <b>Chèn (Insertion)</b>: Chèn thêm một nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-6-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-34" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-35" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-36" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-6" type="math/tex">K</script> và giá trị <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-7-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-37" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.556em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-38" class="mrow"><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;" id="MathJax-Span-39" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script id="MathJax-Element-7" type="math/tex">V</script> vào cây Slay.</li>
<li> <b>Xóa (Insertion)</b>: Xóa nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-8-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-40" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-41" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-42" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-8" type="math/tex">K</script> ra khỏi cây. </li>
</ul>
<p>Ngoài 3 thao tác trên, cây Splay Tree cung cấp thêm thao tác <b>Splay</b>.
 Một nút được splay sẽ được đưa lên làm gốc của cây splay tree thông qua
 một loạt các thao tác quay cây (tree rotations) mô tả dưới đây. Trọng 
tâm của bài viết là định lý sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="thm-1"><b> Theorem 1: </b></a> Mỗi thao tác cơ bản trong cây Splay Tree có thời gian khấu trừ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-9-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-43" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-44" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-45" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-46" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-47" class="mi">log</span><span id="MathJax-Span-48" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-49" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-50" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-9" type="math/tex">O(\log n)</script>.
</div>
<p>&nbsp;</p>
<p>Trong giả các giả mã dưới đây, mình sẽ sử dụng cấu trúc dữ liệu <b>Node</b> cho mỗi nút của cây. Cấu trúc này bao gồm các trường sau:</p>
<ul>
<li> <b>key</b> trường này là  khóa của một nút. </li>
<li> <b>value</b> trường này sẽ chứa thông tin được lưu trữ trong một nút của cây. </li>
<li> <b>left</b> trường này là con trỏ tới nút con trái của nút hiện tại. </li>
<li> <b>right</b> trường này là con trỏ tới nút con phải của nút hiện tại. </li>
<li> <b>parent</b> trường này là con trỏ tới nút cha của nút hiện tại. Với nút gốc, trường này có giá trị Null.  </li>
</ul>
<p>Biểu diễn trong C:</p>
<div><div id="highlighter_953196" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">typedef</code> <code class="cpp keyword bold">struct</code> <code class="cpp plain">Node{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">key;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">value;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code> <code class="cpp plain">Node *left, *right, *parent;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">} Node;</code></div></div></td></tr></tbody></table></div></div>
<p><b>Remark:</b> Có một phiên bản thực thi khác của cây Splay Tree mà 
không cần trường parent, do đó tiết kiệm được thêm bộ nhớ và thời gian 
(để cập nhật trường parent sau mỗi thao tác). Tất nhiên là thực thi cũng
 sẽ phức tạp hơn một chút. Bạn đọc tham khảo cách thực thi này bằng Java
 tại [4].</p>
<p><strong><font size="4">Nhắc lại về phép quay trái quay phải</font></strong></p>
<p>Cũng như AVL và Red Black Tree, cây Splay Tree cũng sử dụng các thao 
tác quay để làm cho cây trở nên cân bằng. Hai thao tác quay cơ bản là <em>quay phải</em> và <em>quay trái</em>. Hai thao tác này được minh họa trong hình dưới đây:</p>
<p><img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/left-right-rotation.png" alt="left-right-rotation" width="457" height="144"></p>
<p>Từ cây bên trái, để thu được cây ở hình bên phải, ta thực hiện <em>quay phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-10-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-51" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-52" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-53" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-10" type="math/tex">y</script></em>. Tương tự như vậy, từ cây bên phải, để thu được cây ở hình bên trái, ta thực hiện <em>quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-11-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-54" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-55" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-56" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-11" type="math/tex">x</script></em>. Chú ý cây con màu đỏ của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-12-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-57" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-58" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-59" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-12" type="math/tex">x</script> và của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-13-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-60" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-61" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-62" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-13" type="math/tex">y</script> trong hai hình đổi chỗ khi thực hiện quay. Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-14-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-63" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-64" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-65" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-14" type="math/tex">w</script> là cha của$ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-15-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-66" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-67" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-68" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-15" type="math/tex">y</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-16-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-69" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-70" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-71" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-16" type="math/tex">z</script> là con phải của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-17-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-72" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-73" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-74" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-17" type="math/tex">x</script>. Để quay phải, ta làm theo các bước sau:</p>
<ol>
<li>Cập nhật con trỏ con (trái hoặc phải tùy theo <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-18-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-75" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-76" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-77" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-18" type="math/tex">y</script> là con trái hay phải của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-19-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-78" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-79" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-80" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-19" type="math/tex">w</script>) của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-20-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-81" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-82" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-83" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-20" type="math/tex">w</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-21-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-84" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-85" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-86" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-21" type="math/tex">x</script>. </li>
<li>Cập nhật con trỏ cha của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-22-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-87" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-88" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-89" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-22" type="math/tex">z</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-23-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-90" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-91" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-92" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-23" type="math/tex">y</script>. </li>
<li>Cập nhật con trỏ con trái của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-24-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-93" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-94" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-95" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-24" type="math/tex">y</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-25-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-96" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-97" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-98" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-25" type="math/tex">z</script>. </li>
<li>Cập nhật con trỏ cha của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-26-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-99" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-100" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-101" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-26" type="math/tex">x</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-27-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-102" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-103" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-104" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-27" type="math/tex">w</script>. </li>
<li>Cập nhật con trỏ con phải của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-28-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-105" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-106" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-107" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-28" type="math/tex">x</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-29-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-108" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-109" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-110" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-29" type="math/tex">y</script>. </li>
<li>Cập nhật con trỏ cha của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-30-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-111" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-112" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-113" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-30" type="math/tex">y</script> trỏ vào <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-31-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-114" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-115" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-116" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-31" type="math/tex">x</script>. </li>
</ol>
<p>Giả mã quay phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-32-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-117" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-118" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-119" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-32" type="math/tex">y</script> như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> RightRotate</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-33-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-120" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-121" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-122" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-33" type="math/tex">y</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-34-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-123" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-124" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-125" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-126" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-127" class="texatom"><span id="MathJax-Span-128" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-129" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-130" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-131" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-132" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-133" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-134" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-135" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-136" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-34" type="math/tex">x \leftarrow \mathrm{right}(y)</script><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-35-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.404em; display: inline-block;" role="math" id="MathJax-Span-137" class="math"><span style="display: inline-block; position: relative; width: 6.303em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.21em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-138" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-139" class="mi">w</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-140" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-141" class="texatom"><span id="MathJax-Span-142" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-143" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-144" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-145" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-146" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-147" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-148" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-149" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-150" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-151" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-35" type="math/tex">w \leftarrow \mathrm{parent}(y)</script><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-36-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-152" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-153" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-154" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-155" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-156" class="texatom"><span id="MathJax-Span-157" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-158" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-159" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-160" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-161" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-162" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-163" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-164" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-165" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-36" type="math/tex">z \leftarrow \mathrm{right}(x)</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-37-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.432em; display: inline-block;" role="math" id="MathJax-Span-166" class="math"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.82em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-167" class="mrow"><span id="MathJax-Span-168" class="texatom"><span id="MathJax-Span-169" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-170" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-171" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-172" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-173" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-174" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-175" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-176" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-177" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-178" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></math></span></span><script id="MathJax-Element-37" type="math/tex">\mathrm{left}(w) = y</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-38-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.76em; display: inline-block;" role="math" id="MathJax-Span-179" class="math"><span style="display: inline-block; position: relative; width: 5.067em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.02em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-180" class="mrow"><span id="MathJax-Span-181" class="texatom"><span id="MathJax-Span-182" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-183" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-184" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-185" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-186" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-187" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-188" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-189" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-190" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-191" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-38" type="math/tex">\mathrm{left}(w) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-39-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-192" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.64em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-193" class="mrow"><span id="MathJax-Span-194" class="texatom"><span id="MathJax-Span-195" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-196" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-197" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-198" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-199" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-200" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-201" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-202" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-203" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-204" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-205" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-39" type="math/tex">\mathrm{right}(w) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp;  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-40-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-206" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.06em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-207" class="mrow"><span id="MathJax-Span-208" class="texatom"><span id="MathJax-Span-209" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-210" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-211" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-212" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-213" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-214" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-215" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-216" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-217" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-218" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-219" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-220" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-40" type="math/tex">\mathrm{parent}(z) \leftarrow y</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-41-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-221" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.76em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-222" class="mrow"><span id="MathJax-Span-223" class="texatom"><span id="MathJax-Span-224" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-225" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-226" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-227" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-228" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-229" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-230" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-231" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-232" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-233" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>z</mi></math></span></span><script id="MathJax-Element-41" type="math/tex">\mathrm{left}(y) \leftarrow z</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-42-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-234" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-235" class="mrow"><span id="MathJax-Span-236" class="texatom"><span id="MathJax-Span-237" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-238" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-239" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-240" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-241" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-242" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-243" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-244" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-245" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-246" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-247" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-248" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>w</mi></math></span></span><script id="MathJax-Element-42" type="math/tex">\mathrm{parent}(x) \leftarrow w</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-43-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-249" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.44em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-250" class="mrow"><span id="MathJax-Span-251" class="texatom"><span id="MathJax-Span-252" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-253" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-254" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-255" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-256" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-257" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-258" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-259" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-260" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-261" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-262" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-43" type="math/tex">\mathrm{right}(x) \leftarrow y</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-44-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-263" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-264" class="mrow"><span id="MathJax-Span-265" class="texatom"><span id="MathJax-Span-266" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-267" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-268" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-269" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-270" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-271" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-272" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-273" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-274" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-275" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-276" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-277" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-44" type="math/tex">\mathrm{parent}(y) \leftarrow x</script><br>
 </font>
</div>
<p>&nbsp;</p>
<p>Code C:</p>
<div><div id="highlighter_828957" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// right rotation at y</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">right_rotate(Node *y){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node* x = y-&gt;left;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node* w = y-&gt;parent;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node* z = x-&gt;right;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(w != null){</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(w-&gt;left!= null &amp;&amp; w-&gt;left-&gt;key == y-&gt;key){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">w-&gt;left = x;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">w-&gt;right = x;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp; </code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(z != null)z-&gt;parent = y;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;left = z;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;parent = w;&nbsp;&nbsp; </code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;right = y;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;parent = x;</code></div><div class="line number18 index17 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Quay trái ta làm tương tự như quay phải, cập nhật các con trỏ. Giả mã quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-45-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-278" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-279" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-280" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-45" type="math/tex">x</script> như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> LeftRotate</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-46-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-281" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-282" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-283" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-46" type="math/tex">x</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-47-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-284" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-285" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-286" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-287" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-288" class="texatom"><span id="MathJax-Span-289" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-290" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-291" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-292" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-293" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-294" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-295" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-296" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-297" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-47" type="math/tex">y \leftarrow \mathrm{right}(x)</script><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-48-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-298" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.27em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-299" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-300" class="mi">w</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-301" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-302" class="texatom"><span id="MathJax-Span-303" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-304" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-305" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-306" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-307" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-308" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-309" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-310" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-311" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-312" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-48" type="math/tex">w \leftarrow \mathrm{parent}(x)</script><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-49-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-313" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.66em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-314" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-315" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-316" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-317" class="texatom"><span id="MathJax-Span-318" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-319" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-320" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-321" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-322" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-323" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-324" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-325" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-49" type="math/tex">z \leftarrow \mathrm{left}(y)</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-50-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.514em; display: inline-block;" role="math" id="MathJax-Span-326" class="math"><span style="display: inline-block; position: relative; width: 4.882em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.83em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-327" class="mrow"><span id="MathJax-Span-328" class="texatom"><span id="MathJax-Span-329" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-330" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-331" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-332" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-333" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-334" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-335" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-336" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-337" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-338" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span><script id="MathJax-Element-50" type="math/tex">\mathrm{left}(w) = x</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-51-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.678em; display: inline-block;" role="math" id="MathJax-Span-339" class="math"><span style="display: inline-block; position: relative; width: 5.006em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.01em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-340" class="mrow"><span id="MathJax-Span-341" class="texatom"><span id="MathJax-Span-342" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-343" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-344" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-345" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-346" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-347" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-348" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-349" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-350" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-351" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-51" type="math/tex">\mathrm{left}(w) \leftarrow y</script><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-52-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-352" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-353" class="mrow"><span id="MathJax-Span-354" class="texatom"><span id="MathJax-Span-355" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-356" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-357" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-358" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-359" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-360" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-361" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-362" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-363" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-364" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-365" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-52" type="math/tex">\mathrm{right}(w) \leftarrow y</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-53-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-366" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-367" class="mrow"><span id="MathJax-Span-368" class="texatom"><span id="MathJax-Span-369" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-370" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-371" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-372" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-373" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-374" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-375" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-376" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-377" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-378" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-379" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-380" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-53" type="math/tex">\mathrm{parent}(z) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-54-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-381" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.44em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-382" class="mrow"><span id="MathJax-Span-383" class="texatom"><span id="MathJax-Span-384" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-385" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-386" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-387" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-388" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-389" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-390" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-391" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-392" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-393" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-394" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>z</mi></math></span></span><script id="MathJax-Element-54" type="math/tex">\mathrm{right}(x) \leftarrow z</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-55-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.432em; display: inline-block;" role="math" id="MathJax-Span-395" class="math"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.77em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-396" class="mrow"><span id="MathJax-Span-397" class="texatom"><span id="MathJax-Span-398" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-399" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-400" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-401" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-402" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-403" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-404" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-405" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-406" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-407" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-55" type="math/tex">\mathrm{left}(y) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-56-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.404em; display: inline-block;" role="math" id="MathJax-Span-408" class="math"><span style="display: inline-block; position: relative; width: 6.303em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.28em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-409" class="mrow"><span id="MathJax-Span-410" class="texatom"><span id="MathJax-Span-411" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-412" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-413" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-414" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-415" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-416" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-417" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-418" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-419" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-420" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-421" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-422" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>w</mi></math></span></span><script id="MathJax-Element-56" type="math/tex">\mathrm{parent}(y) \leftarrow w</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-57-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-423" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.12em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-424" class="mrow"><span id="MathJax-Span-425" class="texatom"><span id="MathJax-Span-426" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-427" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-428" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-429" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-430" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-431" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-432" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-433" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-434" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-435" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-436" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-437" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-57" type="math/tex">\mathrm{parent}(x) \leftarrow y</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_36378" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// left rotation at x</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">left_rotate(Node *x){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node* y = x-&gt;right;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *w = x-&gt;parent;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *z = y-&gt;left;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(w != null){</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(w-&gt;left != null &amp;&amp; w-&gt;left-&gt;key == x-&gt;key){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">w-&gt;left = y;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">w-&gt;right = y;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp; </code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(z != null) z-&gt;parent = x;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;right = z;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;left = x;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;parent = w;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;parent = y;</code></div><div class="line number18 index17 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Remark</b> Khi thực thi bằng code, các bạn chú ý check null. Để giả mã sáng sủa, mình bỏ qua các bước check null.</p>
<p>Ta dễ thấy:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 1: </b></a> Thời gian để thực hiện một phép quay phải hay quay trái là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-58-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-438" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-439" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-440" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-441" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-442" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-443" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-58" type="math/tex">O(1)</script>.
</div>
<p>&nbsp;</p>
<p>Ngoài ra, khác với AVL Tree, Splay Tree còn sử dụng hai phép: <b>Zig-Zag</b> và <b>Roller-Coaster</b></p>
<p><strong> <font size="4">Zig-Zag và Roller-Coaster </font> </strong></p>
<p><strong> <font size="3">  Zig-Zag</font> </strong><br>
Phép Zig-Zag có hai dạng là Zig-Zag trái và Zig-Zag phải. Hai phép zig-zag trái và phải <em> tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-59-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-444" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-445" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-446" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-59" type="math/tex">z</script></em> được minh họa  trong hình dưới đây:</p>
<p> <img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/left-right-zig-zag.png" alt="left-right-zig-zag" width="490" height="294"><br>
Trong cả hai phép, nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-60-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-447" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-448" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-449" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-60" type="math/tex">x</script> sẽ được đưa lên làm gốc thay cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-61-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-450" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-451" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-452" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-61" type="math/tex">z</script>. Phép zig-zag trái gồm hai phép: quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-62-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-453" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-454" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-455" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-62" type="math/tex">y</script>, sau đó quay phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-63-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-456" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-457" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-458" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-63" type="math/tex">z</script>. Phép zig-zag phải gồm hai phép: quay phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-64-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-459" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-460" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-461" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-64" type="math/tex">y</script>, sau đó quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-65-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-462" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-463" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-464" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-65" type="math/tex">z</script>. Chú ý sự thay đổi cha của các cây con được tô màu của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-66-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-465" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-466" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-467" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-66" type="math/tex">x</script>.</p>
<p>Giả mã của phép zig-zag trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-67-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-468" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-469" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-470" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-67" type="math/tex">z</script>:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> LeftZigZag</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-68-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-471" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-472" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-473" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-68" type="math/tex">z</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-69-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-474" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.66em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-475" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-476" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-477" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-478" class="texatom"><span id="MathJax-Span-479" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-480" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-481" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-482" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-483" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-484" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-485" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-486" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-69" type="math/tex">y \leftarrow \mathrm{left}(z)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-70-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-487" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-488" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-489" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-490" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-491" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-70" type="math/tex">(y)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-71-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-492" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-493" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-494" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-495" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-496" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-71" type="math/tex">(z)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_856449" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// left zig-zag at z</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">left_zig_zag(Node *z){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = z-&gt;left;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">left_rotate(y);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(z);</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Giả mã của phép zig-zag phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-72-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-497" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-498" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-499" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-72" type="math/tex">z</script>:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> RightZigZag</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-73-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-500" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-501" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-502" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-73" type="math/tex">z</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-74-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.171em; display: inline-block;" role="math" id="MathJax-Span-503" class="math"><span style="display: inline-block; position: relative; width: 5.376em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.28em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-504" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-505" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-506" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-507" class="texatom"><span id="MathJax-Span-508" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-509" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-510" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-511" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-512" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-513" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-514" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-515" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-516" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-74" type="math/tex">y \leftarrow \mathrm{right}(z)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-75-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-517" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-518" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-519" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-520" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-521" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-75" type="math/tex">(y)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-76-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-522" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-523" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-524" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-525" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-526" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-76" type="math/tex">(z)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_167144" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// right zig-zag at z</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">right_zig_zag(Node *z){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = z-&gt;right;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(y);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">left_rotate(z);</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><strong> <font size="3">Roller-Coaster</font></strong></p>
<p>Tương tự như zig-zag, có hai phép Roller-Coaster là phải và trái, được minh họa trong hình dưới đây:<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/left-right-roller-coaster.png" alt="left-right-roller-coaster" width="500" height="164"></p>
<p> Phép roller-coaster phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-77-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-527" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-528" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-529" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-77" type="math/tex">z</script> gồm hai phép: quay rollaer-coaster phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-78-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-530" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-531" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-532" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-78" type="math/tex">z</script>, sau đó quay phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-79-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-533" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-534" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-535" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-79" type="math/tex">y</script>. Phép roller-coaster trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-80-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-536" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-537" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-538" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-80" type="math/tex">x</script> gồm hai phép: quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-81-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-539" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-540" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-541" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-81" type="math/tex">y</script>, sau đó quay trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-82-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-542" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-543" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-544" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-82" type="math/tex">x</script>. Chú ý sự thay đổi cha của các cây con được tô màu của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-83-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-545" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-546" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-547" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-83" type="math/tex">x</script>.</p>
<p>Giả mã của phép roller-coaster phải tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-84-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-548" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-549" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-550" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-84" type="math/tex">z</script>:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> RightRollerCoaster</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-85-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-551" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-552" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-553" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-85" type="math/tex">z</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-86-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-554" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.66em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-555" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-556" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-557" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-558" class="texatom"><span id="MathJax-Span-559" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-560" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-561" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-562" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-563" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-564" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-565" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-566" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-86" type="math/tex">y \leftarrow \mathrm{left}(z)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-87-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-567" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-568" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-569" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-570" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-571" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-87" type="math/tex">(z)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-88-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-572" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-573" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-574" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-575" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-576" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-88" type="math/tex">(y)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_625079" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// right roller-coaster at z</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">right_roller_coaster(Node *z){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = z-&gt;left;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(z);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(y);&nbsp;&nbsp;&nbsp; </code></div><div class="line number6 index5 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Giả mã của phép roller-coaster trái tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-89-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-577" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-578" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-579" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-89" type="math/tex">x</script>:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> LeftRollerCoaster</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-90-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-580" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-581" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-582" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-90" type="math/tex">x</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-91-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.253em; display: inline-block;" role="math" id="MathJax-Span-583" class="math"><span style="display: inline-block; position: relative; width: 5.438em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.34em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-584" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-585" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-586" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-587" class="texatom"><span id="MathJax-Span-588" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-589" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-590" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-591" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-592" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-593" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-594" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-595" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-596" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-91" type="math/tex">y \leftarrow \mathrm{right}(x)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-92-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-597" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.2em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-598" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-599" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-600" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-601" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-92" type="math/tex">(x)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-93-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-602" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-603" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-604" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-605" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-606" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-93" type="math/tex">(y)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_119366" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// right roller-coaster at z</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">right_roller_coaster(Node *z){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = z-&gt;left;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(z);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(y);&nbsp;&nbsp;&nbsp; </code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Phần tiếp theo chúng ta sẽ thực hiện phép Splay. Các thao tác chèn, xóa, tìm kiếm đều sử dụng phép Splay như là một thủ tục con.</p>
<p><strong> <font size="4">Phép Splay </font></strong> </p>
<p>Như đã nói ở trên, phép splay một nút sẽ thực hiện đưa một nút con 
lên làm nút gốc của cây Splay Tree. Phép Splay được thực hiện thông qua 
một loạt các phép quay, zig-zag và roller-coaster phụ thuộc vào cấu trúc
 của cây tại nút đó. Ưu tiên thực hiện zig-zag và roller-coaster trước. 
Phép quay nếu có thực hiện thì sẽ chỉ thực hiện một lần và là lần cuối 
khi đưa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-94-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-607" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-608" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-609" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-94" type="math/tex">x</script> lên làm gốc. Ví dụ ta muốn splay nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-95-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-610" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-611" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-612" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-95" type="math/tex">x</script> của cây trái nhất trong hình sau (hình được lấy từ [3]):<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/splay.png" alt="splay" width="500" height="160"></p>
<p>Ta có các bước sau:</p>
<ul>
<li>Bước 1: Cấu trúc của cây tại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-96-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-613" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-614" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-615" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-96" type="math/tex">x</script> là dạng roller-coaster trái, do đó ta thực hiện roller-coaster trái tại bước đầu tiên.</li>
<li>Bước 2: Cấu trúc của cây tại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-97-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-616" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-617" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-618" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-97" type="math/tex">x</script> là dạng zig-zag trái, do đó ta thực hiện zig-zag trái tại bước 2.</li>
<li>Bước 3: Cấu trúc của cây tại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-98-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-619" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-620" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-621" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-98" type="math/tex">x</script> là dạng zig-zag phải, do đó ta thực hiện zig-zag phải tại bước 3.</li>
<li>Bước 4: Cấu trúc của cây tại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-99-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-622" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-623" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-624" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-99" type="math/tex">x</script> là dạng quay trái (do không có cấu trúc roller-coaster hay zig-zag), do đó ta thực hiện quay phải tại bước 4. Sau bước này, <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-100-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-625" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-626" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-627" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-100" type="math/tex">x</script> đã là nút gốc của cây. Do đó, thao tác splay nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-101-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-628" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-629" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-630" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-101" type="math/tex">x</script> kết thúc.</li>
</ul>
<p>Giả mã của phép Splay như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> Splay</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-102-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-631" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-632" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-633" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-102" type="math/tex">x</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-103-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.925em; display: inline-block;" role="math" id="MathJax-Span-634" class="math"><span style="display: inline-block; position: relative; width: 5.191em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-635" class="mrow"><span id="MathJax-Span-636" class="texatom"><span id="MathJax-Span-637" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-638" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-639" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-640" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-641" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-642" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-643" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-644" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-645" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-646" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-647" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-103" type="math/tex">\mathrm{parent}(x) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font>    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <i>[[<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-104-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-648" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-649" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-650" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-104" type="math/tex">x</script> is the root]]</i><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; exit()<br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-105-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-651" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.02em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-652" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-653" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-654" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-655" class="texatom"><span id="MathJax-Span-656" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-657" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-658" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-659" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-660" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-661" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-662" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-663" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-664" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-665" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-105" type="math/tex">y \leftarrow \mathrm{parent}(x)</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-106-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.842em; display: inline-block;" role="math" id="MathJax-Span-666" class="math"><span style="display: inline-block; position: relative; width: 5.129em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-667" class="mrow"><span id="MathJax-Span-668" class="texatom"><span id="MathJax-Span-669" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-670" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-671" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-672" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-673" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-674" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-675" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-676" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-677" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-678" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-679" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-106" type="math/tex">\mathrm{parent}(y) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font>     &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <i>[[<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-107-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-680" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.49em, 2.677em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-681" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-682" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-107" type="math/tex">y</script> is the root]]</i><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-108-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.185em; display: inline-block;" role="math" id="MathJax-Span-683" class="math"><span style="display: inline-block; position: relative; width: 4.635em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-684" class="mrow"><span id="MathJax-Span-685" class="texatom"><span id="MathJax-Span-686" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-687" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-688" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-689" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-690" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-691" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-692" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-693" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-694" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-695" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span><script id="MathJax-Element-108" type="math/tex">\mathrm{left}(y) = x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-109-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-696" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-697" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-698" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-699" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-700" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-109" type="math/tex">(y)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRotate</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-110-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-701" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-702" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-703" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-704" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-705" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-110" type="math/tex">(y)</script><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-111-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-706" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.96em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-707" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-708" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-709" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-710" class="texatom"><span id="MathJax-Span-711" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-712" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-713" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-714" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-715" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-716" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-717" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-718" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-719" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-720" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-111" type="math/tex">z \leftarrow \mathrm{parent}(y)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-112-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.103em; display: inline-block;" role="math" id="MathJax-Span-721" class="math"><span style="display: inline-block; position: relative; width: 4.573em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.57em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-722" class="mrow"><span id="MathJax-Span-723" class="texatom"><span id="MathJax-Span-724" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-725" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-726" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-727" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-728" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-729" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-730" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-731" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-732" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-733" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></math></span></span><script id="MathJax-Element-112" type="math/tex">\mathrm{left}(z) = y</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-113-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.185em; display: inline-block;" role="math" id="MathJax-Span-734" class="math"><span style="display: inline-block; position: relative; width: 4.635em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-735" class="mrow"><span id="MathJax-Span-736" class="texatom"><span id="MathJax-Span-737" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-738" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-739" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-740" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-741" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-742" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-743" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-744" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-745" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-746" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span><script id="MathJax-Element-113" type="math/tex">\mathrm{left}(y) = x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightRollerCoaster</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-114-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-747" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-748" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-749" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-750" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-751" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-114" type="math/tex">(z)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftZigZag</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-115-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-752" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-753" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-754" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-755" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-756" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-115" type="math/tex">(z)</script><br>
  &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-116-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.185em; display: inline-block;" role="math" id="MathJax-Span-757" class="math"><span style="display: inline-block; position: relative; width: 4.635em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-758" class="mrow"><span id="MathJax-Span-759" class="texatom"><span id="MathJax-Span-760" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-761" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-762" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-763" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-764" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-765" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-766" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-767" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-768" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-769" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></math></span></span><script id="MathJax-Element-116" type="math/tex">\mathrm{left}(y) = x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> RightZigZag</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-117-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-770" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-771" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-772" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-773" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-774" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-117" type="math/tex">(z)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> LeftRollerCoaster</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-118-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-775" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-776" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-777" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-778" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-779" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-118" type="math/tex">(z)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> Splay</font>(x)<br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_763884" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// splay</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">splay(Node *x){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(x-&gt;parent == null) </code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = x-&gt;parent;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(y-&gt;parent == null){ </code><code class="cpp comments">// y is the root</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(y-&gt;left != null &amp;&amp; y-&gt;left-&gt;key == x-&gt;key){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_rotate(y);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">left_rotate(y);</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *z = y-&gt;parent;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(z-&gt;left != null &amp;&amp;z-&gt;left-&gt;key&nbsp; == y-&gt;key){</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(y-&gt;left != null &amp;&amp; y-&gt;left-&gt;key == x-&gt;key){</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_roller_coaster(z);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">left_zig_zag(z);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(y-&gt;right != null &amp;&amp; y-&gt;right-&gt;key == x-&gt;key){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">left_roller_coaster(z);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">right_zig_zag(z);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">splay(x);</code></div><div class="line number29 index28 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Ta sẽ chứng minh bổ đề dưới đây ở phần phân tích cuối bài.</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 2: </b></a> Thao tác Splay có thời gian khấu trừ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-119-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-780" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-781" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-782" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-783" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-784" class="mi">log</span><span id="MathJax-Span-785" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-786" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-787" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-119" type="math/tex">O(\log n)</script>.
</div>
<p>&nbsp;</p>
<p>Bây giờ ta có thể thực hiện được các thao tác cơ bản.</p>
<p><strong><font size="4">Các thao tác cơ bản</font></strong></p>
<p><strong><font size="3">Tìm kiếm</font></strong></p>
<p>Khi thực thi splay, thông thường đầu vào là một khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-120-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-788" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-789" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-790" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-120" type="math/tex">K</script> và chúng ta phải tìm nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-121-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-791" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-792" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-793" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-121" type="math/tex">x</script> có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-122-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-794" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-795" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-796" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-122" type="math/tex">K</script> đó và splay <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-123-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-797" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-798" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-799" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-123" type="math/tex">x</script> thành gốc của cây Splay Tree.</p>
<p>Để tìm kiếm một nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-124-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-800" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-801" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-802" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-124" type="math/tex">K</script>, ta sẽ tìm kiếm nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-125-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-803" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-804" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-805" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-125" type="math/tex">x</script> có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-126-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-806" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-807" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-808" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-126" type="math/tex">K</script> trong cây như tìm kếm trên Binary Search Tree. Nếu ta tìm thấy <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-127-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-809" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-810" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-811" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-127" type="math/tex">x</script> có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-128-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-812" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-813" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-814" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-128" type="math/tex">K</script> thì ta sẽ Spaly <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-129-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-815" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-816" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-817" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-129" type="math/tex">x</script>.  Nếu nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-130-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-818" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-819" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-820" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-130" type="math/tex">x</script> đó không tồn tại, ta sẽ splay <b>nút cuối cùng trên đường đi tìm kiếm khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-131-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-821" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-822" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-823" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-131" type="math/tex">K</script></b>. Ví dụ với hình vẽ ở phần Splay, nếu đầu vào là khóa có giá trị <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-132-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-824" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-825" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-826" class="mi">p</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.01em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script id="MathJax-Element-132" type="math/tex">p</script> thì ta sẽ splay nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-133-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-827" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-828" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-829" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-133" type="math/tex">n</script> vì khi ta tìm kiếm từ gốc đến <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-134-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-830" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-831" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-832" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-134" type="math/tex">n</script> thì ta sẽ thấy khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-135-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-833" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-834" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-835" class="mi">p</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.01em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script id="MathJax-Element-135" type="math/tex">p</script> sẽ không có ở trông cây và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-136-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-836" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-837" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-838" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-136" type="math/tex">n</script> là nút cuối cùng trên đường đi tìm kiếm đó. Giả mã như sau (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-137-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-839" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.537em, 1001.76em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-840" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-841" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-842" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-843" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-844" class="mi">t</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></math></span></span><script id="MathJax-Element-137" type="math/tex">root</script> ở đây là nút gốc của Splay Tree):</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> Find</u>( Key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-138-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-845" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-846" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-847" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-138" type="math/tex">K</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-139-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-848" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-849" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-850" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-851" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-139" type="math/tex">x \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> FindWithoutSplay</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-140-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-852" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.8em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-853" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-854" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-855" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-856" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-857" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-858" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-859" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-860" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-861" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo>,</mo><mi>K</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-140" type="math/tex">(root,K)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> Splay</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-141-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-862" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.2em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-863" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-864" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-865" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-866" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-141" type="math/tex">(x)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-142-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-867" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.475em, 1003.84em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-868" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-869" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-870" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-871" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-872" class="mi">t</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-873" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-874" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-142" type="math/tex">root\leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-143-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-875" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.36em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-876" class="mrow"><span id="MathJax-Span-877" class="texatom"><span id="MathJax-Span-878" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-879" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-880" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-881" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-882" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-883" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-884" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-885" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-886" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-887" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-888" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-889" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>K</mi></math></span></span><script id="MathJax-Element-143" type="math/tex">\mathrm{key}(root) = K</script>    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <i>[[now <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-144-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-890" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-891" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-892" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-144" type="math/tex">x</script> become the root after splay]]</i><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;  return <font style="font: normal verdana; font-variant: small-caps"> True</font><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;  return <font style="font: normal verdana; font-variant: small-caps"> False</font><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_214159" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// find a key K</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">find(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">K){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *x = find_without_splay(root,K);</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">splay(x);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">root = x;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(root-&gt;key == K) </code><code class="cpp keyword bold">return</code> <code class="cpp plain">TRUE;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">FALSE;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Thủ tục <font style="font: normal verdana; font-variant: small-caps"> FindWithoutSplay</font> tìm kiếm khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-145-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-893" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-894" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-895" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-145" type="math/tex">K</script> và trả lại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-146-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-896" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-897" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-898" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-146" type="math/tex">x</script> như mô tả ở trên. Chú ý là khóa của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-147-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-899" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-900" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-901" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-147" type="math/tex">x</script> có thể không bằng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-148-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-902" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-903" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-904" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-148" type="math/tex">K</script> trong trường hợp <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-149-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-905" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-906" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-907" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-149" type="math/tex">K</script> không có trong cây Splay. Giả mã của thủ tục này như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> FindWithoutSplay</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-150-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-908" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.41em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-909" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-910" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-150" type="math/tex">r</script>, Key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-151-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-911" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-912" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-913" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-151" type="math/tex">K</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-152-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.678em; display: inline-block;" role="math" id="MathJax-Span-914" class="math"><span style="display: inline-block; position: relative; width: 5.006em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.01em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-915" class="mrow"><span id="MathJax-Span-916" class="texatom"><span id="MathJax-Span-917" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-918" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-919" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-920" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-921" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-922" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-923" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-924" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-925" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>K</mi></math></span></span><script id="MathJax-Element-152" type="math/tex">\mathrm{key}(r) = K</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-153-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-926" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.41em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-927" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-928" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-153" type="math/tex">r</script><br>
   &nbsp;&nbsp;&nbsp; <b>else if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-154-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.637em; display: inline-block;" role="math" id="MathJax-Span-929" class="math"><span style="display: inline-block; position: relative; width: 2.719em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-930" class="mrow"><span id="MathJax-Span-931" class="texatom"><span id="MathJax-Span-932" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-933" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-934" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-935" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-936" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-937" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-938" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-154" type="math/tex">\mathrm{key}(r)</script> &lt; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-155-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-939" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.93em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-940" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-941" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-155" type="math/tex">K</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-156-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.856em; display: inline-block;" role="math" id="MathJax-Span-942" class="math"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.33em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-943" class="mrow"><span id="MathJax-Span-944" class="texatom"><span id="MathJax-Span-945" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-946" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-947" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-948" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-949" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-950" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-951" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-952" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-953" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-954" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-156" type="math/tex">\mathrm{right}(r) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-157-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-955" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.41em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-956" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-957" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-157" type="math/tex">r</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> FindWithoutSplay</font> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-158-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.171em; display: inline-block;" role="math" id="MathJax-Span-958" class="math"><span style="display: inline-block; position: relative; width: 5.376em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.28em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-959" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-960" class="mo">(</span><span id="MathJax-Span-961" class="texatom"><span id="MathJax-Span-962" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-963" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-964" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-965" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-966" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-967" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-968" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-969" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-970" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-971" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-972" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-973" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mi>K</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-158" type="math/tex">(\mathrm{right}(r),K)</script><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-159-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-974" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.71em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-975" class="mrow"><span id="MathJax-Span-976" class="texatom"><span id="MathJax-Span-977" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-978" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-979" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-980" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-981" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-982" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-983" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-984" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-985" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-159" type="math/tex">\mathrm{left}(r) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-160-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-986" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.41em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-987" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-988" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-160" type="math/tex">r</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> FindWithoutSplay</font> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-161-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-989" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.66em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-990" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-991" class="mo">(</span><span id="MathJax-Span-992" class="texatom"><span id="MathJax-Span-993" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-994" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-995" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-996" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-997" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-998" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-999" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1000" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1001" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1002" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1003" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mi>K</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-161" type="math/tex">(\mathrm{left}(r),K)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_812044" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// find without splay a key K</code></div><div class="line number2 index1 alt1"><code class="cpp plain">Node *find_without_splay(Node *r, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">K){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(r-&gt;key == K) </code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(r-&gt;key &lt; K){</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;right == null) </code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">find_without_splay(r-&gt;right,K);&nbsp; </code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;left == null) </code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">find_without_splay(r-&gt;left,K);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Remark</b> Do mỗi khi tìm kiếm một nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-162-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1004" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1005" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1006" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-162" type="math/tex">x</script>, ta splay nút đó lên làm gốc. Do đó, các thao tác tìm kiếm tiếp theo đó sẽ ít tốn kém hơn.</p>
<p>Bổ đề sau là hệ quả trực tiếp của Lemma 2:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 3: </b></a> Thao tác Find có thời gian khấu trừ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-163-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-1007" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1008" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1009" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1010" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1011" class="mi">log</span><span id="MathJax-Span-1012" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1013" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1014" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-163" type="math/tex">O(\log n)</script>.
</div>
<p>&nbsp;</p>
<p><strong><font size="3">Chèn</font></strong></p>
<p>Để chèn một nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-164-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1015" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1016" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1017" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-164" type="math/tex">K</script>, trước hết ta sẽ chèn khóa vào cây như chèn cây nhị phân và sau đó splay nút vừa chèn. </p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> Insert</u>(Key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-165-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1018" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1019" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1020" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-165" type="math/tex">K</script>, Value <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-166-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1021" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.556em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1022" class="mrow"><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;" id="MathJax-Span-1023" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script id="MathJax-Element-166" type="math/tex">V</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-167-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1024" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1025" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1026" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1027" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-167" type="math/tex">x \leftarrow </script><font style="font: normal verdana; font-variant: small-caps"> InsertWithoutSplay</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-168-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.842em; display: inline-block;" role="math" id="MathJax-Span-1028" class="math"><span style="display: inline-block; position: relative; width: 5.129em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1029" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1030" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1031" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1032" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1033" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1034" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1035" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1036" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1037" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.167em;" id="MathJax-Span-1038" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1039" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-168" type="math/tex">(root,K,V)</script><br>
   &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> Splay</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-169-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-1040" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.2em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1041" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1042" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1043" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1044" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-169" type="math/tex">(x)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-170-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.199em; display: inline-block;" role="math" id="MathJax-Span-1045" class="math"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.475em, 1003.84em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1046" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1047" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1048" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1049" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1050" class="mi">t</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1051" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1052" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-170" type="math/tex">root \leftarrow x</script><br>
 </font>
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> InsertWithoutSplay</u>(Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-171-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1053" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.41em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1054" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1055" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-171" type="math/tex">r</script>, Key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-172-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1056" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1057" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1058" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-172" type="math/tex">K</script>, Value <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-173-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1059" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.556em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1060" class="mrow"><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;" id="MathJax-Span-1061" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script id="MathJax-Element-173" type="math/tex">V</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-174-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.678em; display: inline-block;" role="math" id="MathJax-Span-1062" class="math"><span style="display: inline-block; position: relative; width: 5.006em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.01em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1063" class="mrow"><span id="MathJax-Span-1064" class="texatom"><span id="MathJax-Span-1065" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1066" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1067" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1068" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1069" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1070" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1071" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1072" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1073" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>K</mi></math></span></span><script id="MathJax-Element-174" type="math/tex">\mathrm{key}(r) = K</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;v&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-175-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.747em; display: inline-block;" role="math" id="MathJax-Span-1074" class="math"><span style="display: inline-block; position: relative; width: 5.809em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.81em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1075" class="mrow"><span id="MathJax-Span-1076" class="texatom"><span id="MathJax-Span-1077" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1078" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1079" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1080" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1081" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1082" class="mi">e</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1083" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1084" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1085" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1086" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;" id="MathJax-Span-1087" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>V</mi></math></span></span><script id="MathJax-Element-175" type="math/tex">\mathrm{value}(r) \leftarrow V</script><br>
   &nbsp;&nbsp;&nbsp; <b>else if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-176-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.637em; display: inline-block;" role="math" id="MathJax-Span-1088" class="math"><span style="display: inline-block; position: relative; width: 2.719em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1089" class="mrow"><span id="MathJax-Span-1090" class="texatom"><span id="MathJax-Span-1091" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1092" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1093" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1094" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1095" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1096" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1097" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-176" type="math/tex">\mathrm{key}(r)</script> &lt; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-177-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1098" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.93em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1099" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1100" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-177" type="math/tex">K</script><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-178-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1101" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.41em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1102" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1103" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script id="MathJax-Element-178" type="math/tex">r</script><br>
   &nbsp;&nbsp;&nbsp; <b>else if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;k&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-179-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.637em; display: inline-block;" role="math" id="MathJax-Span-1104" class="math"><span style="display: inline-block; position: relative; width: 2.719em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1105" class="mrow"><span id="MathJax-Span-1106" class="texatom"><span id="MathJax-Span-1107" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1108" class="mi">k</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1109" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1110" class="mi">y</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1111" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1112" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1113" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-179" type="math/tex">\mathrm{key}(r)</script> &lt; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-180-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1114" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.93em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1115" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1116" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-180" type="math/tex">K</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-181-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.856em; display: inline-block;" role="math" id="MathJax-Span-1117" class="math"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.33em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1118" class="mrow"><span id="MathJax-Span-1119" class="texatom"><span id="MathJax-Span-1120" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1121" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1122" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1123" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1124" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1125" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1126" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1127" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1128" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1129" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-181" type="math/tex">\mathrm{right}(r) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-182-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1130" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1131" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1132" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1133" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-182" type="math/tex">x \leftarrow </script><font style="font: normal verdana; font-variant: small-caps">CreateNode</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-183-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1134" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.75em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1135" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1136" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1137" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1138" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.167em;" id="MathJax-Span-1139" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1140" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-183" type="math/tex">(K,V)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-184-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.171em; display: inline-block;" role="math" id="MathJax-Span-1141" class="math"><span style="display: inline-block; position: relative; width: 5.376em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.33em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1142" class="mrow"><span id="MathJax-Span-1143" class="texatom"><span id="MathJax-Span-1144" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1145" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1146" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1147" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1148" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1149" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1150" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1151" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1152" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1153" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1154" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-184" type="math/tex">\mathrm{right}(r) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-185-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-1155" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1156" class="mrow"><span id="MathJax-Span-1157" class="texatom"><span id="MathJax-Span-1158" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1159" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1160" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1161" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1162" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1163" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1164" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1165" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1166" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1167" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1168" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1169" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>r</mi></math></span></span><script id="MathJax-Element-185" type="math/tex">\mathrm{parent}(x) \leftarrow r</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-186-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1170" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1171" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1172" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-186" type="math/tex">x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> InsertWithoutSplay</font> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-187-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.815em; display: inline-block;" role="math" id="MathJax-Span-1173" class="math"><span style="display: inline-block; position: relative; width: 6.612em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.52em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1174" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1175" class="mo">(</span><span id="MathJax-Span-1176" class="texatom"><span id="MathJax-Span-1177" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1178" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1179" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1180" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1181" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1182" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1183" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1184" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1185" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1186" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1187" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1188" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.167em;" id="MathJax-Span-1189" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1190" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-187" type="math/tex">(\mathrm{right}(r),K,V)</script><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-188-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1191" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.71em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1192" class="mrow"><span id="MathJax-Span-1193" class="texatom"><span id="MathJax-Span-1194" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1195" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1196" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1197" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1198" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1199" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1200" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1201" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1202" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-188" type="math/tex">\mathrm{left}(r) = </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-189-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.486em; display: inline-block;" role="math" id="MathJax-Span-1203" class="math"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.8em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1204" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1205" class="mi">x</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1206" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-189" type="math/tex">x \leftarrow </script><font style="font: normal verdana; font-variant: small-caps">CreateNode</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-190-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1207" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.75em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1208" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1209" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1210" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1211" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.167em;" id="MathJax-Span-1212" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1213" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-190" type="math/tex">(K,V)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-191-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-1214" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.71em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1215" class="mrow"><span id="MathJax-Span-1216" class="texatom"><span id="MathJax-Span-1217" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1218" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1219" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1220" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1221" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1222" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1223" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1224" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1225" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1226" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>x</mi></math></span></span><script id="MathJax-Element-191" type="math/tex">\mathrm{left}(r) \leftarrow x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-192-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-1227" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1228" class="mrow"><span id="MathJax-Span-1229" class="texatom"><span id="MathJax-Span-1230" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1231" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1232" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1233" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1234" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1235" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1236" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1237" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1238" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1239" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1240" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1241" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>r</mi></math></span></span><script id="MathJax-Element-192" type="math/tex">\mathrm{parent}(x) \leftarrow r</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-193-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1242" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1243" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1244" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-193" type="math/tex">x</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; return <font style="font: normal verdana; font-variant: small-caps"> InsertWithoutSplay</font> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-194-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-1245" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.9em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1246" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1247" class="mo">(</span><span id="MathJax-Span-1248" class="texatom"><span id="MathJax-Span-1249" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1250" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1251" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1252" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1253" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1254" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1255" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1256" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1257" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1258" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1259" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.167em;" id="MathJax-Span-1260" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1261" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-194" type="math/tex">(\mathrm{left}(r),K,V)</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_427196" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//insert a (key,value) pair</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">insert(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">K, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">V){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *x = insert_without_splay(root,K,V);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">splay(x);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">root = x;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp comments">//insert a (key,value) pair without splay</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp plain">Node *insert_without_splay(Node *r, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">K, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">V){</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(r-&gt;key == K){</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">r-&gt;value = V;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">r;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(r-&gt;key &lt; K){</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;right == null) {</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node*x = create_node(K,V);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">r-&gt;right = x;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;parent = r;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">x;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">insert_without_splay(r-&gt;right,K,V);&nbsp; </code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(r-&gt;left == null) {</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node*x = create_node(K,V);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">r-&gt;left = x;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">x-&gt;parent = r;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">x;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">return</code> <code class="cpp plain">insert_without_splay(r-&gt;left,K,V);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number33 index32 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Bổ đề sau là hệ quả trực tiếp của Lemma 2:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 4: </b></a> Thao tác Insert có thời gian khấu trừ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-195-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-1262" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1263" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1264" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1265" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1266" class="mi">log</span><span id="MathJax-Span-1267" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1268" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1269" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-195" type="math/tex">O(\log n)</script>.
</div>
<p>&nbsp;</p>
<p><strong><font size="3">Xóa</font></strong></p>
<p>Để xóa một nút có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-196-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1270" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1271" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1272" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-196" type="math/tex">K</script>, ta làm theo các bước sau:</p>
<ol>
<li> Ta sẽ tìm kiếm Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-197-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1273" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1274" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1275" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-197" type="math/tex">x</script> có khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-198-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1276" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1277" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1278" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-198" type="math/tex">K</script> trong cây và Splay nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-199-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1279" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1280" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1281" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-199" type="math/tex">x</script> đó lên gốc</li>
<li> Xóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-200-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1282" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1283" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1284" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-200" type="math/tex">x</script> ra khỏi cây.</li>
<li> Ta tìm Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-201-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1285" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1286" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1287" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-201" type="math/tex">w</script> là node phải nhất (right most) của cây con trái của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-202-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1288" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1289" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1290" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-202" type="math/tex">x</script>. Sau đó gán cây con phải của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-203-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1291" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1292" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1293" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-203" type="math/tex">x</script> làm cây con phải của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-204-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1294" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.72em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1295" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1296" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-204" type="math/tex">w</script></li>
<ol>
<p>Các bước trên được thể hiện trong hình sau. Hình được lấy từ [3].<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/deletion.png" alt="deletion" width="500" height="103"></p>
<p>Giả mã của thủ tục như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> Delete</u>(Key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-205-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1297" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1298" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1299" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-205" type="math/tex">K</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <font style="font: normal verdana; font-variant: small-caps"> Find</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-206-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.678em; display: inline-block;" role="math" id="MathJax-Span-1300" class="math"><span style="display: inline-block; position: relative; width: 5.006em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.95em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1301" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1302" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1303" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1304" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1305" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1306" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1307" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1308" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1309" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1310" class="mo">=</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo>,</mo><mi>K</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script id="MathJax-Element-206" type="math/tex">(root,K) = </script><font style="font: normal verdana; font-variant: small-caps"> False</font>    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;<i> [[after find, the root is <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-207-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1311" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.51em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1312" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1313" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-207" type="math/tex">x</script> as described]] </i><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; return<br>
   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-208-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-1314" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.96em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1315" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1316" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1317" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1318" class="texatom"><span id="MathJax-Span-1319" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1320" class="mi">l</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1321" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1322" class="mi">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1323" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1324" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1325" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1326" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1327" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1328" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1329" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-208" type="math/tex">y \leftarrow \mathrm{left}(root)</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-209-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-1330" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.26em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1331" class="mrow"><span id="MathJax-Span-1332" class="texatom"><span id="MathJax-Span-1333" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1334" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1335" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1336" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1337" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1338" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1339" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1340" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1341" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1342" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1343" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-209" type="math/tex">\mathrm{parent}(y) \leftarrow </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-210-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.938em; display: inline-block;" role="math" id="MathJax-Span-1344" class="math"><span style="display: inline-block; position: relative; width: 4.449em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.39em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1345" class="mrow"><span id="MathJax-Span-1346" class="texatom"><span id="MathJax-Span-1347" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1348" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1349" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1350" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1351" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1352" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1353" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1354" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1355" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1356" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>≠</mo></math></span></span><script id="MathJax-Element-210" type="math/tex">\mathrm{right}(y) \not= </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; Node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-211-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.5em; display: inline-block;" role="math" id="MathJax-Span-1357" class="math"><span style="display: inline-block; position: relative; width: 5.624em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.53em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1358" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1359" class="mi">w</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1360" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1361" class="texatom"><span id="MathJax-Span-1362" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1363" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1364" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1365" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1366" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1367" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1368" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1369" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1370" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-211" type="math/tex">w \leftarrow \mathrm{right}(y)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-212-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.267em; display: inline-block;" role="math" id="MathJax-Span-1371" class="math"><span style="display: inline-block; position: relative; width: 4.697em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.64em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1372" class="mrow"><span id="MathJax-Span-1373" class="texatom"><span id="MathJax-Span-1374" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1375" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1376" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1377" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1378" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1379" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1380" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1381" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1382" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1383" class="mo">≠</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>≠</mo></math></span></span><script id="MathJax-Element-212" type="math/tex">\mathrm{right}(w) \not= </script> <font style="font: normal verdana; font-variant: small-caps"> Null</font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-213-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.829em; display: inline-block;" role="math" id="MathJax-Span-1384" class="math"><span style="display: inline-block; position: relative; width: 5.871em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.78em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1385" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1386" class="mi">w</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1387" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1388" class="texatom"><span id="MathJax-Span-1389" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1390" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1391" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1392" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1393" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1394" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1395" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1396" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1397" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-213" type="math/tex">w \leftarrow \mathrm{right}(w)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font style="font: normal verdana; font-variant: small-caps"> Splay</font><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-214-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.993em; display: inline-block;" role="math" id="MathJax-Span-1398" class="math"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.39em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1399" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1400" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1401" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1402" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-214" type="math/tex">(w)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-215-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.007em; display: inline-block;" role="math" id="MathJax-Span-1403" class="math"><span style="display: inline-block; position: relative; width: 9.764em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.67em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1404" class="mrow"><span id="MathJax-Span-1405" class="texatom"><span id="MathJax-Span-1406" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1407" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1408" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1409" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1410" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1411" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1412" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1413" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1414" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1415" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1416" class="texatom"><span id="MathJax-Span-1417" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1418" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1419" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1420" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1421" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1422" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1423" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1424" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1425" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1426" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1427" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1428" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-215" type="math/tex">\mathrm{right}(w) \leftarrow \mathrm{right}(root)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-216-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.911em; display: inline-block;" role="math" id="MathJax-Span-1429" class="math"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1010.42em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1430" class="mrow"><span id="MathJax-Span-1431" class="texatom"><span id="MathJax-Span-1432" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1433" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1434" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1435" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1436" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1437" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1438" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1439" class="mo">(</span><span id="MathJax-Span-1440" class="texatom"><span id="MathJax-Span-1441" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1442" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1443" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1444" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1445" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1446" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1447" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1448" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1449" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1450" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1451" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1452" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1453" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1454" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1455" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>w</mi></math></span></span><script id="MathJax-Element-216" type="math/tex">\mathrm{parent}(\mathrm{right}(root)) \leftarrow w</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-217-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.445em; display: inline-block;" role="math" id="MathJax-Span-1456" class="math"><span style="display: inline-block; position: relative; width: 4.079em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.475em, 1004.05em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1457" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1458" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1459" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1460" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1461" class="mi">t</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1462" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1463" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">←</mo><mi>w</mi></math></span></span><script id="MathJax-Element-217" type="math/tex">root \leftarrow w</script>    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <i>[[set <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-218-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1464" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.658em, 1000.72em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1465" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1466" class="mi">w</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script id="MathJax-Element-218" type="math/tex">w</script> as the root of the splay tree]]</i><br>
   &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-219-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 12.678em; display: inline-block;" role="math" id="MathJax-Span-1467" class="math"><span style="display: inline-block; position: relative; width: 9.517em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.42em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1468" class="mrow"><span id="MathJax-Span-1469" class="texatom"><span id="MathJax-Span-1470" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1471" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1472" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1473" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1474" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1475" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1476" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1477" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1478" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1479" class="mo">←</span><span style="padding-left: 0.278em;" id="MathJax-Span-1480" class="texatom"><span id="MathJax-Span-1481" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1482" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1483" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1484" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1485" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1486" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1487" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1488" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1489" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1490" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1491" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1492" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-219" type="math/tex">\mathrm{right}(y) \leftarrow \mathrm{right}(root)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;p&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-220-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.582em; display: inline-block;" role="math" id="MathJax-Span-1493" class="math"><span style="display: inline-block; position: relative; width: 10.197em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1010.2em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1494" class="mrow"><span id="MathJax-Span-1495" class="texatom"><span id="MathJax-Span-1496" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1497" class="mi">p</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1498" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1499" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1500" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1501" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1502" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1503" class="mo">(</span><span id="MathJax-Span-1504" class="texatom"><span id="MathJax-Span-1505" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1506" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1507" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1508" class="mi">g</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1509" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1510" class="mi">t</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1511" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1512" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1513" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1514" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1515" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1516" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1517" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1518" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1519" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-220" type="math/tex">\mathrm{parent}(\mathrm{right}(root))\leftarrow y</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-221-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.116em; display: inline-block;" role="math" id="MathJax-Span-1520" class="math"><span style="display: inline-block; position: relative; width: 3.831em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.475em, 1003.83em, 2.677em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1521" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1522" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1523" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1524" class="mi">o</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1525" class="mi">t</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1526" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1527" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.27em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">←</mo><mi>y</mi></math></span></span><script id="MathJax-Element-221" type="math/tex">root \leftarrow y</script>    &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp; <i>[[set <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-222-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1528" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.49em, 2.677em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1529" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1530" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-222" type="math/tex">y</script> as the root of the splay tree]]</i><br>
 </font>
</div>
<p>&nbsp;</p>
<p>Code C:</p>
<div><div id="highlighter_997290" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// delete a node with key K</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code> <code class="cpp keyword bold">delete</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">K){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(find(K) == FALSE) </code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *y = root-&gt;left;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;parent = null;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(y-&gt;right != null){</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Node *w = y-&gt;right;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(w-&gt;right != null) w = w-&gt;right;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">splay(w);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">w-&gt;right = root-&gt;right;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(root-&gt;right != null) root-&gt;right-&gt;parent = w;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">root = w;&nbsp;&nbsp; </code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">y-&gt;right = root-&gt;right;&nbsp;&nbsp;&nbsp; </code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(root-&gt;right != null) root-&gt;right-&gt;parent = y;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">root = y;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Bổ đề sau là hệ quả trực tiếp của Lemma 2:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 5: </b></a> Thao tác Delete có thời gian khấu trừ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-223-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-1531" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1532" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1533" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1534" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1535" class="mi">log</span><span id="MathJax-Span-1536" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1537" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1538" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-223" type="math/tex">O(\log n)</script>.
</div>
<p>&nbsp;</p>
<p><strong> <font size="4"> Phân tích và chứng minh</font> </strong> </p>
<p>Trong phần này chúng ta sẽ chứng minh Lemma 2. Theorem 1 là hệ quả 
trực tiếp của các Lemma 1,2,3,4. Để chứng minh Lemma 2, chúng ta sẽ dùng
 phương pháp hàm thế năng trong phân tích khấu trừ (mình sẽ chi tiết 
thêm về phương pháp này vào ngày đẹp trời nào đó, các bạn tham khảo thêm
 tại [5]).  Mình sẽ tóm tắt ngắn gọn phương pháp này tại đây.</p>
<p>Chúng ta sẽ sử dụng một hàm <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-224-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1539" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.68em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1540" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1541" class="mi">Φ</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Φ</mi></math></span></span><script id="MathJax-Element-224" type="math/tex">\Phi</script> gọi là <em>thế năng</em> (potential function). Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-225-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1542" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.74em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1543" class="mrow"><span id="MathJax-Span-1544" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1545" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1546" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 0.962em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-225" type="math/tex">c_i</script> là chi phí thực của thao tác thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-226-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1547" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1548" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1549" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-226" type="math/tex">i</script>. Ta sẽ gán cho thao tác này một chi phí khác gọi là <em>chi phí khấu trừ</em> (amortized cost) <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-227-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-1550" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.66em, 1000.86em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1551" class="mrow"><span id="MathJax-Span-1552" class="msubsup"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.51em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1553" class="mi">a</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.529em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1554" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 0.961em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-227" type="math/tex">a_i</script>. Quan hệ giữa chi phí khấu trừ và chi phí thực như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><p></p>
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-228-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 15.555em; display: inline-block;" role="math" id="MathJax-Span-1555" class="math"><span style="display: inline-block; position: relative; width: 11.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1011.59em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1556" class="mrow"><span id="MathJax-Span-1557" class="msubsup"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.51em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1558" class="mi">a</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.529em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1559" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1560" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1561" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1562" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1563" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1564" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1565" class="msubsup"><span style="display: inline-block; position: relative; width: 1.041em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1566" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1567" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1568" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-1569" class="msubsup"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1570" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span id="MathJax-Span-1571" class="texatom"><span id="MathJax-Span-1572" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1573" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1574" class="mo">−</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1575" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;" id="MathJax-Span-1576" class="mspace"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1577" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1578" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1579" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mspace width="2em"></mspace><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-228" type="math/tex">a_i = c_i + \Phi_i - \Phi_{i-1} \qquad (1)</script> </p>
</a></div><a id="prob-1">
<p>&nbsp;<br>
Trong đó lượng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-229-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.692em; display: inline-block;" role="math" id="MathJax-Span-1580" class="math"><span style="display: inline-block; position: relative; width: 4.264em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1004.26em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1581" class="mrow"><span id="MathJax-Span-1582" class="msubsup"><span style="display: inline-block; position: relative; width: 1.041em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1583" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1584" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1585" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-1586" class="msubsup"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1587" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span id="MathJax-Span-1588" class="texatom"><span id="MathJax-Span-1589" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1590" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1591" class="mo">−</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1592" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script id="MathJax-Element-229" type="math/tex">\Phi_i - \Phi_{i-1}</script> là năng lượng thay đổi sau khi thực hiện chi phí thứ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-230-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1593" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1594" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1595" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-230" type="math/tex">i</script>. Hàm thế năng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-231-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1596" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1000.68em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1597" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1598" class="mi">Φ</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Φ</mi></math></span></span><script id="MathJax-Element-231" type="math/tex">\Phi</script> được gọi là hợp lệ nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-232-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-1599" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1005.28em, 2.637em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1600" class="mrow"><span id="MathJax-Span-1601" class="msubsup"><span style="display: inline-block; position: relative; width: 1.041em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1602" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1603" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1604" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-1605" class="msubsup"><span style="display: inline-block; position: relative; width: 1.151em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1606" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1607" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1608" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1609" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.302em; border-left: 0px solid; width: 0px; height: 1.293em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mn>0</mn></msub><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-232" type="math/tex">\Phi_i - \Phi_0 \geq 0</script> với mọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-233-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.979em; display: inline-block;" role="math" id="MathJax-Span-1610" class="math"><span style="display: inline-block; position: relative; width: 2.225em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.497em, 1002.18em, 2.672em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1611" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1612" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1613" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1614" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.266em; border-left: 0px solid; width: 0px; height: 1.234em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-233" type="math/tex">i \geq 0</script>. Từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-234-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-1615" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1616" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1617" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1618" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1619" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-234" type="math/tex">(1)</script>, ta suy ra:</p>
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-235-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 23.938em; display: inline-block;" role="math" id="MathJax-Span-1620" class="math"><span style="display: inline-block; position: relative; width: 17.983em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1017.89em, 2.765em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1621" class="mrow"><span id="MathJax-Span-1622" class="munderover"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1623" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1624" class="texatom"><span id="MathJax-Span-1625" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1626" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-1627" class="msubsup"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.51em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1628" class="mi">a</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.529em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1629" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1630" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1631" class="munderover"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1632" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1633" class="texatom"><span id="MathJax-Span-1634" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1635" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-1636" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1637" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1638" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1639" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1640" class="msubsup"><span style="display: inline-block; position: relative; width: 1.418em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1641" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1642" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1643" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-1644" class="msubsup"><span style="display: inline-block; position: relative; width: 1.151em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1645" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.722em;"><span id="MathJax-Span-1646" class="texatom"><span id="MathJax-Span-1647" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1648" class="mn">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1649" class="mo">≥</span><span style="padding-left: 0.278em;" id="MathJax-Span-1650" class="munderover"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1651" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1652" class="texatom"><span id="MathJax-Span-1653" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1654" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-1655" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1656" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1657" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;" id="MathJax-Span-1658" class="mspace"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1659" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1660" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1661" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.552em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><msub><mi mathvariant="normal">Φ</mi><mi>m</mi></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>≥</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><msub><mi>c</mi><mi>i</mi></msub><mspace width="2em"></mspace><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-235" type="math/tex">  \sum_{i}a_i =  \sum_{i} c_i + \Phi_m - \Phi_{0} \geq   \sum_{i} c_i \qquad (2)</script> </p>
<p>Do đó, tổng chi phí thực <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-236-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-1662" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.29em, 2.765em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1663" class="mrow"><span id="MathJax-Span-1664" class="munderover"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1665" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1666" class="texatom"><span id="MathJax-Span-1667" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1668" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-1669" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1670" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1671" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.552em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-236" type="math/tex">\sum_{i} c_i</script> luôn nhỏ hơn tổng chi phí khấu trừ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-237-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1672" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.41em, 2.765em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1673" class="mrow"><span id="MathJax-Span-1674" class="munderover"><span style="display: inline-block; position: relative; width: 1.375em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1675" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1676" class="texatom"><span id="MathJax-Span-1677" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1678" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-1679" class="msubsup"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.39em, 1000.51em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1680" class="mi">a</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.529em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1681" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.552em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-237" type="math/tex">\sum_{i} a_i</script>. </p>
<p><strong> <font size="3">Chứng minh Lemma 2</font> </strong> </p>
<p>Ta sẽ sử dụng hàm thế năng:</p>
</a><div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"></a><a id="prob-1"><p></p>
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230B;&lt;/mo&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-238-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 24.021em; display: inline-block;" role="math" id="MathJax-Span-1682" class="math"><span style="display: inline-block; position: relative; width: 18.045em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1017.95em, 2.847em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1683" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1684" class="mi">Φ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1685" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1686" class="munderover"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1687" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1688" class="texatom"><span id="MathJax-Span-1689" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1690" class="mi">v</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1691" class="mo">∈</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1692" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1693" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1694" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1695" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1696" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1697" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1698" class="munderover"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-1699" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-1700" class="texatom"><span id="MathJax-Span-1701" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1702" class="mi">v</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1703" class="mo">∈</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1704" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1705" class="mo">⌊</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1706" class="mi">log</span><span id="MathJax-Span-1707" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1708" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1709" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1710" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1711" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1712" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1713" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1714" class="mo">⌋</span><span style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;" id="MathJax-Span-1715" class="mspace"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1716" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1717" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1718" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.499em; border-left: 0px solid; width: 0px; height: 1.579em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Φ</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>v</mi><mo>∈</mo><mi>T</mi></mrow></munder><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>v</mi><mo>∈</mo><mi>T</mi></mrow></munder><mo fence="false" stretchy="false">⌊</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⌋</mo><mspace width="2em"></mspace><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-238" type="math/tex">\Phi = \sum_{v \in T}  r(v) =  \sum_{v \in T} \lfloor \log(s(v))\rfloor \qquad (3)</script> </p>
</a></div><a id="prob-1">
<p>&nbsp;<br>
trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-239-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-1719" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.64em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1720" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1721" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1722" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1723" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1724" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-239" type="math/tex">s(v)</script> là số lượng node của cây con gốc tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-240-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1725" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1726" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1727" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-240" type="math/tex">v</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-241-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.212em; display: inline-block;" role="math" id="MathJax-Span-1728" class="math"><span style="display: inline-block; position: relative; width: 7.663em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1729" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1730" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1731" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1732" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1733" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1734" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1735" class="mo">⌊</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1736" class="mi">log</span><span id="MathJax-Span-1737" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1738" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1739" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1740" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1741" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1742" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1743" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1744" class="mo">⌋</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">⌊</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⌋</mo></math></span></span><script id="MathJax-Element-241" type="math/tex">r(v)  = \lfloor \log(s(v))\rfloor</script> được gọi là hạng (rank) của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-242-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1745" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1746" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1747" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-242" type="math/tex">v</script>. Dễ thấy <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-243-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-1748" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.59em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1749" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1750" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1751" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1752" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1753" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1754" class="mo">≤</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1755" class="mi">log</span><span id="MathJax-Span-1756" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1757" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1758" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1759" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-243" type="math/tex">r(v) \leq \log (n)</script> nếu cây có <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-244-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1760" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1761" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1762" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-244" type="math/tex">n</script> node.</p>
<p>Ta gọi mỗi phép quay trái, phải là một <b>phép quay đơn</b> (single rotation) và mỗi phép zig-zag hay roller-coaster là một <b>phép quay kép</b>
 (double rotation). Ta sẽ tìm giá trị khấu trừ của mỗi phép quay đơn và 
kép. Dễ thấy rằng giá trị khấu trừ của phép Splay chính là tổng giá trị 
khấu trừ của mỗi phép quay đơn và kép này. Ta sẽ chứng minh bổ đề sau:</p>
</a><div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"></a><a id="prob-1"><b> Lemma 5 (Access Lemma): </b></a> Giá trị khấu trừ của mỗi phép quay đơn để splay node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-245-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1763" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1764" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1765" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-245" type="math/tex">v</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-246-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.459em; display: inline-block;" role="math" id="MathJax-Span-1766" class="math"><span style="display: inline-block; position: relative; width: 7.848em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1007.75em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1767" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1768" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1769" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1770" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1771" class="mo">(</span><span id="MathJax-Span-1772" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1773" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1774" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1775" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1776" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1777" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1778" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1779" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1780" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1781" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1782" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1783" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>+</mo><mn>3</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-246" type="math/tex">1 + 3(r'(v) - r(v))</script>  và giá trị khấu trừ của mỗi phép quay kép để splay node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-247-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1784" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1785" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1786" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-247" type="math/tex">v</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-248-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-1787" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1006.02em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1788" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1789" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1790" class="mo">(</span><span id="MathJax-Span-1791" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1792" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1793" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1794" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1795" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1796" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1797" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1798" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1799" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1800" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1801" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1802" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-248" type="math/tex"> 3(r'(v) - r(v))</script>
</div>
<p>&nbsp;<br>
trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-249-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-1803" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1804" class="mrow"><span id="MathJax-Span-1805" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1806" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1807" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1808" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1809" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1810" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-249" type="math/tex">r'(v)</script> là hạng của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-250-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1811" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1812" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1813" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-250" type="math/tex">v</script> sau phép quay đơn hay kép. Ở dưới ta sẽ chứng minh bổ đề này. Bây giờ ta sẽ sử dụng bổ để này để chứng minh Lemma 2.</p>
<p>Dễ thấy giá trị khấu trừ của phép splay sẽ là tổng giá trị khấu trừ của mỗi bước quay đơn hay kép khi ta splay <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-251-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1814" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1815" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1816" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-251" type="math/tex">v</script>.
 Do ta chỉ sử dụng tối đa một phép quay đơn (là phép quay đơn cuối cùng)
 và còn lại là các phép quay kép, ta sẽ có tổng chi phí khấu trừ cho 
toàn bộ phép Splay là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-252-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.459em; display: inline-block;" role="math" id="MathJax-Span-1817" class="math"><span style="display: inline-block; position: relative; width: 7.848em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1007.75em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1818" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1819" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1820" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1821" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1822" class="mo">(</span><span id="MathJax-Span-1823" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1824" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1825" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1826" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1827" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1828" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1829" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1830" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1831" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1832" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1833" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1834" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>+</mo><mn>3</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-252" type="math/tex">1 + 3(r'(v) - r(v))</script> (do các hạng tử trung gian triệt tiêu nhau). Ở đây <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-253-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1835" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1836" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1837" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1838" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1839" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1840" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-253" type="math/tex">r(v)</script> là hạng ban đầu và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-254-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-1841" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1842" class="mrow"><span id="MathJax-Span-1843" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1844" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1845" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1846" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1847" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1848" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-254" type="math/tex">r'(v)</script> là hạng của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-255-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1849" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1850" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1851" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-255" type="math/tex">v</script> sau phép Splay. Do <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-256-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-1852" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.48em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1853" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1854" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1855" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1856" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1857" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1858" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1859" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-256" type="math/tex">r(v) \geq 0</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-257-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-1860" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1005.9em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1861" class="mrow"><span id="MathJax-Span-1862" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1863" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1864" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1865" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1866" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1867" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1868" class="mo">≤</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1869" class="mi">log</span><span id="MathJax-Span-1870" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1871" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1872" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1873" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-257" type="math/tex">r'(v) \leq \log(n)</script>, ta có chi phí khấu trừ cho mỗi phép Splay là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-258-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-1874" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1875" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1876" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1877" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1878" class="mi">log</span><span id="MathJax-Span-1879" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1880" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1881" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-258" type="math/tex">O(\log n)</script>. Từ đó ta suy ra Lemma 2. </p>
<p><b>Chứng minh Access Lemma</b> Trước hết chú ý ở đây <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-259-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-1882" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.28em, 2.678em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1883" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1884" class="mi">log</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi></math></span></span><script id="MathJax-Element-259" type="math/tex">\log</script> là hàm <a href="https://en.wikipedia.org/wiki/Concave_function" target="_blank">concave</a> (hình như dịch là lõm), do đó với mọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-260-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-1885" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1001.54em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1886" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1887" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1888" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1889" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script id="MathJax-Element-260" type="math/tex">x,y</script> dương, ta có:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;">
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-261-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 17.116em; display: inline-block;" role="math" id="MathJax-Span-1890" class="math"><span style="display: inline-block; position: relative; width: 12.854em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(0.968em, 1012.76em, 2.869em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1891" class="mrow"><span id="MathJax-Span-1892" class="mfrac"><span style="display: inline-block; position: relative; width: 4.333em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.301em, 1004.15em, 4.379em, -1000em); top: -4.62em; left: 50%; margin-left: -2.106em;"><span id="MathJax-Span-1893" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1894" class="mi">log</span><span style="font-size: 70.7%;" id="MathJax-Span-1895" class="mo"></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1896" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1897" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1898" class="mo">)</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1899" class="mo">+</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1900" class="mi">log</span><span style="font-size: 70.7%;" id="MathJax-Span-1901" class="mo"></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1902" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1903" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1904" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1000.32em, 4.202em, -1000em); top: -3.62em; left: 50%; margin-left: -0.177em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1905" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1004.33em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.333em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1906" class="mo">≤</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1907" class="mi">log</span><span id="MathJax-Span-1908" class="mo"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1909" class="mo">(</span><span id="MathJax-Span-1910" class="mfrac"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.419em, 1001.3em, 4.347em, -1000em); top: -4.588em; left: 50%; margin-left: -0.653em;"><span id="MathJax-Span-1911" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1912" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1913" class="mo">+</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1914" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1000.32em, 4.202em, -1000em); top: -3.62em; left: 50%; margin-left: -0.177em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1915" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1001.42em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.425em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1916" class="mo">)</span><span style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;" id="MathJax-Span-1917" class="mspace"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1918" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1919" class="mn">4</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1920" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.61em; border-left: 0px solid; width: 0px; height: 2.199em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>≤</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mspace width="2em"></mspace><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-261" type="math/tex">\frac{\log(x) + \log(y)}{2} \leq \log(\frac{x+y}{2})\qquad (4)</script> </p>
</div>
<p>&nbsp;<br>
Ta sẽ chứng minh bằng cách phân tích từng trường hợp riêng biết. </p>
<ol>
<li>Phép quay đơn</li>
<p> Để ý với phép quay đơn, chỉ có <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-262-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1921" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1922" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1923" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-262" type="math/tex">x</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-263-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1924" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1925" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1926" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-263" type="math/tex">y</script> là thay đổi hạng. Do đó, chi phí khấu trừ là:</p>
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;left center left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-264-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 31.993em; display: inline-block;" role="math" id="MathJax-Span-1927" class="math"><span style="display: inline-block; position: relative; width: 24.04em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(0.601em, 1023.78em, 3.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1928" class="mrow"><span style="padding-right: 0.167em; padding-left: 0.167em;" id="MathJax-Span-1929" class="mtable"><span style="display: inline-block; position: relative; width: 23.678em; height: 0px;"><span style="position: absolute; clip: rect(2.373em, 1004.6em, 4.952em, -1000em); top: -4.017em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.657em; height: 0px;"><span style="position: absolute; clip: rect(3.073em, 1004.6em, 4.284em, -1000em); top: -4.717em; left: 0em;"><span id="MathJax-Span-1930" class="mtd"><span id="MathJax-Span-1931" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1932" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1933" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1934" class="msup"><span style="display: inline-block; position: relative; width: 0.991em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-1935" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1936" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1937" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1938" class="mi">Φ</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.831em, 1000em, 4.202em, -1000em); top: -3.267em; left: 0em;"><span id="MathJax-Span-1969" class="mtd"><span id="MathJax-Span-1970" class="mrow"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.764em, 1000.72em, 4.819em, -1000em); top: -4.017em; left: 5.657em;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px;"><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -4.717em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-1939" class="mtd"><span id="MathJax-Span-1940" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1941" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -3.267em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-1971" class="mtd"><span id="MathJax-Span-1972" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1973" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1016.15em, 5.202em, -1000em); top: -4.017em; left: 7.435em;"><span style="display: inline-block; position: relative; width: 16.243em; height: 0px;"><span style="position: absolute; clip: rect(3.073em, 1012.88em, 4.452em, -1000em); top: -4.717em; left: 0em;"><span id="MathJax-Span-1942" class="mtd"><span id="MathJax-Span-1943" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1944" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1945" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1946" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1947" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1948" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1949" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1950" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1951" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1952" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1953" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1954" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1955" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1956" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1957" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1958" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1959" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1960" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1961" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1962" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1963" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1964" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1965" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1966" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1967" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1968" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.073em, 1016.15em, 4.452em, -1000em); top: -3.267em; left: 0em;"><span id="MathJax-Span-1974" class="mtd"><span id="MathJax-Span-1975" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1976" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1977" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-1978" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1979" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1980" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1981" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1982" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1983" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1984" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1985" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1986" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1987" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1988" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1989" class="mo">≤</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1990" class="mn">1</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1991" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1992" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1993" class="mo">(</span><span id="MathJax-Span-1994" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1995" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-1996" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1997" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1998" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1999" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2000" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2001" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2002" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2003" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2004" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2005" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.412em; border-left: 0px solid; width: 0px; height: 3.489em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left center left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn><mo>+</mo><msup><mi mathvariant="normal">Φ</mi><mo>′</mo></msup><mo>−</mo><mi mathvariant="normal">Φ</mi></mtd><mtd><mo>=</mo></mtd><mtd><mn>1</mn><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mn>1</mn><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>1</mn><mo>+</mo><mn>3</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span><script id="MathJax-Element-264" type="math/tex">\begin{array} {lcl} 1 + \Phi' - \Phi & = & 1 + r'(x) + r'(y) - r(x) - r(y) \\ & = & 1  + r'(x) - r(x) \leq 1 + 3(r'(x) - r(x)) \end{array}</script><br>
Từ dòng trên xuống dòng dưới là do <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-265-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.678em; display: inline-block;" role="math" id="MathJax-Span-2006" class="math"><span style="display: inline-block; position: relative; width: 5.006em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1004.91em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2007" class="mrow"><span id="MathJax-Span-2008" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2009" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2010" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2011" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2012" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2013" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2014" class="mo">≥</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2015" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2016" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2017" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2018" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>r</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-265" type="math/tex">r'(y) \geq r(y)</script>.</p>
<li>Phép zig-zag</li>
<p> Để ý với phép zig-zag, chỉ có <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-266-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-2019" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1001.54em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2020" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2021" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2022" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2023" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script id="MathJax-Element-266" type="math/tex">x,y</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-267-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2024" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2025" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2026" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script id="MathJax-Element-267" type="math/tex">z</script> là thay đổi hạng. Do đó, chi phí khấu trừ là:</p>
<p style="text-align: center;"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;left center left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A6;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-268-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 40.212em; display: inline-block;" role="math" id="MathJax-Span-2027" class="math"><span style="display: inline-block; position: relative; width: 30.242em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(5.451em, 1030.15em, 15.555em, -1000em); top: -10.753em; left: 0em;"><span id="MathJax-Span-2028" class="mrow"><span style="display: inline-block; position: relative; width: 30.242em; height: 0px;"><span style="position: absolute; clip: rect(5.451em, 1030.15em, 15.555em, -1000em); top: -10.753em; left: 0em;"><span style="padding-left: 0.167em;" id="MathJax-Span-2029" class="mtable"><span style="display: inline-block; position: relative; width: 30.075em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1004.6em, 11.32em, -1000em); top: -8.59em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.657em; height: 0px;"><span style="position: absolute; clip: rect(3.073em, 1004.6em, 4.284em, -1000em); top: -8.334em; left: 0em;"><span id="MathJax-Span-2030" class="mtd"><span id="MathJax-Span-2031" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2032" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2033" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2034" class="msup"><span style="display: inline-block; position: relative; width: 0.991em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.66em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-2035" class="mi">Φ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.722em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2036" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2037" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2038" class="mi">Φ</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.831em, 1000em, 4.202em, -1000em); top: -6.884em; left: 0em;"><span id="MathJax-Span-2081" class="mtd"><span id="MathJax-Span-2082" class="mrow"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.831em, 1000em, 4.202em, -1000em); top: -5.434em; left: 0em;"><span id="MathJax-Span-2109" class="mtd"><span id="MathJax-Span-2110" class="mrow"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.831em, 1000em, 4.202em, -1000em); top: -3.645em; left: 0em;"><span id="MathJax-Span-2164" class="mtd"><span id="MathJax-Span-2165" class="mrow"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.831em, 1000em, 4.202em, -1000em); top: -1.472em; left: 0em;"><span id="MathJax-Span-2223" class="mtd"><span id="MathJax-Span-2224" class="mrow"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.59em;"></span></span><span style="position: absolute; clip: rect(3.473em, 1000.72em, 11.211em, -1000em); top: -8.343em; left: 5.657em;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px;"><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -8.334em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-2039" class="mtd"><span id="MathJax-Span-2040" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2041" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -6.884em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-2083" class="mtd"><span id="MathJax-Span-2084" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2085" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -5.434em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-2111" class="mtd"><span id="MathJax-Span-2112" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2113" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.464em, 1000.72em, 4.069em, -1000em); top: -3.645em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-2166" class="mtd"><span id="MathJax-Span-2167" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2168" class="mo">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.195em, 1000.69em, 4.34em, -1000em); top: -1.472em; left: 50%; margin-left: -0.389em;"><span id="MathJax-Span-2225" class="mtd"><span id="MathJax-Span-2226" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2227" class="mo">≤</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.343em;"></span></span><span style="position: absolute; clip: rect(5.43em, 1022.54em, 15.493em, -1000em); top: -10.691em; left: 7.435em;"><span style="display: inline-block; position: relative; width: 22.639em; height: 0px;"><span style="position: absolute; clip: rect(3.073em, 1018.99em, 4.452em, -1000em); top: -8.334em; left: 0em;"><span id="MathJax-Span-2042" class="mtd"><span id="MathJax-Span-2043" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2044" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2045" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2046" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2047" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2048" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2049" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2050" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2051" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2052" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2053" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2054" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2055" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2056" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2057" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2058" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2059" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2060" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2061" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2062" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2063" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2064" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2065" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2066" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2067" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2068" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2069" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2070" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2071" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2072" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2073" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2074" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2075" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2076" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2077" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2078" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2079" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2080" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.073em, 1010.33em, 4.452em, -1000em); top: -6.884em; left: 0em;"><span id="MathJax-Span-2086" class="mtd"><span id="MathJax-Span-2087" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2088" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2089" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2090" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2091" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2092" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2093" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2094" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2095" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2096" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2097" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2098" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2099" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2100" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2101" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2102" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2103" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2104" class="mn">2</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2105" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2106" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2107" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2108" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.073em, 1022.54em, 4.452em, -1000em); top: -5.434em; left: 0em;"><span id="MathJax-Span-2114" class="mtd"><span id="MathJax-Span-2115" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2116" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2117" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2118" class="mo">(</span><span id="MathJax-Span-2119" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2120" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2121" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2122" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2123" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2124" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2125" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-2126" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2127" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2128" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2129" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2130" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2131" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2132" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2133" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2134" class="mo">(</span><span id="MathJax-Span-2135" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2136" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2137" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2138" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2139" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2140" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2141" class="mo">−</span><span style="padding-left: 0.222em;" id="MathJax-Span-2142" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2143" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2144" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2145" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2146" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2147" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2148" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2149" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2150" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2151" class="mo">(</span><span id="MathJax-Span-2152" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2153" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2154" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2155" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2156" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2157" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2158" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2159" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2160" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2161" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2162" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2163" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.692em, 1017.01em, 4.835em, -1000em); top: -3.645em; left: 0em;"><span id="MathJax-Span-2169" class="mtd"><span id="MathJax-Span-2170" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2171" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2172" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2173" class="mi">log</span><span id="MathJax-Span-2174" class="mo"></span><span style="padding-left: 0.167em;" id="MathJax-Span-2175" class="mfrac"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.295em, 1001.36em, 4.379em, -1000em); top: -4.62em; left: 50%; margin-left: -0.712em;"><span id="MathJax-Span-2176" class="mrow"><span id="MathJax-Span-2177" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2178" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.273em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2179" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2180" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2181" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2182" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.301em, 1001.41em, 4.379em, -1000em); top: -3.561em; left: 50%; margin-left: -0.738em;"><span id="MathJax-Span-2183" class="mrow"><span id="MathJax-Span-2184" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2185" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.221em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2186" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2187" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2188" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2189" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1001.6em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.597em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2190" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2191" class="mi">log</span><span id="MathJax-Span-2192" class="mo"></span><span style="padding-left: 0.167em;" id="MathJax-Span-2193" class="mfrac"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.295em, 1001.34em, 4.379em, -1000em); top: -4.62em; left: 50%; margin-left: -0.702em;"><span id="MathJax-Span-2194" class="mrow"><span id="MathJax-Span-2195" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2196" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.273em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2197" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2198" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2199" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2200" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.301em, 1001.41em, 4.379em, -1000em); top: -3.561em; left: 50%; margin-left: -0.738em;"><span id="MathJax-Span-2201" class="mrow"><span id="MathJax-Span-2202" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2203" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.221em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2204" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2205" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2206" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2207" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1001.6em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.597em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2208" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2209" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2210" class="mo">(</span><span id="MathJax-Span-2211" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2212" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2213" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2214" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2215" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2216" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2217" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2218" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2219" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2220" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2221" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2222" class="mo">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; width: 100%; clip: rect(2.878em, 1021.58em, 6.46em, -1000em); top: -1.658em; left: 0em;"><span id="MathJax-Span-2228" class="mtd"><span id="MathJax-Span-2229" class="mrow"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.692em, 1021.58em, 4.835em, -1000em); top: -4.017em; left: 50%; margin-left: -10.838em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-2230" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2231" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2232" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2233" class="mi">log</span><span id="MathJax-Span-2234" class="mo"></span><span style="padding-left: 0.167em;" id="MathJax-Span-2235" class="mfrac"><span style="display: inline-block; position: relative; width: 2.304em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.295em, 1002.15em, 4.379em, -1000em); top: -4.62em; left: 50%; margin-left: -1.092em;"><span id="MathJax-Span-2236" class="mrow"><span id="MathJax-Span-2237" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2238" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.273em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2239" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2240" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2241" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2242" class="mo">)</span><span id="MathJax-Span-2243" class="texatom"><span id="MathJax-Span-2244" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2245" class="mo">/</span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2246" class="mn">2</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.301em, 1001.41em, 4.379em, -1000em); top: -3.561em; left: 50%; margin-left: -0.738em;"><span id="MathJax-Span-2247" class="mrow"><span id="MathJax-Span-2248" class="msup"><span style="display: inline-block; position: relative; width: 0.522em; height: 0px;"><span style="position: absolute; clip: rect(3.519em, 1000.3em, 4.209em, -1000em); top: -4.017em; left: 0em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2249" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.221em; left: 0.332em;"><span style="font-size: 50%; font-family: MathJax_Main;" id="MathJax-Span-2250" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2251" class="mo">(</span><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2252" class="mi">x</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2253" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1002.3em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.304em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2254" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2255" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2256" class="mo">(</span><span id="MathJax-Span-2257" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2258" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2259" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2260" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2261" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2262" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2263" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2264" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2265" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2266" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2267" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2268" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2269" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2270" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2271" class="mo">(</span><span id="MathJax-Span-2272" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2273" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2274" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2275" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2276" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2277" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2278" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2279" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2280" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2281" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2282" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2283" class="mo">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.073em, 1007.33em, 4.452em, -1000em); top: -2.194em; left: 50%; margin-left: -3.714em;"><span style="font-family: MathJax_Main;" id="MathJax-Span-2284" class="mo">≤</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2285" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2286" class="mo">(</span><span id="MathJax-Span-2287" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2288" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2289" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2290" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2291" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2292" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2293" class="mo">−</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2294" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2295" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2296" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2297" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2298" class="mo">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.202em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.691em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.753em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.753em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.223em; border-left: 0px solid; width: 0px; height: 13.11em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left center left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>2</mn><mo>+</mo><msup><mi mathvariant="normal">Φ</mi><mo>′</mo></msup><mo>−</mo><mi mathvariant="normal">Φ</mi></mtd><mtd><mo>=</mo></mtd><mtd><mn>2</mn><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mn>2</mn><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mn>2</mn><mo>+</mo><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mn>2</mn><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mn>2</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mo>≤</mo></mtd><mtd><mn>2</mn><mo>+</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mfrac><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow><mrow><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mn>2</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">(</mo><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span><script id="MathJax-Element-268" type="math/tex">\begin{array} {lcl} 2 + \Phi' - \Phi & = & 2 + r'(x) + r'(y) + r'(z) - r(x) - r(y)  - r(z)\\ & = & 2  + r'(y) + r'(z) - 2r(x) \\ &= & 2 + (r'(y) - r'(x))  + (r'(z) - r'(x)) + 2(r'(x) - r(x))\\ &= & 2 + \log \frac{s'(y)}{s'(x)} + \log \frac{s'(z)}{s'(x)} + 2(r'(x) - r(x)) \\ & \leq & 2 + 2    \log \frac{s'(x)/2}{s'(x)} +  2(r'(x) - r(x)) = 2 (r'(x) - r(x)) \leq 3(r'(x) - r(x))\end{array} </script>
 </p>
<p>Từ dòng thứ nhất xuống  xuống dòng dưới là do <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-269-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.349em; display: inline-block;" role="math" id="MathJax-Span-2299" class="math"><span style="display: inline-block; position: relative; width: 4.758em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.66em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2300" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2301" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2302" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2303" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2304" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2305" class="mo">≥</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2306" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2307" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2308" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2309" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>r</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-269" type="math/tex">r(x) \geq r(y)</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-270-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.76em; display: inline-block;" role="math" id="MathJax-Span-2310" class="math"><span style="display: inline-block; position: relative; width: 5.067em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1004.97em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2311" class="mrow"><span id="MathJax-Span-2312" class="msup"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2313" class="mi">r</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.451em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2314" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2315" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2316" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2317" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2318" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2319" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2320" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2321" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2322" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-270" type="math/tex">r'(x) = r(z)</script>. Bất đẳng thức từ dòng thứ 5 là do áp dụng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-271-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-2323" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.14em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2324" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2325" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2326" class="mn">4</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2327" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-271" type="math/tex">(4)</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-272-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.445em; display: inline-block;" role="math" id="MathJax-Span-2328" class="math"><span style="display: inline-block; position: relative; width: 8.59em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.404em, 1008.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2329" class="mrow"><span id="MathJax-Span-2330" class="msup"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2331" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.469em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2332" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2333" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2334" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2335" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2336" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-2337" class="msup"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2338" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.469em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2339" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2340" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2341" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2342" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2343" class="mo">≤</span><span style="padding-left: 0.278em;" id="MathJax-Span-2344" class="msup"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2345" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.469em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2346" class="mo">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2347" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2348" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2349" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.506em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>≤</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-272" type="math/tex">s'(y) + s'(z) \leq s'(x)</script>. </p>
<li>Phép roller-coaster chứng minh tương tự như phép zig-zag và coi như bài tập cho bạn đọc.
</li><li>
</li></ol>
<p><b>Remark</b> Giả sử mỗi nút của cây có một trong số <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-273-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-2350" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2351" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2352" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2353" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2354" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2355" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-273" type="math/tex">w(v)</script>. Ta có thể thay đổi một chút chứng minh ở trên với hạng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-274-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.979em; display: inline-block;" role="math" id="MathJax-Span-2356" class="math"><span style="display: inline-block; position: relative; width: 6.736em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.64em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2357" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2358" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2359" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2360" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2361" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2362" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2363" class="mi">log</span><span id="MathJax-Span-2364" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2365" class="mi">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2366" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2367" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2368" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mi>W</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-274" type="math/tex">r(v) =  \log W(v)</script> trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-275-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-2369" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.19em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2370" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2371" class="mi">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2372" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2373" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2374" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-275" type="math/tex">W(v)</script> là tổng trọng số của các nút con trong cây con gốc tại <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-276-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2375" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2376" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2377" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-276" type="math/tex">v</script>, ta cũng thu được kết quả tương tự. Ví dụ trong trường hợp mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-277-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2378" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2379" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2380" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-277" type="math/tex">v</script> có tần số truy cập là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-278-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.158em; display: inline-block;" role="math" id="MathJax-Span-2381" class="math"><span style="display: inline-block; position: relative; width: 1.607em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.51em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2382" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2383" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2384" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2385" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2386" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-278" type="math/tex">t(v)</script>, bằng cách đặt <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-279-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.596em; display: inline-block;" role="math" id="MathJax-Span-2387" class="math"><span style="display: inline-block; position: relative; width: 4.944em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.85em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2388" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2389" class="mi">w</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2390" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2391" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2392" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2393" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2394" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2395" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2396" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2397" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-279" type="math/tex">w(v) = t(v)</script> ta thu được Lemma sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 6 (Static Optimality Thoerem): </b></a> Chi phí khấu trừ truy nhập mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-280-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2398" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2399" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2400" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-280" type="math/tex">v</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-281-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.623em; display: inline-block;" role="math" id="MathJax-Span-2401" class="math"><span style="display: inline-block; position: relative; width: 7.972em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2402" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2403" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2404" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2405" class="mi">log</span><span id="MathJax-Span-2406" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2407" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2408" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2409" class="mi">log</span><span id="MathJax-Span-2410" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2411" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2412" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2413" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2414" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2415" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>T</mi><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-281" type="math/tex">O(\log T - \log t(v))</script>, trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-282-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-2416" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.22em, 2.827em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2417" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2418" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2419" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-2420" class="munderover"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-2421" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.732em; left: 1.056em;"><span id="MathJax-Span-2422" class="texatom"><span id="MathJax-Span-2423" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2424" class="mi">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2425" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2426" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2427" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2428" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.552em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>v</mi></mrow></munder><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-282" type="math/tex">T = \sum_{v}t(v)</script>.
</div>
<p>&nbsp;</p>
<p>Có thể thấy nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-283-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.185em; display: inline-block;" role="math" id="MathJax-Span-2429" class="math"><span style="display: inline-block; position: relative; width: 4.635em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.54em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2430" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2431" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2432" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2433" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2434" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2435" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2436" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2437" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2438" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2439" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-283" type="math/tex">t(v) = t(u)</script> với mọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-284-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.075em; display: inline-block;" role="math" id="MathJax-Span-2440" class="math"><span style="display: inline-block; position: relative; width: 1.545em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1001.53em, 2.728em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2441" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2442" class="mi">u</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2443" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2444" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.34em; border-left: 0px solid; width: 0px; height: 1.012em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>,</mo><mi>v</mi></math></span></span><script id="MathJax-Element-284" type="math/tex">u,v</script> (tần số truy nhập khóa là đều), thì chi phí khấu trừ là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-285-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-2445" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.49em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2446" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2447" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2448" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2449" class="mi">log</span><span id="MathJax-Span-2450" class="mo"></span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2451" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2452" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-285" type="math/tex">O(\log n)</script>. Trong trường hợp <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-286-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2453" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2454" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2455" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-286" type="math/tex">v</script> được truy nhập nhiều hơn, ví dụ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-287-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.116em; display: inline-block;" role="math" id="MathJax-Span-2456" class="math"><span style="display: inline-block; position: relative; width: 3.831em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.258em, 1003.83em, 2.931em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2457" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2458" class="mi">t</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2459" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2460" class="mi">v</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2461" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2462" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-2463" class="mfrac"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.353em, 1000.5em, 4.202em, -1000em); top: -4.443em; left: 50%; margin-left: -0.249em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2464" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1000.32em, 4.202em, -1000em); top: -3.62em; left: 50%; margin-left: -0.177em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-2465" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.788em, 1000.62em, 1.236em, -1000em); top: -1.271em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.618em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.051em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.61em; border-left: 0px solid; width: 0px; height: 1.895em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>T</mi><mn>2</mn></mfrac></math></span></span><script id="MathJax-Element-287" type="math/tex">t(v) = \frac{T}{2}</script>, thì có thể thấy chi phí truy nhập của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-288-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2466" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.72em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2467" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2468" class="mi">v</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.768em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script id="MathJax-Element-288" type="math/tex">v</script> là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-289-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-2469" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2470" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2471" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2472" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2473" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2474" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-289" type="math/tex">O(1)</script></p>
<p>Code đầy  đủ của bài viết: <a href="http://www.giaithuatlaptrinh.com/wp-content/uploads/2015/12/splaytree.c" target="_blank">Splay-Tree</a>.</p>
<p><strong> <font size="4">Tham Khảo</font> </strong></p>
<p>[1] Sleator, Daniel Dominic, and Robert Endre Tarjan. <i>Self-adjusting binary search trees.</i> Journal of the ACM (JACM) 32.3 (1985): 652-686. <a href="http://www.cs.princeton.edu/courses/archive/fall07/cos521/handouts/self-adjusting.pdf">Paper here</a>.<br>
[2] Ravi Teja Cheruku, <a href="http://cs.indstate.edu/%7Ercheruku/splaytree.pdf" target="_blank">Splay Tree Lecture Note</a>, Indiana State University, 2011.<br>
[3] Jeff Erickson, <a href="http://jeffe.cs.illinois.edu/teaching/algorithms/notes/16-scapegoat-splay.pdf" target="_blank">Scapegoat Tree and Splay Tree Lecture Note</a>, UIUC, 2013.<br>
[4] Robert Sedgewick and Kevin Wayn. <a href="http://algs4.cs.princeton.edu/33balanced/SplayBST.java.html" target="_blank">Splay Tree implementation in Java</a>. Princeton, 2015.<br>
[5] Jeff Erickson, <a href="http://jeffe.cs.illinois.edu/teaching/algorithms/2009/notes/08-amortize.pdf" target="_blank">Amortized Analysis Lecture Note</a>, UIUC, 2009.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-613" class="share-twitter sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=613&amp;share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-613" class="share-facebook sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=613&amp;share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-613" class="share-google-plus-1 sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=613&amp;share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div style="display: block;" id="jp-relatedposts" class="jp-relatedposts" data-exclude="488">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="643" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="0" data-origin="613" rel="nofollow" title="Cây tìm kiếm ưu tiên -- Priority Search Tree

Trong bài này chúng ta sẽ làm quen với một cấu trúc dữ liệu sử dụng trong hình học tính toán (computational geometry) tên gọi là cây tìm kiếm ưu tiên (Priority Search Tree - PST). Cây PST được McCreight [1] phát triển vào năm 1985 (cũng là người phát…" href="http://www.giaithuatlaptrinh.com/?p=643" class="jp-relatedposts-post-a">Cây tìm kiếm ưu tiên -- Priority Search Tree</a></span><span class="jp-relatedposts-post-date">December 27, 2015</span><span class="jp-relatedposts-post-context">In "binary search tree"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="1140" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="1" data-origin="613" rel="nofollow" title="Cây khung nhỏ nhất: thuật toán Kruskal --- Kruskal Algorithm

Bài viết này là khởi động của loạt bài mình định viết về cây khung nhỏ nhất. Kế hoạch của mình là viết 4 bài về 4 thuật toán khác nhau. Thuật toán Kruskal [1]. Lý do thuật toán này được viết đầu tiên là vì nó đơn giản trong…" href="http://www.giaithuatlaptrinh.com/?p=1140" class="jp-relatedposts-post-a">Cây khung nhỏ nhất: thuật toán Kruskal --- Kruskal Algorithm</a></span><span class="jp-relatedposts-post-date">May 22, 2016</span><span class="jp-relatedposts-post-context">In "greedy algorithm"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="967" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="2" data-origin="613" rel="nofollow" title="Bảng băm và các cơ chế giải quyết xung đột cơ bản -- Hashing and  collision  handling

Bài này mình lượt qua cấu trúc dữ liệu bảng băm (hash table), hàm băm (hash functions) và một số cơ chế giải quyết xung đột (collision handling). Mục tiêu của bài này là đưa ra một cách nhìn tổng quan về cách thức thiết kế bảng băm. Mọi cơ…" href="http://www.giaithuatlaptrinh.com/?p=967" class="jp-relatedposts-post-a">Bảng băm và các cơ chế giải quyết xung đột cơ bản -- Hashing and  collision  handling</a></span><span class="jp-relatedposts-post-date">March 31, 2016</span><span class="jp-relatedposts-post-context">In "ball-and-bin"</span></p></div></div>                    </ol></ol></div>
                    
                    <p class="tagdata"><strong>Tags:</strong> <a href="http://www.giaithuatlaptrinh.com/?tag=amortized-analysis" rel="tag">amortized analysis</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=binary-search-tree" rel="tag">binary search tree</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=data-structure" rel="tag">data structure</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=spaly-tree" rel="tag">spaly tree</a></p>
                
                </div> <!-- /entry -->
            
                    
            
        
        <div id="comments-header">
        <div class="clearfix">
            <h2 class="title">No comments</h2>
                      <p class="comments-feed"><a href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=613">Comments feed for this article</a></p>
                    </div>
                  <p class="trackback-link">Trackback link: <a href="http://www.giaithuatlaptrinh.com/wp-trackback.php?p=613">http://www.giaithuatlaptrinh.com/wp-trackback.php?p=613</a></p>
            </div>
    
            				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.giaithuatlaptrinh.com/?p=613&amp;relatedposts_hit=1&amp;relatedposts_origin=488&amp;relatedposts_position=1#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.giaithuatlaptrinh.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>    <div class="response textarea-wrap">
        <label for="comment">Your comment</label>
        <textarea name="comment" id="comment" cols="60" rows="10" aria-required="true" aria-multiline="true"></textarea>
    </div><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="613" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="c0fa1e008e" type="hidden"></p><p class="comment-subscription-form"><input name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1465415038184" type="hidden"></form>
					</div><!-- #respond -->
		    </div>

<div id="sidebar" class="secondary">

        
</div>
</div> <!-- /main content -->



<div id="footer" class="clearfix">
    
    <div class="secondary">
        
                
    </div> <!-- /secondary -->
    
    <div class="primary">
        
                
    </div> <!-- /primary -->
    
    <div id="theme-info" class="clearfix">
        
        <div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div><div class="primary content">
    <p>Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://tarskitheme.com/">Tarski</a></p>
</div>
        
    </div> <!-- /theme-info -->
    
</div> <!-- /footer -->

</div><script type="text/x-mathjax-config;executed=true"> 
        MathJax.Hub.Config({ 
                TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}}, 
                "HTML-CSS": {linebreaks: {automatic: true}}, 
                SVG: {linebreaks: {automatic: true}}
        }); 
</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/MathJax.js">MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>	<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/www.giaithuatlaptrinh.com\/?p=613":613};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/form.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/shCore.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/shBrushCpp.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/photon.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=613&relatedposts_hit=1&relatedposts_origin=488&relatedposts_position=1&wc-ajax=%%endpoint%%","i18n_view_cart":"View Cart","cart_url":"","is_cart":"","cart_redirect_after_add":"no"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/add-to-cart.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jquery_003.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=613&relatedposts_hit=1&relatedposts_origin=488&relatedposts_position=1&wc-ajax=%%endpoint%%"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/woocommerce.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_cart_fragments_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=613&relatedposts_hit=1&relatedposts_origin=488&relatedposts_position=1&wc-ajax=%%endpoint%%","fragment_name":"wc_fragments"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/cart-fragments.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/devicepx-jetpack.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/wpgroho.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/comment-reply.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/wp-embed.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/sharing.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/e-201623.js" async="" defer="defer"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.0.3',blog:'97171708',post:'613',tz:'0',srv:'www.giaithuatlaptrinh.com'} ]);
	_stq.push([ 'clickTrackerInit', '97171708', '613' ]);
</script>

<img id="wpstats" alt=":)" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20C%C3%A2y%20Splay%20%E2%80%94%20Splay%20Tree_files/g.gif" width="6" height="5"><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_AMS,monospace;" id="MathJax_Font_Test"></div></div></body></html>