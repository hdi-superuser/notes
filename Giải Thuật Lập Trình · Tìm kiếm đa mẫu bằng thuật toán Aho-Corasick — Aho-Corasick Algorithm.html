<!DOCTYPE html>
<html lang="en-US"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Giải Thuật Lập Trình · Tìm kiếm đa mẫu bằng thuật toán Aho-Corasick —  Aho-Corasick Algorithm</title>
    <link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="Giải Thuật Lập Trình » Tìm kiếm đa mẫu bằng thuật toán Aho-Corasick --  Aho-Corasick Algorithm Comments Feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=703">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.giaithuatlaptrinh.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.2"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/wp-emoji-release.js"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="woocommerce-layout-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/woocommerce-layout.css" type="text/css" media="all">
<link rel="stylesheet" id="woocommerce-smallscreen-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/woocommerce-smallscreen.css" type="text/css" media="only screen and (max-width: 768px)">
<link rel="stylesheet" id="woocommerce-general-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/woocommerce.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/dashicons.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-jquery-ui-dialog-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jquery-ui-dialog.css" type="text/css" media="all">
<link rel="stylesheet" id="ajax_shoutbox-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/ajax_shoutbox.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jquery_002.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/related-posts.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/tarski.js"></script>
<meta name="description" content="Wiki về giải thuật">
<meta name="robots" content="all">
<link rel="profile" href="http://gmpg.org/xfn/11">

<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/style.css" type="text/css" media="all">
<link rel="stylesheet" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/print.css" type="text/css" media="print">

<link rel="https://api.w.org/" href="http://www.giaithuatlaptrinh.com/?rest_route=/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.giaithuatlaptrinh.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.giaithuatlaptrinh.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Máy trạng thái hữu  hạn và thuật toán KMP" href="http://www.giaithuatlaptrinh.com/?p=687">
<link rel="next" title="Heap nhị phân và thuật toán Heapsort -- Binary Heap and Heapsort" href="http://www.giaithuatlaptrinh.com/?p=736">
<meta name="generator" content="WordPress 4.5.2">
<meta name="generator" content="WooCommerce 2.5.5">
<link rel="canonical" href="http://www.giaithuatlaptrinh.com/?p=703">
<link rel="shortlink" href="http://wp.me/p6zINC-bl">
<link rel="alternate" type="application/json+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D703">
<link rel="alternate" type="text/xml+oembed" href="http://www.giaithuatlaptrinh.com/?rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.giaithuatlaptrinh.com%2F%3Fp%3D703&amp;format=xml">

<link rel="dns-prefetch" href="http://v0.wordpress.com/">
<link rel="dns-prefetch" href="http://i0.wp.com/">
<link rel="dns-prefetch" href="http://i1.wp.com/">
<link rel="dns-prefetch" href="http://i2.wp.com/">
<style type="text/css">img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Tìm kiếm đa mẫu bằng thuật toán Aho-Corasick --  Aho-Corasick Algorithm">
<meta property="og:url" content="http://www.giaithuatlaptrinh.com/?p=703">
<meta property="og:description" content="Thuật toán Aho-Corasick được phát triển bởi Alfred Aho và Margaret Corasick vào năm 1975 cho bài toán tìm kiếm đa mẫu sau: Problem 1: Cho một tập các từ khóa $$\mathcal{K} = \{K_1,K_2, \ldots, K_k …">
<meta property="article:published_time" content="2016-01-02T21:18:14+00:00">
<meta property="article:modified_time" content="2016-01-05T05:47:45+00:00">
<meta property="og:site_name" content="Giải Thuật Lập Trình">
<meta property="og:image" content="http://www.giaithuatlaptrinh.com/wp-content/uploads/2016/01/out-func-ex.png">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary">
<link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/shCore.css" type="text/css" rel="stylesheet"><link href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/shThemeDefault.css" type="text/css" rel="stylesheet"><style type="text/css" id="syntaxhighlighteranchor"></style>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/services.css"><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.1') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body id="post-tim-kiem-da-mau-bang-thuat-toan-aho-corasick-aho-corasick-algorithm" class="single single-post postid-703 single-format-standard centre"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div style="display: none;" id="MathJax_Message"></div>

<div id="wrapper" class="tarski">
    <div id="header">
        <div id="title">
	<h1 id="blog-title"><a title="Return to main page" href="http://www.giaithuatlaptrinh.com/" rel="home">Giải Thuật Lập Trình</a></h1>
	<p id="tagline">Wiki về giải thuật</p></div>
<div id="navigation" class="clearfix">        <ul id="menu-primary-navigation" class="primary xoxo">
            <li><a title="Return to front page" href="http://www.giaithuatlaptrinh.com/">Home</a></li>
            <li class="page_item page-item-2"><a href="http://www.giaithuatlaptrinh.com/?page_id=2">About</a></li>
<li class="page_item page-item-4"><a href="http://www.giaithuatlaptrinh.com/?page_id=4">Các bài đã viết</a></li>

    </ul><div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div></div><script type="text/javascript">
    jQuery(document).ready(function() {
        var container = jQuery('#navigation > ul'),
            navbar;
        
        if (container.length > 0) {
            navbar = new Tarski.Navbar(container);
        }
    });
</script><p class="primary-span articlenav"><span class="previous-entry"><a href="http://www.giaithuatlaptrinh.com/?p=687" rel="prev">‹ Máy trạng thái hữu  hạn và thuật toán KMP</a></span> <span class="separator">&nbsp;•&nbsp;</span> <span class="next-entry"><a href="http://www.giaithuatlaptrinh.com/?p=736" rel="next">Heap nhị phân và thuật toán Heapsort -- Binary Heap and Heapsort ›</a></span></p>
    </div>
    
    <div id="content" class="clearfix">

<div class="primary">
        
                
                        
                <div class="entry post-703 post type-post status-publish format-standard hentry category-uncategorized tag-aho-corasick tag-finite-state-machine tag-knuth tag-linear-time-algorithm tag-string-matching">
                
                    <div class="meta">
                        <h1 class="title entry-title">Tìm kiếm đa mẫu bằng thuật toán Aho-Corasick --  Aho-Corasick Algorithm</h1>                        
                        <p class="metadata"><span class="date updated">January 2, 2016</span> in <span class="categories"><a href="http://www.giaithuatlaptrinh.com/?cat=1" rel="category">Uncategorized</a></span> | <a class="comments-link" href="http://www.giaithuatlaptrinh.com/?p=703#respond">No comments</a></p>                    </div>
                    
                    <div class="content clearfix">
                                                <p>Thuật toán Aho-Corasick được phát triển bởi Alfred Aho và Margaret Corasick vào năm 1975 cho bài toán tìm kiếm đa mẫu sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Problem 1: </b></a> Cho một tập các từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-1-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 12.925em; display: inline-block;" role="math" id="MathJax-Span-1" class="math"><span style="display: inline-block; position: relative; width: 9.702em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.64em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2" class="mrow"><span id="MathJax-Span-3" class="texatom"><span id="MathJax-Span-4" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-5" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-6" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-7" class="mo">{</span><span id="MathJax-Span-8" class="msubsup"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-9" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-10" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-11" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-12" class="msubsup"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-13" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-14" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-15" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-16" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-17" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-18" class="msubsup"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-19" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-20" class="mi">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-21" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>K</mi><mn>1</mn></msub><mo>,</mo><msub><mi>K</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>K</mi><mi>k</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-1" type="math/tex">\mathcal{K} = \{K_1,K_2, \ldots, K_k \}</script> trong đó từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-2-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-22" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-23" class="mrow"><span id="MathJax-Span-24" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-25" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-26" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-2" type="math/tex">K_i</script> có độ dài <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-3-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-27" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-28" class="mrow"><span id="MathJax-Span-29" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-30" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-31" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 0.962em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-3" type="math/tex">m_i</script>, và một văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-4-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-32" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-33" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-34" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-35" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-36" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-37" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-38" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-39" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-40" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-41" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-42" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-43" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-4" type="math/tex">T[1,2,\ldots, n]</script>. Tìm tất cả các xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-5-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-44" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-45" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-46" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-5" type="math/tex">T</script> xuất hiện trong tập các từ khóa.
</div>
<p>&nbsp;</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Definition: </b></a> Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-6-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.075em; display: inline-block;" role="math" id="MathJax-Span-47" class="math"><span style="display: inline-block; position: relative; width: 6.056em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.195em, 1006.06em, 2.827em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-48" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-49" class="mi">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-50" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-51" class="munderover"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-52" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.341em, 1000.44em, 4.21em, -1000em); top: -4.494em; left: 1.056em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-53" class="mi">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1001.22em, 4.21em, -1000em); top: -3.732em; left: 1.056em;"><span id="MathJax-Span-54" class="texatom"><span id="MathJax-Span-55" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-56" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-57" class="mo">=</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-58" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-59" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-60" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-61" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.841em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>m</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-6" type="math/tex">M = \sum_{i=1}^k m_i</script> là tổng độ dài của các từ khóa và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-7-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.089em; display: inline-block;" role="math" id="MathJax-Span-62" class="math"><span style="display: inline-block; position: relative; width: 5.315em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.195em, 1005.32em, 2.827em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-63" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-64" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-65" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-66" class="munderover"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-67" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.341em, 1000.44em, 4.21em, -1000em); top: -4.494em; left: 1.056em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-68" class="mi">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1001.22em, 4.21em, -1000em); top: -3.732em; left: 1.056em;"><span id="MathJax-Span-69" class="texatom"><span id="MathJax-Span-70" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-71" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-72" class="mo">=</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-73" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="padding-left: 0.167em;" id="MathJax-Span-74" class="msubsup"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.47em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-75" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.465em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-76" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.841em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-7" type="math/tex">Z = \sum_{i=1}^k z_i</script> là tổng số lần xuất hiện của các từ khóa trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-8-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.089em; display: inline-block;" role="math" id="MathJax-Span-77" class="math"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.8em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-78" class="mrow"><span id="MathJax-Span-79" class="msubsup"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.47em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-80" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.465em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-81" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 0.962em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-8" type="math/tex">z_i</script> là số lần xuất hiện của từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-9-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-82" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-83" class="mrow"><span id="MathJax-Span-84" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-85" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-86" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-9" type="math/tex">K_i</script> trong văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-10-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-87" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-88" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-89" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-10" type="math/tex">T</script>
</div>
<p>&nbsp;</p>
<p>Với mỗi từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-11-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-90" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-91" class="mrow"><span id="MathJax-Span-92" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-93" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-94" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-11" type="math/tex">K_i</script>, ta có thế áp dụng thuật toán tuyến tính (ví dụ <a href="http://www.giaithuatlaptrinh.com/?p=238" target="_blank">KMP</a> hoặc <a href="http://www.giaithuatlaptrinh.com/?p=250" target="_blank">thuật toán Z</a>) để tìm kiếm sự xuất hiện của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-12-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-95" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-96" class="mrow"><span id="MathJax-Span-97" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-98" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-99" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-12" type="math/tex">K_i</script> trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-13-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-100" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-101" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-102" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-13" type="math/tex">T</script>. Mỗi lần tìm kiếm như vậy ta mất thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-14-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.733em; display: inline-block;" role="math" id="MathJax-Span-103" class="math"><span style="display: inline-block; position: relative; width: 6.551em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.46em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-104" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-105" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-106" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-107" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-108" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-109" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-110" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-111" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-112" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-113" class="msubsup"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.47em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-114" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.465em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-115" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-116" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><msub><mi>m</mi><mi>i</mi></msub><mo>+</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-14" type="math/tex">O(n + m_i + z_i)</script> và do đó, tổng thời gian tìm kiếm <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-15-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-117" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-118" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-119" class="mi">k</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script id="MathJax-Element-15" type="math/tex">k</script> từ khóa là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-16-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 24.432em; display: inline-block;" role="math" id="MathJax-Span-120" class="math"><span style="display: inline-block; position: relative; width: 18.354em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.195em, 1018.26em, 2.827em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-121" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-122" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-123" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-124" class="mi">k</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-125" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-126" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-127" class="munderover"><span style="display: inline-block; position: relative; width: 2.279em; height: 0px;"><span style="position: absolute; clip: rect(3.081em, 1001em, 4.452em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Size1; vertical-align: 0em;" id="MathJax-Span-128" class="mo">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.341em, 1000.44em, 4.21em, -1000em); top: -4.494em; left: 1.056em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-129" class="mi">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.361em, 1001.22em, 4.21em, -1000em); top: -3.732em; left: 1.056em;"><span id="MathJax-Span-130" class="texatom"><span id="MathJax-Span-131" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-132" class="mi">i</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-133" class="mo">=</span><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-134" class="mn">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-135" class="mo">(</span><span id="MathJax-Span-136" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-137" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-138" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-139" class="mo">+</span><span style="padding-left: 0.222em;" id="MathJax-Span-140" class="msubsup"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.47em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-141" class="mi">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.465em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-142" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-143" class="mo">)</span><span style="font-family: MathJax_Main;" id="MathJax-Span-144" class="mo">)</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-145" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-146" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-147" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-148" class="mi">k</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-149" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-150" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-151" class="mi">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-152" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-153" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-154" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.472em; border-left: 0px solid; width: 0px; height: 1.841em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>n</mi><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mo stretchy="false">(</mo><msub><mi>m</mi><mi>i</mi></msub><mo>+</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>n</mi><mo>+</mo><mi>M</mi><mo>+</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-16" type="math/tex">O(kn + \sum_{i=1}^k (m_i + z_i)) = O(kn + M+ Z)</script>. Nếu cả <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-17-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-155" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.6em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-156" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-157" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-17" type="math/tex">n</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-18-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-158" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1000.48em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-159" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-160" class="mi">k</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script id="MathJax-Element-18" type="math/tex">k</script> đều lớn thì thuật toán này thực sự không hiệu quả. Aho-Corasick dựa trên ý tưởng của thuật toán KMP và <a href="http://www.giaithuatlaptrinh.com/?p=687" target="_blank">máy trạng thái hữu hạn</a> đã phát triển giải thuật với thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-19-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.295em; display: inline-block;" role="math" id="MathJax-Span-161" class="math"><span style="display: inline-block; position: relative; width: 7.725em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.63em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-162" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-163" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-164" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-165" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-166" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-167" class="mi">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span id="MathJax-Span-168" class="texatom"><span id="MathJax-Span-169" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-170" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-171" class="mi">Σ</span><span id="MathJax-Span-172" class="texatom"><span id="MathJax-Span-173" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-174" class="mo">|</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-175" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-176" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-177" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>M</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-19" type="math/tex">O(n + M|\Sigma|  + Z)</script> trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-20-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-178" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.24em, 2.721em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-179" class="mrow"><span id="MathJax-Span-180" class="texatom"><span id="MathJax-Span-181" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-182" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-183" class="mi">Σ</span><span id="MathJax-Span-184" class="texatom"><span id="MathJax-Span-185" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-186" class="mo">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.493em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script id="MathJax-Element-20" type="math/tex">|\Sigma|</script> là số kí tự trong bảng chữ cái sử dụng. Thông thường, <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-21-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-187" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.24em, 2.721em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-188" class="mrow"><span id="MathJax-Span-189" class="texatom"><span id="MathJax-Span-190" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-191" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-192" class="mi">Σ</span><span id="MathJax-Span-193" class="texatom"><span id="MathJax-Span-194" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-195" class="mo">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.493em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script id="MathJax-Element-21" type="math/tex">|\Sigma|</script> là một hằng số, do đó, thuật toán có thể coi là có thời gian tuyến tính. Trọng tâm bài này là định lý sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Theorem 1: </b></a> Tồn tại một thuật toán tìm kiếm tất cả các xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-22-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.582em; display: inline-block;" role="math" id="MathJax-Span-196" class="math"><span style="display: inline-block; position: relative; width: 5.685em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.57em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-197" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-198" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-199" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-200" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-201" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-202" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-203" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-204" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-205" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-206" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-207" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-22" type="math/tex">T[1,2,\ldots, n]</script> xuất hiện trong tập các từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-23-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-208" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-209" class="mrow"><span id="MathJax-Span-210" class="texatom"><span id="MathJax-Span-211" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-212" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-23" type="math/tex">\mathcal{K}</script> trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-24-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.295em; display: inline-block;" role="math" id="MathJax-Span-213" class="math"><span style="display: inline-block; position: relative; width: 7.725em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.63em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-214" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-215" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-216" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-217" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-218" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-219" class="mi">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span id="MathJax-Span-220" class="texatom"><span id="MathJax-Span-221" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-222" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-223" class="mi">Σ</span><span id="MathJax-Span-224" class="texatom"><span id="MathJax-Span-225" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-226" class="mo">|</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-227" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-228" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-229" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>M</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-24" type="math/tex">O(n  + M |\Sigma| + Z)</script>,
</div>
<p>&nbsp;</p>
<p><strong> <font size="4">Máy trạng thái hữu hạn</font></strong></p>
<p>Trong bài <a href="http://www.giaithuatlaptrinh.com/?p=687" target="_blank">máy trạng thái hữu hạn</a> (finite-state machine - FSM), chúng ta đã làm quen với một máy trạng thái hữu hạn định nghĩa cho một xâu mẫu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-25-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.993em; display: inline-block;" role="math" id="MathJax-Span-230" class="math"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1005.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-231" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-232" class="mi">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-233" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-234" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-235" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-236" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-237" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-238" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-239" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-240" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-241" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>m</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-25" type="math/tex">P[1,2,\ldots,m]</script> và cách xây dựng máy trạng thái đó trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-26-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-242" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-243" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-244" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-245" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-246" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-247" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-26" type="math/tex">O(m)</script>. Bây giờ chúng ta sẽ mở rộng khái niệm đó cho tập các từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-27-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.623em; display: inline-block;" role="math" id="MathJax-Span-248" class="math"><span style="display: inline-block; position: relative; width: 7.972em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.91em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-249" class="mrow"><span id="MathJax-Span-250" class="texatom"><span id="MathJax-Span-251" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-252" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-253" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-254" class="mo">{</span><span id="MathJax-Span-255" class="msubsup"><span style="display: inline-block; position: relative; width: 1.278em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-256" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-257" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-258" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-259" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-260" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-261" class="msubsup"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-262" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-263" class="mi">k</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-264" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>K</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>K</mi><mi>k</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-27" type="math/tex">\mathcal{K} = \{K_1, \ldots, K_k \}</script>. Mình khuyến khích bạn đọc xem lại bài máy trạng thái hữu hạn trước khi đọc tiếp phần dưới đây.</p>
<p>Một máy trạng thái hữu hạn của tập các từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-28-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-265" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-266" class="mrow"><span id="MathJax-Span-267" class="texatom"><span id="MathJax-Span-268" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-269" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-28" type="math/tex">\mathcal{K}</script> là một đồ thị có hướng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-29-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-270" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.13em, 1003.43em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-271" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-272" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-273" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;" id="MathJax-Span-274" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-275" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-276" class="texatom"><span id="MathJax-Span-277" class="mrow"><span id="MathJax-Span-278" class="munderover"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.76em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-279" class="mi">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.335em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-280" class="mo">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.247em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-281" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.87em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>E</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-29" type="math/tex">G(V,\vec{E})</script> và có các đặc điểm sau:</p>
<ol>
<li>Mỗi nút được gán cho một số nguyên duy nhất và được gọi là mỗi <em>trạng thái</em>. Đồ thị <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-30-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-282" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.13em, 1003.43em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-283" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-284" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-285" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;" id="MathJax-Span-286" class="mi">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-287" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-288" class="texatom"><span id="MathJax-Span-289" class="mrow"><span id="MathJax-Span-290" class="munderover"><span style="display: inline-block; position: relative; width: 0.764em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.76em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-291" class="mi">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.335em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.471em; display: inline-block; overflow: hidden;"></span><span style="font-family: MathJax_Main;" id="MathJax-Span-292" class="mo">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.247em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-293" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.87em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>E</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-30" type="math/tex">G(V,\vec{E})</script> có một nút đặc biệt có trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-31-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-294" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-295" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-296" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-31" type="math/tex">0</script>. </li>
<li>Có hai loại cạnh trong đồ thị <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-32-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.089em; display: inline-block;" role="math" id="MathJax-Span-297" class="math"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.458em, 1000.78em, 2.556em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-298" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-299" class="mi">G</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script id="MathJax-Element-32" type="math/tex">G</script>: <i>cạnh khớp</i> (success edge) và <i>cạnh không khớp</i> (failure edge).  Mỗi cạnh khớp sẽ có nhãn là một kí tự xuất hiện trong một từ khóa nào đó.</li>
<li> Tập các cạnh khớp sẽ tạo thành một cây với gốc tại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-33-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-300" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-301" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-302" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-33" type="math/tex">0</script>. Cây này chính là <a href="https://en.wikipedia.org/wiki/Trie" target="_blank">cây Trie</a> của tập khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-34-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-303" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-304" class="mrow"><span id="MathJax-Span-305" class="texatom"><span id="MathJax-Span-306" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-307" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-34" type="math/tex">\mathcal{K}</script>, hay còn gọi là <em> cây tiền tố</em> (sẽ giải thích ở dưới đây).</li>
<li>Mỗi nút trong, không phải là gốc, của cây trie này sẽ có một cạnh 
không khớp tới một nút khác. Các cạnh khớp sẽ được xác định dựa trên <i>luật cạnh không khớp</i> được mô tả sau đây. Cạnh không khớp sẽ có hướng từ nút có độ sâu (trong cây Trie) lớn đến nút có độ sâu nhỏ hơn. </li>
</ol>
<p>Trong hình dưới đây mô tả một cây Trie với tập từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-35-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.993em; display: inline-block;" role="math" id="MathJax-Span-308" class="math"><span style="display: inline-block; position: relative; width: 10.506em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1010.44em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-309" class="mrow"><span id="MathJax-Span-310" class="texatom"><span id="MathJax-Span-311" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-312" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-313" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-314" class="mo">{</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-315" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-316" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-317" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-318" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-319" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-320" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-321" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-322" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-323" class="mi">i</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-324" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-325" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-326" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-327" class="mi">e</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-328" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-329" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-330" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>h</mi><mi>e</mi><mo>,</mo><mi>s</mi><mi>h</mi><mi>e</mi><mo>,</mo><mi>h</mi><mi>i</mi><mi>s</mi><mo>,</mo><mi>h</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-35" type="math/tex"> \mathcal{K} = \{he, she, his, hers\}</script> (hình (a)) và máy trạng thái hữu hạn tương ứng (hình (b)). Các cạnh màu đỏ là các cạnh không khớp. </p>
<p><img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/fsm-ex-1.png" alt="fsm-multi-pattern" width="422" height="460">    </p>
<p>Với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-36-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-331" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-332" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-333" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-36" type="math/tex">i</script> của cây Trie, ta gọi xâu tạo bởi các kí tự trên đường đi từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-37-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-334" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-335" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-336" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-37" type="math/tex">0</script> tới <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-38-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-337" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-338" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-339" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-38" type="math/tex">i</script> là <i>nhãn đường đi</i> (path label) của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-39-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-340" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-341" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-342" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-39" type="math/tex">i</script>. Có thể thấy cây Trie cho một tập các từ khóa có các đặc điểm sau:</p>
<ol>
<li>Mỗi từ khóa của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-40-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-343" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-344" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-345" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-40" type="math/tex">K</script>
 sẽ tương ứng với một nút trong cây trie có nhãn đường đường đi của nút 
đi là từ khóa đó. Ví dụ mỗi từ khóa trong hình (a) sẽ tương ứng với một 
nút được tô màu. </li>
<li>Mỗi nút lá có nhãn đường đi là một từ khóa trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-41-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-346" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-347" class="mrow"><span id="MathJax-Span-348" class="texatom"><span id="MathJax-Span-349" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-350" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-41" type="math/tex">\mathcal{K}</script>.
 Tuy nhiên ngược lại không đúng. Hay nói cách khác, có thể có từ khóa sẽ
 có nút tương ứng không phải là nút lá. Ví dụ nút được tô màu tương ứng 
với từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-42-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-351" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-352" class="mrow"><span id="MathJax-Span-353" class="texatom"><span id="MathJax-Span-354" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-355" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-356" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-42" type="math/tex">\mathrm{he}</script> không phải là nút lá.</li>
<li>Hai từ khóa có chung một tiền tố thì tiền tố đó sẽ là nhãn đường đi 
của tổ tiên chung gần nhất (lowest common ancestor)  của hai nút tương 
ứng với hai từ khóa đó. Ví dụ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-43-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-357" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.2em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-358" class="mrow"><span id="MathJax-Span-359" class="texatom"><span id="MathJax-Span-360" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-361" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-362" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-363" class="mi">s</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow></math></span></span><script id="MathJax-Element-43" type="math/tex">\mathrm{his}</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-44-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-364" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.7em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-365" class="mrow"><span id="MathJax-Span-366" class="texatom"><span id="MathJax-Span-367" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-368" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-369" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-370" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-371" class="mi">s</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi></mrow></math></span></span><script id="MathJax-Element-44" type="math/tex">\mathrm{hers}</script> có chung tiền tố là kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-45-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-372" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1000.53em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-373" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-374" class="mi">h</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script id="MathJax-Element-45" type="math/tex">h</script> là nhãn đường đi của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-46-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-375" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.42em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-376" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-377" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script id="MathJax-Element-46" type="math/tex">1</script>, là tổ tiên chung gần nhất của hai nút tương ứng với hai từ khóa  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-47-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-378" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.2em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-379" class="mrow"><span id="MathJax-Span-380" class="texatom"><span id="MathJax-Span-381" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-382" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-383" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-384" class="mi">s</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow></math></span></span><script id="MathJax-Element-47" type="math/tex">\mathrm{his}</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-48-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-385" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.7em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-386" class="mrow"><span id="MathJax-Span-387" class="texatom"><span id="MathJax-Span-388" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-389" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-390" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-391" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-392" class="mi">s</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi></mrow></math></span></span><script id="MathJax-Element-48" type="math/tex">\mathrm{hers}</script>. </li>
</ol>
<p>Các cạnh không khớp trong máy trạng thái được xây dựng dựa trên luật cạnh không khớp sau:</p>
<p style="margin-left:2em;"><b>Luật cạnh không khớp:</b> Nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-49-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-393" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-394" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-395" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-49" type="math/tex">i</script> có một cạnh không khớp tới nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-50-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-396" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-397" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-398" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-50" type="math/tex">j</script> khi và chỉ nhãn đường đi của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-51-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-399" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-400" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-401" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-51" type="math/tex">j</script> là hậu tố dài nhất của nhãn đường đi của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-52-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-402" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-403" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-404" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-52" type="math/tex">i</script>.</p>
<p>Ví dụ trong hình (b) ở trên, nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-53-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-405" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-406" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-407" class="mn">5</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script id="MathJax-Element-53" type="math/tex">5</script> có một cạnh không khớp tới nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-54-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-408" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-409" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-410" class="mn">2</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script id="MathJax-Element-54" type="math/tex">2</script> vì nhãn đường đi của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-55-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-411" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-412" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-413" class="mn">2</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script id="MathJax-Element-55" type="math/tex">2</script> (xâu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-56-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-414" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-415" class="mrow"><span id="MathJax-Span-416" class="texatom"><span id="MathJax-Span-417" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-418" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-419" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-56" type="math/tex">\mathrm{he}</script>) là hậu tố dài nhất của nhãn đường đi của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-57-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-420" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-421" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-422" class="mn">5</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script id="MathJax-Element-57" type="math/tex">5</script> (xâu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-58-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-423" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-424" class="mrow"><span id="MathJax-Span-425" class="texatom"><span id="MathJax-Span-426" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-427" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-428" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-429" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-58" type="math/tex">\mathrm{she}</script>). Bạn đọc có thể kiểm tra luật này với các nút khác. </p>
<p><b>Xây dựng máy trạng thái hữu hạn</b></p>
<p>Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-59-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-430" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.44em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-431" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-432" class="mi">s</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 0.766em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script id="MathJax-Element-59" type="math/tex">s</script> là số trạng thái của FSM. Ta sẽ dùng một mảng hai chiều <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-60-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 15.555em; display: inline-block;" role="math" id="MathJax-Span-433" class="math"><span style="display: inline-block; position: relative; width: 11.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1011.56em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-434" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-435" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-436" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-437" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-438" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-439" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-440" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-441" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-442" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-443" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-444" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-445" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-446" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-447" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-448" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-449" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-450" class="mo">…</span><span style="padding-left: 0.167em;" id="MathJax-Span-451" class="texatom"><span id="MathJax-Span-452" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-453" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-454" class="mi">Σ</span><span id="MathJax-Span-455" class="texatom"><span id="MathJax-Span-456" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-457" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-458" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-60" type="math/tex">G[0,\ldots, s-1][1,2,\ldots |\Sigma|]</script> để biểu diễn cây Trie, trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-61-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-459" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.58em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-460" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-461" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-462" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-463" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-464" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-465" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-466" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi></math></span></span><script id="MathJax-Element-61" type="math/tex">G[i] = j</script> nếu như nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-62-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-467" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-468" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-469" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-62" type="math/tex">j</script> là con của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-63-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-470" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-471" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-472" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-63" type="math/tex">i</script> và cạnh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-64-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-473" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1002.34em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-474" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-475" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-476" class="mo">→</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-477" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">→</mo><mi>j</mi></math></span></span><script id="MathJax-Element-64" type="math/tex">i\rightarrow j</script> có nhãn là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-65-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-478" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.43em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-479" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-480" class="mi">c</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script id="MathJax-Element-65" type="math/tex">c</script>. Ta sẽ xây dựng Trie bằng cách "chèn lần lượt" từng từ khóa của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-66-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-481" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-482" class="mrow"><span id="MathJax-Span-483" class="texatom"><span id="MathJax-Span-484" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-485" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-66" type="math/tex">\mathcal{K}</script> vào cây Trie. Ví dụ các bước xây dựng cây Trie cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-67-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.089em; display: inline-block;" role="math" id="MathJax-Span-486" class="math"><span style="display: inline-block; position: relative; width: 9.826em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.76em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-487" class="mrow"><span id="MathJax-Span-488" class="texatom"><span id="MathJax-Span-489" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-490" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-491" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-492" class="mo">{</span><span id="MathJax-Span-493" class="texatom"><span id="MathJax-Span-494" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-495" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-496" class="mi">e</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-497" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-498" class="texatom"><span id="MathJax-Span-499" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-500" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-501" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-502" class="mi">e</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-503" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-504" class="texatom"><span id="MathJax-Span-505" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-506" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-507" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-508" class="mi">s</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-509" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-510" class="texatom"><span id="MathJax-Span-511" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-512" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-513" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-514" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-515" class="mi">s</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-516" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi></mrow><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-67" type="math/tex">\mathcal{K} = \{\mathrm{he}, \mathrm{she}, \mathrm{his}, \mathrm{hers}\}</script> được minh họa bởi hình sau:<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/trie-cons-ex.png" alt="trie-construction-example" width="500" height="342"></p>
<p>Giả mã của thuật toán xây dựng cây Trie như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> ConstructTrie</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-68-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-517" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-518" class="mrow"><span id="MathJax-Span-519" class="texatom"><span id="MathJax-Span-520" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-521" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-68" type="math/tex">\mathcal{K}</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-69-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-522" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-523" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-524" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-525" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-69" type="math/tex">s\leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; set all entries of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-70-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 14.897em; display: inline-block;" role="math" id="MathJax-Span-526" class="math"><span style="display: inline-block; position: relative; width: 11.185em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1011.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-527" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-528" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-529" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-530" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-531" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-532" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-533" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-534" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-535" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-536" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-537" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-538" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-539" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-540" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-541" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-542" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-543" class="texatom"><span id="MathJax-Span-544" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-545" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-546" class="mi">Σ</span><span id="MathJax-Span-547" class="texatom"><span id="MathJax-Span-548" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-549" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-550" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-70" type="math/tex">G[0,\ldots, s-1][1,\ldots, |\Sigma|]</script> to <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-71-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-551" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.373em, 1001.22em, 2.41em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-552" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-553" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-554" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-71" type="math/tex">-1</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-72-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.774em; display: inline-block;" role="math" id="MathJax-Span-555" class="math"><span style="display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.29em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-556" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-557" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-558" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-559" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-560" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-561" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-562" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-563" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-72" type="math/tex">state \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <b>for each</b> key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-73-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-564" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.37em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-565" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-566" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-567" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-568" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-569" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-570" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-571" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-572" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-573" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-574" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-575" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-576" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-577" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-73" type="math/tex">K[1,2,\ldots,m_i]</script> in <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-74-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-578" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.273em, 1000.71em, 2.37em, -1000em); top: -2.163em; left: 0em;"><span id="MathJax-Span-579" class="mrow"><span id="MathJax-Span-580" class="texatom"><span id="MathJax-Span-581" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-582" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-74" type="math/tex">\mathcal{K}</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-75-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-583" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.334em, 1002.43em, 2.432em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-584" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-585" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-586" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-587" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-75" type="math/tex">\ell \leftarrow 0</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-76-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-588" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.4em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-589" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-590" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-591" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-592" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-76" type="math/tex">j \leftarrow 1</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-77-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.473em; display: inline-block;" role="math" id="MathJax-Span-593" class="math"><span style="display: inline-block; position: relative; width: 7.107em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-594" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-595" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-596" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-597" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-598" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-599" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-600" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-601" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-602" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-603" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-604" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-605" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-606" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-607" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-77" type="math/tex">G[\ell][K[j]] \not= -1</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-78-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.568em; display: inline-block;" role="math" id="MathJax-Span-608" class="math"><span style="display: inline-block; position: relative; width: 6.427em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.31em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-609" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-610" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-611" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-612" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-613" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-614" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-615" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-616" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-617" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-618" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-619" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-620" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-621" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-78" type="math/tex">\ell \leftarrow G[\ell][K[j]]</script>     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <i><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-79-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-622" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.471em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-623" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-624" class="mo">≪</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≪</mo></math></span></span><script id="MathJax-Element-79" type="math/tex">\ll</script> go to the next state in the Trie <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-80-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-625" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.472em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-626" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-627" class="mo">≫</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≫</mo></math></span></span><script id="MathJax-Element-80" type="math/tex">\gg</script></i><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-81-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-628" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.07em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-629" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-630" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-631" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-632" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-633" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-634" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-81" type="math/tex">j\leftarrow j+1</script><br>
   &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-82-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.966em; display: inline-block;" role="math" id="MathJax-Span-635" class="math"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1002.97em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-636" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-637" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-638" class="mo">≤</span><span style="padding-left: 0.278em;" id="MathJax-Span-639" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-640" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-641" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≤</mo><msub><mi>m</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-82" type="math/tex">j \leq m_i</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-83-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.459em; display: inline-block;" role="math" id="MathJax-Span-642" class="math"><span style="display: inline-block; position: relative; width: 7.848em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1007.78em, 2.554em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-643" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-644" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-645" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-646" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-647" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-648" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-649" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-650" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-651" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-652" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-653" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-654" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-655" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-656" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.191em; border-left: 0px solid; width: 0px; height: 1.159em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-83" type="math/tex">state \leftarrow state + 1</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-84-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.034em; display: inline-block;" role="math" id="MathJax-Span-657" class="math"><span style="display: inline-block; position: relative; width: 8.281em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.24em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-658" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-659" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-660" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-661" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-662" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-663" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-664" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-665" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-666" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-667" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-668" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-669" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-670" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-671" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-672" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-673" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-674" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></math></span></span><script id="MathJax-Element-84" type="math/tex">G[\ell][K[j]] \leftarrow state</script>      &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <i><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-85-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-675" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.471em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-676" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-677" class="mo">≪</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≪</mo></math></span></span><script id="MathJax-Element-85" type="math/tex">\ll</script> attach the new state to the Trie <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-86-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-678" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.472em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-679" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-680" class="mo">≫</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≫</mo></math></span></span><script id="MathJax-Element-86" type="math/tex">\gg</script></i><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-87-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-681" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.07em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-682" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-683" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-684" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-685" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-686" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-687" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-87" type="math/tex">j \leftarrow j+1</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-88-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.692em; display: inline-block;" role="math" id="MathJax-Span-688" class="math"><span style="display: inline-block; position: relative; width: 4.264em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1004.23em, 2.492em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-689" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-690" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-691" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-692" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-693" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-694" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-695" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-696" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.109em; border-left: 0px solid; width: 0px; height: 1.129em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></math></span></span><script id="MathJax-Element-88" type="math/tex">\ell \leftarrow state</script><br>
    &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; annotate node <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-89-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-697" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.334em, 1000.41em, 2.43em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-698" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-699" class="mi">ℓ</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.109em; border-left: 0px solid; width: 0px; height: 1.129em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi></math></span></span><script id="MathJax-Element-89" type="math/tex">\ell</script> with key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-90-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.336em; display: inline-block;" role="math" id="MathJax-Span-700" class="math"><span style="display: inline-block; position: relative; width: 5.5em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.38em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-701" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-702" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-703" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-704" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-705" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-706" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-707" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-708" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-709" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-710" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-711" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-90" type="math/tex">K[1,\ldots,m_i]</script><br>
    &nbsp;&nbsp;&nbsp;  return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-91-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 14.897em; display: inline-block;" role="math" id="MathJax-Span-712" class="math"><span style="display: inline-block; position: relative; width: 11.185em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1011.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-713" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-714" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-715" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-716" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-717" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-718" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-719" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-720" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-721" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-722" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-723" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-724" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-725" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-726" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-727" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-728" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-729" class="texatom"><span id="MathJax-Span-730" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-731" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-732" class="mi">Σ</span><span id="MathJax-Span-733" class="texatom"><span id="MathJax-Span-734" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-735" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-736" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-91" type="math/tex">G[0,\ldots,s-1][1,\ldots, |\Sigma|]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_83657" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// Construct the Trie and stores its structure in a 2D array</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the set of keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keywords in Keys</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// num_state:&nbsp;&nbsp; the number of states in the finite state machine, this parameter need not to be exact</code></div><div class="line number5 index4 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; any upper bound of this parameter is ok</code></div><div class="line number6 index5 alt1"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">**construct_trie(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_state, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(num_state*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">*));</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; i &lt; num_state; i++){</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G[i] = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(alpb*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">)); </code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memset</code><code class="cpp plain">(G[i],-1, alpb*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">));</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">state&nbsp; = 0;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 1;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 0; i &lt; num_keys; i++){</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">klen = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(Keys[i])-1; </code><code class="cpp comments">// -1 since each string is added a space char at the beginning</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">ell = 0;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = 1;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(G[ell][id(Keys[i][j])] != -1){</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ell = G[ell][id(Keys[i][j])];</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j ++;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(j &lt;= klen){</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">state++;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G[ell][id(Keys[i][j])] = state;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j++;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ell = state;</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"key '"</code><code class="cpp plain">);</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">print_char_arr(Keys[i]);</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"' is added to state %d\n"</code><code class="cpp plain">,ell);</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">L[ell] = Keys[i]; </code><code class="cpp comments">// put the key to the state i</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">nstates = state+1;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the numer of state is %d\n"</code><code class="cpp plain">, nstates);</code></div><div class="line number39 index38 alt2"><code class="cpp comments">// print out the trie</code></div><div class="line number40 index39 alt1"><code class="cpp comments">//&nbsp; for(i = 0; i &lt; nstates; i++){</code></div><div class="line number41 index40 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(j = 0; j &lt; alpb; j++){</code></div><div class="line number42 index41 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d ", G[i][j]);</code></div><div class="line number43 index42 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</code></div><div class="line number44 index43 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\n");</code></div><div class="line number45 index44 alt2"><code class="cpp comments">//&nbsp; }</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">G;</code></div><div class="line number47 index46 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Sau khi đã xây dựng cây Trie, ta phải xây dựng các cạnh không khớp. 
Để biểu diễn cạnh không khớp của mỗi nút, ta sẽ sử dụng mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-92-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.801em; display: inline-block;" role="math" id="MathJax-Span-737" class="math"><span style="display: inline-block; position: relative; width: 7.354em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.23em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-738" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-739" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-740" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-741" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-742" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-743" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-744" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-745" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-746" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-747" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-748" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-749" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-750" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-92" type="math/tex">F[0,1,\ldots, s-1]</script> trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-93-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.705em; display: inline-block;" role="math" id="MathJax-Span-751" class="math"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.51em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-752" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-753" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-754" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-755" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-756" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-757" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-758" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi></math></span></span><script id="MathJax-Element-93" type="math/tex">F[i] = j</script> nếu có một cạnh không khớp từ nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-94-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-759" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-760" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-761" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-94" type="math/tex">i</script> đến nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-95-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-762" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-763" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-764" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-95" type="math/tex">j</script>. </p>
<p>Hiển nhiên sử dụng luật cạnh không khớp, ta có thể xây dựng mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-96-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-765" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-766" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-767" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-768" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-769" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-770" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-771" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-772" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-773" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-774" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-775" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-776" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-96" type="math/tex">F[0,\ldots, s-1]</script> trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-97-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-777" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1002.32em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-778" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-779" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-780" class="mo">(</span><span id="MathJax-Span-781" class="msubsup"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-782" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.469em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-783" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-784" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.606em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-97" type="math/tex">O(s^2)</script> bằng cách với mỗi nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-98-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-785" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-786" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-787" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-98" type="math/tex">i</script>, ta sẽ duyệt các nút có độ sâu nhỏ hơn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-99-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-788" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-789" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-790" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-99" type="math/tex">i</script> (sử dụng<a href="http://www.giaithuatlaptrinh.com/?p=553" target="_blank"> Bread First Search</a> -- BFS) và tìm ra nút thỏa mãn luật cạnh không khớp. Duyệt như vậy mất thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-100-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-791" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-792" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-793" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-794" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-795" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-796" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-100" type="math/tex">O(s)</script> cho mỗi cạnh không khớp, và do đó, tổng thơi gian là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-101-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-797" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1002.32em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-798" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-799" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-800" class="mo">(</span><span id="MathJax-Span-801" class="msubsup"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.42em, 4.212em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-802" class="mi">s</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.469em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-803" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-804" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.606em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-101" type="math/tex">O(s^2)</script>.</p>
<p>Tuy nhiên, sử dụng ý tưởng quy hoạch động trong xây dựng FSM ở <a href="http://www.giaithuatlaptrinh.com/?p=687" target="_blank">bài trước</a>, ta có thể xây dựng mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-102-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-805" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.25em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-806" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-807" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-808" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-809" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-810" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-811" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-812" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-813" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-814" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-815" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-816" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-102" type="math/tex">F[0,\ldots, s-1]</script> trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-103-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-817" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-818" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-819" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-820" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-821" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-822" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-103" type="math/tex">O(s)</script> như sau. Ta sẽ xây dựng cạnh không khớp cho các nút theo thứ tự tằng dần của chiều sâu (thứ tự BFS). Ban đầu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-104-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.021em; display: inline-block;" role="math" id="MathJax-Span-823" class="math"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.44em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-824" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-825" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-826" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-827" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-828" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-829" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-830" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-831" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-104" type="math/tex">F[0] = -1</script>. Giả sử ta đang xây dựng cạnh không khớp cho một nút  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-105-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-832" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-833" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-834" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-105" type="math/tex">i</script> ở chiều sâu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-106-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-835" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1000.49em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-836" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-837" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script id="MathJax-Element-106" type="math/tex">d</script>
 (chiều sâu của một nút là khoảng cách từ nút đó đến gốc của cây Trie), 
và ta đã xác định được cạnh không khớp cho các nút ở chiều sâu nhỏ hơn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-107-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-838" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.469em, 1000.49em, 2.544em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-839" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-840" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script id="MathJax-Element-107" type="math/tex">d</script>. Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-108-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-841" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.86em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-842" class="mrow"><span id="MathJax-Span-843" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-844" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-845" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>0</mn></msub></math></span></span><script id="MathJax-Element-108" type="math/tex">j_0</script> là nút cha của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-109-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-846" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-847" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-848" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-109" type="math/tex">i</script> trong cây Trie và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-110-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-849" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.74em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-850" class="mrow"><span id="MathJax-Span-851" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-852" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span id="MathJax-Span-853" class="texatom"><span id="MathJax-Span-854" class="mrow"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-855" class="mi">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 0.962em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script id="MathJax-Element-110" type="math/tex">c_{i}</script> là nhãn của cạnh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-111-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.719em; display: inline-block;" role="math" id="MathJax-Span-856" class="math"><span style="display: inline-block; position: relative; width: 2.781em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1002.74em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-857" class="mrow"><span id="MathJax-Span-858" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-859" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-860" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-861" class="mo">→</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-862" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>0</mn></msub><mo stretchy="false">→</mo><mi>i</mi></math></span></span><script id="MathJax-Element-111" type="math/tex">j_0 \rightarrow i</script> trong cây Trie. Xét nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-112-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.856em; display: inline-block;" role="math" id="MathJax-Span-863" class="math"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.27em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-864" class="mrow"><span id="MathJax-Span-865" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-866" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-867" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-868" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-869" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-870" class="mo">[</span><span id="MathJax-Span-871" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-872" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-873" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-874" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>1</mn></msub><mo>=</mo><mi>F</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>0</mn></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-112" type="math/tex">j_1 = F[j_0]</script> (giá trị này đã xác định theo giả thiết quy nạp vì <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-113-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-875" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.86em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-876" class="mrow"><span id="MathJax-Span-877" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-878" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-879" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>0</mn></msub></math></span></span><script id="MathJax-Element-113" type="math/tex">j_0</script> có chiều sâu nhỏ hơn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-114-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-880" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-881" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-882" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-114" type="math/tex">i</script>), nhãn của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-115-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-883" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.86em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-884" class="mrow"><span id="MathJax-Span-885" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-886" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-887" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>1</mn></msub></math></span></span><script id="MathJax-Element-115" type="math/tex">j_1</script> là hậu tố của nhãn của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-116-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.171em; display: inline-block;" role="math" id="MathJax-Span-888" class="math"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.86em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-889" class="mrow"><span id="MathJax-Span-890" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-891" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-892" class="mn">0</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>0</mn></msub></math></span></span><script id="MathJax-Element-116" type="math/tex">j_0</script>. Do đó, nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-117-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.404em; display: inline-block;" role="math" id="MathJax-Span-893" class="math"><span style="display: inline-block; position: relative; width: 6.303em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.23em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-894" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-895" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-896" class="mo">[</span><span id="MathJax-Span-897" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-898" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-899" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-900" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-901" class="mo">[</span><span id="MathJax-Span-902" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-903" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-904" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-905" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-906" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-907" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-908" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-117" type="math/tex">G[j_1][c_i] \not = -1</script>, thì ta chỉ việc gán <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-118-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.979em; display: inline-block;" role="math" id="MathJax-Span-909" class="math"><span style="display: inline-block; position: relative; width: 6.736em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.62em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-910" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-911" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-912" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-913" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-914" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-915" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-916" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-917" class="mo">[</span><span id="MathJax-Span-918" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-919" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-920" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-921" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-922" class="mo">[</span><span id="MathJax-Span-923" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-924" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-925" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-926" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>G</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-118" type="math/tex">F[i] = G[j_1][c_i]</script> do nhãn của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-119-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.87em; display: inline-block;" role="math" id="MathJax-Span-927" class="math"><span style="display: inline-block; position: relative; width: 3.646em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.53em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-928" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-929" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-930" class="mo">[</span><span id="MathJax-Span-931" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-932" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-933" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-934" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-935" class="mo">[</span><span id="MathJax-Span-936" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-937" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-938" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-939" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-119" type="math/tex">G[j_1][c_i]</script> là hậu tố của nhãn của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-120-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-940" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-941" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-942" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-120" type="math/tex">i</script> (hình (a)). Nếu không (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-121-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.404em; display: inline-block;" role="math" id="MathJax-Span-943" class="math"><span style="display: inline-block; position: relative; width: 6.303em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.23em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-944" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-945" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-946" class="mo">[</span><span id="MathJax-Span-947" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-948" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-949" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-950" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-951" class="mo">[</span><span id="MathJax-Span-952" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-953" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-954" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-955" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-956" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-957" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-958" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-121" type="math/tex">G[j_1][c_i] = -1</script>), ta tiếp tục xét nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-122-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.856em; display: inline-block;" role="math" id="MathJax-Span-959" class="math"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.27em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-960" class="mrow"><span id="MathJax-Span-961" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-962" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-963" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-964" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-965" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-966" class="mo">[</span><span id="MathJax-Span-967" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-968" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-969" class="mn">1</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-970" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>j</mi><mn>2</mn></msub><mo>=</mo><mi>F</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>1</mn></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-122" type="math/tex">j_2 = F[j_1]</script> và lặp lại tương tự, so sánh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-123-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.87em; display: inline-block;" role="math" id="MathJax-Span-971" class="math"><span style="display: inline-block; position: relative; width: 3.646em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.53em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-972" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-973" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-974" class="mo">[</span><span id="MathJax-Span-975" class="msubsup"><span style="display: inline-block; position: relative; width: 0.841em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.4em, 4.406em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-976" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.412em;"><span style="font-size: 70.7%; font-family: MathJax_Main;" id="MathJax-Span-977" class="mn">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-978" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-979" class="mo">[</span><span id="MathJax-Span-980" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-981" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-982" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-983" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><msub><mi>j</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-123" type="math/tex">G[j_2][c_i]</script> với <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-124-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-984" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1001.22em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-985" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-986" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-987" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-124" type="math/tex">-1</script> (hình (b)). Trường hợp xấu nhất ta sẽ trở lại nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-125-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-988" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-989" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-990" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-125" type="math/tex">0</script> và lúc này ta sẽ gán <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-126-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-991" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.54em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-992" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-993" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-994" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-995" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-996" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-997" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-998" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script id="MathJax-Element-126" type="math/tex">F[i] = 0</script>. </p>
<p><img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/failure-example.png" alt="failure-example" width="500" height="382"></p>
<p>Giả mã như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> ConstructFSM</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-127-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.541em; display: inline-block;" role="math" id="MathJax-Span-999" class="math"><span style="display: inline-block; position: relative; width: 12.421em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1012.3em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1000" class="mrow"><span id="MathJax-Span-1001" class="texatom"><span id="MathJax-Span-1002" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1003" class="mi">K</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1004" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1005" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1006" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1007" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1008" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1009" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1010" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1011" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1012" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1013" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1014" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1015" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1016" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1017" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1018" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1019" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1020" class="texatom"><span id="MathJax-Span-1021" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1022" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1023" class="mi">Σ</span><span id="MathJax-Span-1024" class="texatom"><span id="MathJax-Span-1025" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1026" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1027" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-127" type="math/tex">\mathcal{K}, G[0,\ldots,s-1][1,\ldots,|\Sigma|]</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-128-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1028" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1029" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1030" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1031" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-128" type="math/tex">s \leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-129-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.267em; display: inline-block;" role="math" id="MathJax-Span-1032" class="math"><span style="display: inline-block; position: relative; width: 4.697em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1033" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1034" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1035" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1036" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1037" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1038" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1039" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1040" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-129" type="math/tex">F[0] \leftarrow -1</script><br>
   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-130-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.39em; display: inline-block;" role="math" id="MathJax-Span-1041" class="math"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1002.46em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1042" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1043" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1044" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1045" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-130" type="math/tex">d \leftarrow 1</script> to max depth<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>for each</b> state <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-131-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1046" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1047" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1048" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-131" type="math/tex">i</script> at depth <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-132-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1049" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.49em, 2.482em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1050" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1051" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script id="MathJax-Element-132" type="math/tex">d</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-133-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-1052" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1001.67em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1053" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1054" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1055" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-133" type="math/tex">j \leftarrow</script> parent of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-134-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1056" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1057" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1058" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-134" type="math/tex">i</script> in the Trie<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-135-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.733em; display: inline-block;" role="math" id="MathJax-Span-1059" class="math"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.528em, 1001.98em, 2.568em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-1060" class="mrow"><span id="MathJax-Span-1061" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1062" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1063" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1064" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-135" type="math/tex">c_i \leftarrow</script>  the label of the edge <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-136-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-1065" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.99em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1066" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1067" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1068" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1069" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1070" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1071" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">←</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-136" type="math/tex">(j \leftarrow i)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-137-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1072" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1073" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1074" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1075" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1076" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1077" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1078" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1079" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-137" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>while <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-138-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.829em; display: inline-block;" role="math" id="MathJax-Span-1080" class="math"><span style="display: inline-block; position: relative; width: 5.871em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.8em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1081" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1082" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1083" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1084" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1085" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1086" class="mo">[</span><span id="MathJax-Span-1087" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1088" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1089" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1090" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1091" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1092" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1093" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-138" type="math/tex">G[j][c_i] = -1</script> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-139-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-1094" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.25em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1095" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1096" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1097" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1098" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-139" type="math/tex">j \geq 0</script></b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-140-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1099" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1100" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1101" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1102" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1103" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1104" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1105" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1106" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-140" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-141-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-1107" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1003.02em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1108" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1109" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1110" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1111" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1112" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-141" type="math/tex">j = -1</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-142-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1113" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.73em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1114" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1115" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1116" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1117" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1118" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1119" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1120" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-142" type="math/tex">F[i] \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-143-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-1121" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.37em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1122" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1123" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1124" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1125" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1126" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1127" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1128" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1129" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1130" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1131" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1132" class="mo">[</span><span id="MathJax-Span-1133" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1134" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1135" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1136" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-143" type="math/tex">F[i] \leftarrow G[j][c_i]</script><br>
   &nbsp;&nbsp;&nbsp;  return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-144-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-1137" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.25em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1138" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1139" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1140" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1141" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1142" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1143" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1144" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1145" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1146" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1147" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1148" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-144" type="math/tex">F[0,\ldots,s-1]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_452185" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// Construct the finite state machine for the set of keywords</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the set of keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// G:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the 2D array represents the Trie for the keyword set Keys</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet</code></div><div class="line number5 index4 alt2"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keys in the keyword set Keys</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">*construct_fsm(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*F;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(nstates*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">));</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[0] = -1;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">enqueue(0);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(is_empty() == 0){</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = dequeue();</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">c = 0;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; c &lt; alpb; c++){</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(G[j] != -1){</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// j is the parent of i</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">i = G[j];</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">k = F[j];</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(k &gt;= 0 &amp;&amp; G[k] == -1){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">k&nbsp; = F[k];</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(k == -1){</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[i] = 0;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code><code class="cpp plain">{</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[i] = G[k];</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">enqueue(i);</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp comments">// end while</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the failure array: \n"</code><code class="cpp plain">);</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 0; i &lt; nstates; i++){</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d "</code><code class="cpp plain">, F[i]);</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\n"</code><code class="cpp plain">);</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">F;</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Từ các thảo luận ở trên, ta có:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 1: </b></a> Ta có thể xây dựng máy trạng thái hữu hạn cho tập từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-145-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1149" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1150" class="mrow"><span id="MathJax-Span-1151" class="texatom"><span id="MathJax-Span-1152" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1153" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-145" type="math/tex">\mathcal{K}</script> trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-146-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.377em; display: inline-block;" role="math" id="MathJax-Span-1154" class="math"><span style="display: inline-block; position: relative; width: 3.275em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.18em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1155" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1156" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1157" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1158" class="mi">Σ</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1159" class="mi">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1160" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Σ</mi><mi>M</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-146" type="math/tex">O(\Sigma M)</script>.
</div>
<p>&nbsp;</p>
<p><strong> <font size="4">Tìm kiếm với các từ khóa độc lập</font></strong></p>
<p>Giả sử trong tập từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-147-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.253em; display: inline-block;" role="math" id="MathJax-Span-1161" class="math"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.93em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1162" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1163" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script id="MathJax-Element-147" type="math/tex">K</script>, không có hai từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-148-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1164" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1002.84em, 2.766em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1165" class="mrow"><span id="MathJax-Span-1166" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1167" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1168" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1169" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1170" class="msubsup"><span style="display: inline-block; position: relative; width: 1.215em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1171" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1172" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.464em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub><mo>,</mo><msub><mi>K</mi><mi>j</mi></msub></math></span></span><script id="MathJax-Element-148" type="math/tex">K_i, K_j</script> nào sao cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-149-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-1173" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1174" class="mrow"><span id="MathJax-Span-1175" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1176" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1177" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-149" type="math/tex">K_i</script> là xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-150-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-1178" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.24em, 2.766em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1179" class="mrow"><span id="MathJax-Span-1180" class="msubsup"><span style="display: inline-block; position: relative; width: 1.215em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1181" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1182" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.464em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>j</mi></msub></math></span></span><script id="MathJax-Element-150" type="math/tex">K_j</script>. Ta gọi bộ từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-151-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1183" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1184" class="mrow"><span id="MathJax-Span-1185" class="texatom"><span id="MathJax-Span-1186" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1187" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-151" type="math/tex">\mathcal{K}</script> là bộ <em>từ khóa độc lập</em>. Bộ từ khóa trong ví dụ trên là không độc lập vì từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-152-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-1188" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1189" class="mrow"><span id="MathJax-Span-1190" class="texatom"><span id="MathJax-Span-1191" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1192" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1193" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-152" type="math/tex">\mathrm{he}</script> là xâu con của từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-153-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.829em; display: inline-block;" role="math" id="MathJax-Span-1194" class="math"><span style="display: inline-block; position: relative; width: 1.36em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1001.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1195" class="mrow"><span id="MathJax-Span-1196" class="texatom"><span id="MathJax-Span-1197" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1198" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1199" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1200" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-153" type="math/tex">\mathrm{she}</script>.<br>
Ta có định lý sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="prob-1"><b> Lemma 2: </b></a> Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-154-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1201" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1202" class="mrow"><span id="MathJax-Span-1203" class="texatom"><span id="MathJax-Span-1204" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1205" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-154" type="math/tex">\mathcal{K}</script> là độc lập thì mỗi nút lá của cây Trie sẽ tương ứng với một từ khóa và ngược lại.
</div>
<p>&nbsp;</p>
<p>Ta có thể dễ dàng chứng minh định lý trên bằng phản chứng (và coi như
 bài tập cho bạn đọc). Định lý trên cho phép chúng ta tìm kiếm trong văn
 bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-155-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1206" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1207" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1208" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-155" type="math/tex">T</script> giống như thuật toán KMP. Ta sẽ sử dụng FSM để tìm kiếm trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-156-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1209" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1210" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1211" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-156" type="math/tex">T</script> như sau. Mỗi bước của thuật toán ta xét một kí tự và một trạng thái của máy FSM. Ban đầu ta xét kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-157-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1212" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.67em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1213" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1214" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1215" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1216" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1217" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-157" type="math/tex">T[0]</script> và trạng thái (nút) <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-158-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1218" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.45em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1219" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1220" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script id="MathJax-Element-158" type="math/tex">0</script> của máy FSM. Gọi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-159-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1221" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1222" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1223" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1224" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1225" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1226" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-159" type="math/tex">T[i]</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-160-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1227" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1228" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1229" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-160" type="math/tex">x</script> lần lượt là kí tự hiện tại ta đang xét của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-161-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1230" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1231" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1232" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-161" type="math/tex">T</script> và trạng thái hiện tại ta đang xét của FSM.  </p>
<ol>
<li>Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-162-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1233" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1234" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1235" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-162" type="math/tex">x</script> là một nút lá của cây Trie, ta sẽ in ra từ khóa tương ứng với nút lá đó và nhảy sang trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-163-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1236" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.65em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1237" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1238" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1239" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1240" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1241" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1242" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1243" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>F</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-163" type="math/tex">y = F[x]</script> và tiếp tục xét <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-164-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1244" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1245" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1246" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1247" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1248" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1249" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-164" type="math/tex">T[i]</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-165-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1250" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.49em, 2.739em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1251" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1252" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.355em; border-left: 0px solid; width: 0px; height: 1.025em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script id="MathJax-Element-165" type="math/tex">y</script> trong bước tiếp theo.</li>
<li>Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-166-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1253" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1254" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1255" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-166" type="math/tex">x</script> không phải là nút lá, có hai trường hợp xảy ra:
<ol>
<li> Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-167-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.226em; display: inline-block;" role="math" id="MathJax-Span-1256" class="math"><span style="display: inline-block; position: relative; width: 6.921em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.85em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1257" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1258" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1259" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1260" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1261" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1262" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1263" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1264" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1265" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1266" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1267" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1268" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1269" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1270" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-167" type="math/tex">G[x][T[i]] \not = -1</script>, hay có một cạnh trong cây trie với nút cha <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-168-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.76em; display: inline-block;" role="math" id="MathJax-Span-1271" class="math"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.51em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1272" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1273" class="mi">x</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script id="MathJax-Element-168" type="math/tex">x</script> có nhãn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-169-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1274" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1275" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1276" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1277" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1278" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1279" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-169" type="math/tex">T[i]</script>, ta sẽ đi theo cạnh đó và xét trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-170-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.692em; display: inline-block;" role="math" id="MathJax-Span-1280" class="math"><span style="display: inline-block; position: relative; width: 4.264em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.15em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1281" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1282" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1283" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1284" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1285" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1286" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1287" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1288" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1289" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1290" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1291" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-170" type="math/tex">G[x][T[i]]</script> và kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-171-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.541em; display: inline-block;" role="math" id="MathJax-Span-1292" class="math"><span style="display: inline-block; position: relative; width: 3.399em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.28em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1293" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1294" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1295" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1296" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1297" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1298" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1299" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-171" type="math/tex">T[i+1]</script> trong bước tiếp theo.</li>
<li>Nếu <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-172-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.226em; display: inline-block;" role="math" id="MathJax-Span-1300" class="math"><span style="display: inline-block; position: relative; width: 6.921em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.85em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1301" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1302" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1303" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1304" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1305" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1306" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1307" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1308" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1309" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1310" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1311" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1312" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1313" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1314" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-172" type="math/tex">G[x][T[i]] = -1</script>, ta sẽ xét <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-173-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1315" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.65em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1316" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1317" class="mi">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1318" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1319" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1320" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1321" class="mi">x</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1322" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>F</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-173" type="math/tex">y = F[x]</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-174-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1323" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1324" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1325" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1326" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1327" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1328" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-174" type="math/tex">T[i]</script> trong bước tiếp theo.</li>
</ol>
</li>
</ol>
<p>Giả mã của thuật toán như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> IndependentSearch</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-175-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-1329" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.83em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1330" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1331" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1332" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1333" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1334" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1335" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1336" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1337" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1338" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1339" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1340" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1341" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1342" class="texatom"><span id="MathJax-Span-1343" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1344" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-175" type="math/tex">T[1,2,\ldots,n], \mathcal{K}</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-176-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1345" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1346" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1347" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1348" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-176" type="math/tex">s \leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-177-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.623em; display: inline-block;" role="math" id="MathJax-Span-1349" class="math"><span style="display: inline-block; position: relative; width: 12.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1012.43em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1350" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1351" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1352" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1353" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1354" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1355" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1356" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1357" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1358" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1359" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1360" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1361" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1362" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1363" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1364" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1365" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1366" class="texatom"><span id="MathJax-Span-1367" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1368" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1369" class="mi">Σ</span><span id="MathJax-Span-1370" class="texatom"><span id="MathJax-Span-1371" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1372" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1373" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1374" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-177" type="math/tex">G[0,\ldots,s-1][1,\ldots, |\Sigma|] \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> ConstructTrie</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-178-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1375" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.273em, 1000.71em, 2.37em, -1000em); top: -2.163em; left: 0em;"><span id="MathJax-Span-1376" class="mrow"><span id="MathJax-Span-1377" class="texatom"><span id="MathJax-Span-1378" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1379" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-178" type="math/tex">\mathcal{K}</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-179-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.212em; display: inline-block;" role="math" id="MathJax-Span-1380" class="math"><span style="display: inline-block; position: relative; width: 7.663em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.61em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1381" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1382" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1383" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1384" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1385" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1386" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1387" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1388" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1389" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1390" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1391" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1392" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-179" type="math/tex">F[0,\ldots,s-1]\leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> ConstructFSM</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-180-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.541em; display: inline-block;" role="math" id="MathJax-Span-1393" class="math"><span style="display: inline-block; position: relative; width: 12.421em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1012.3em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1394" class="mrow"><span id="MathJax-Span-1395" class="texatom"><span id="MathJax-Span-1396" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1397" class="mi">K</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1398" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1399" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1400" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1401" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1402" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1403" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1404" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1405" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1406" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1407" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1408" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1409" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1410" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1411" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1412" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1413" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1414" class="texatom"><span id="MathJax-Span-1415" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1416" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1417" class="mi">Σ</span><span id="MathJax-Span-1418" class="texatom"><span id="MathJax-Span-1419" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1420" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1421" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-180" type="math/tex">\mathcal{K},G[0,\ldots,s-1][1,\ldots, |\Sigma|] </script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-181-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-1422" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.43em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1423" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1424" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1425" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1426" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-181" type="math/tex">j \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-182-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1427" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.34em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1428" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1429" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1430" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1431" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-182" type="math/tex">i \leftarrow 1</script> to <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-183-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1432" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.6em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1433" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1434" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-183" type="math/tex">n</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; while <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-184-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1435" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.72em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1436" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1437" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1438" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1439" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1440" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1441" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1442" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1443" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1444" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1445" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1446" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1447" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1448" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1449" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-184" type="math/tex">G[j][T[i]] = -1</script> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-185-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-1450" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.25em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1451" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1452" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1453" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1454" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-185" type="math/tex">j \geq 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-186-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1455" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1456" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1457" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1458" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1459" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1460" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1461" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1462" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-186" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-187-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-1463" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1003.02em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1464" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1465" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1466" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1467" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1468" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-187" type="math/tex">j = -1</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-188-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-1469" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.43em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1470" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1471" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1472" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1473" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-188" type="math/tex">j \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-189-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-1474" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1475" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1476" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1477" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1478" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1479" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1480" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1481" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1482" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1483" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1484" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1485" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1486" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1487" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-189" type="math/tex">j \leftarrow G[j][T[i]]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-190-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1488" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.42em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1489" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1490" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-190" type="math/tex">j</script> is a leaf<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; print the keyword of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-191-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1491" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.42em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1492" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1493" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-191" type="math/tex">j</script> and its position in <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-192-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1494" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1000.68em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1495" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1496" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-192" type="math/tex">T</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-193-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-1497" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1498" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1499" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1500" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1501" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1502" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1503" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1504" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-193" type="math/tex">j \leftarrow F[j]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_143471" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// search keywords in array Keys in the text T</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the 2D char array holding keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// T:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the pointer to the text array</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// num_states:&nbsp; the number of states in the finite state machine, </code></div><div class="line number5 index4 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this parameter need not to be exact, you can input the maximum number of states</code></div><div class="line number6 index5 alt1"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keys in the keyword set</code></div><div class="line number7 index6 alt2"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet. </code></div><div class="line number8 index7 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">independent_search(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*T, </code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_states, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G = construct_trie(Keys, num_keys, num_states, alpb);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*F = construct_fsm(Keys,G, alpb, num_keys);</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 1;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">n = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(T) - 1; </code><code class="cpp comments">// characters in T are indexed from 1</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; i &lt;= n; i++){</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(j &gt;= 0 &amp;&amp; G[j][id(T[i])] == -1){</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = F[j];</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(j == -1) j = 0;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = G[j][id(T[i])];</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(is_leaf(j, G, alpb)){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the keyword found at state %d is: "</code><code class="cpp plain">, j);</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">print_char_arr(L[j]);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\n"</code><code class="cpp plain">);</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">keylen = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(L[j])-1; </code><code class="cpp comments">// ignore the first empty character</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"this keywords is at pos %d of the text\n"</code><code class="cpp plain">, i -keylen + 1);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = F[j];</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2"><code class="cpp plain">}</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="cpp comments">// check whether a state is a leaf of the Trie</code></div><div class="line number34 index33 alt1"><code class="cpp comments">// x:&nbsp;&nbsp; the state </code></div><div class="line number35 index34 alt2"><code class="cpp comments">// G:&nbsp;&nbsp; the Trie</code></div><div class="line number36 index35 alt1"><code class="cpp comments">// alpb:the size of the alphabet</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">is_leaf(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; j &lt; alpb; j++){</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(G[x][j] != -1){</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">1;</code></div><div class="line number46 index45 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><b>Phân tích thuật toán:</b> Bên cạnh thời gian để xây dưng FSM, thời gian chạy của thuật toán tỉ lệ với phép so sánh bằng (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-194-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1505" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.72em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1506" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1507" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1508" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1509" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1510" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1511" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1512" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1513" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1514" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1515" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1516" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1517" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1518" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1519" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-194" type="math/tex">G[j][T[i]] = -1</script>) cộng với số phép so sánh không bằng  (<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-195-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1520" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.72em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1521" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1522" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1523" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1524" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1525" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1526" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1527" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1528" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1529" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1530" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1531" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1532" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1533" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1534" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-195" type="math/tex">G[j][T[i]] \not= -1</script>) cộng với số lần từ khóa xuất hiện trong văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-196-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1535" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1536" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1537" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-196" type="math/tex">T</script> (mỗi khi <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-197-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1538" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1539" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1540" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-197" type="math/tex">j</script> là nút lá). Số lần xuất hiện trong văn bản được cố định là <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-198-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1541" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.74em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1542" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1543" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi></math></span></span><script id="MathJax-Element-198" type="math/tex">Z</script>, do đó ta không cần phân tích thêm nữa về đại lượng này. Mỗi lần <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-199-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1544" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.72em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1545" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1546" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1547" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1548" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1549" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1550" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1551" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1552" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1553" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1554" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1555" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1556" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1557" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1558" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-199" type="math/tex">G[j][T[i]] \not= -1</script>, ta sẽ tăng biển <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-200-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1559" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1560" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1561" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-200" type="math/tex">i</script> lên <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-201-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1562" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.42em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1563" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1564" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script id="MathJax-Element-201" type="math/tex">1</script> đơn vị và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-202-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1565" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1566" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1567" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-202" type="math/tex">j</script> sẽ được tăng lên trạng thái ở độ sâu cao hơn. Do đó, có tối đa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-203-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.61em; display: inline-block;" role="math" id="MathJax-Span-1568" class="math"><span style="display: inline-block; position: relative; width: 4.202em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1004.11em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1569" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1570" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1571" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1572" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1573" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1574" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1575" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-203" type="math/tex">O(n + m)</script> phép so sánh bằng.  Mỗi lần so sánh bằng, <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-204-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1576" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1577" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1578" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-204" type="math/tex">i</script> giữ nguyên còn <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-205-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1579" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1580" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1581" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-205" type="math/tex">j</script> sẽ được giảm về trạng thái ở độ sâu thấp hơn. Do số lần giảm độ sâu của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-206-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1582" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1583" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1584" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-206" type="math/tex">j</script> không thể vượt quá số lần tăng độ sâu của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-207-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1585" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1586" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1587" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-207" type="math/tex">j</script>,
 do đó, số phép so sánh bằng không thể vượt quá số phép so sánh không 
bằng. Như vậy, thời gian của thuật toán bằng thời gian để xây dưng FSM +
 <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-208-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.24em; display: inline-block;" role="math" id="MathJax-Span-1588" class="math"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.09em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1589" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1590" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1591" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1592" class="mi">m</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1593" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1594" class="mi">n</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1595" class="mo">+</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-1596" class="mi">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1597" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo>+</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-208" type="math/tex">O(m+n + Z)</script>. Kết hợp với Lemma 1, ta suy ra Theorem 1 trong trường hợp bộ từ khóa độc lập.</p>
<p><strong><font size="4">Tìm kiếm với bộ từ khóa bất kì</font></strong></p>
<p>Nếu bộ từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-209-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1598" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1599" class="mrow"><span id="MathJax-Span-1600" class="texatom"><span id="MathJax-Span-1601" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1602" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-209" type="math/tex">\mathcal{K}</script> có hai từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-210-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.801em; display: inline-block;" role="math" id="MathJax-Span-1603" class="math"><span style="display: inline-block; position: relative; width: 2.843em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1002.84em, 2.766em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1604" class="mrow"><span id="MathJax-Span-1605" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1606" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1607" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1608" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1609" class="msubsup"><span style="display: inline-block; position: relative; width: 1.215em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1610" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1611" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.464em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub><mo>,</mo><msub><mi>K</mi><mi>j</mi></msub></math></span></span><script id="MathJax-Element-210" type="math/tex">K_i,K_j</script> sao cho <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-211-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.582em; display: inline-block;" role="math" id="MathJax-Span-1612" class="math"><span style="display: inline-block; position: relative; width: 1.174em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.17em, 2.63em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1613" class="mrow"><span id="MathJax-Span-1614" class="msubsup"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1615" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1616" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.283em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-211" type="math/tex">K_i</script> là xâu con của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-212-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.664em; display: inline-block;" role="math" id="MathJax-Span-1617" class="math"><span style="display: inline-block; position: relative; width: 1.236em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.418em, 1001.24em, 2.766em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1618" class="mrow"><span id="MathJax-Span-1619" class="msubsup"><span style="display: inline-block; position: relative; width: 1.215em; height: 0px;"><span style="position: absolute; clip: rect(3.148em, 1000.89em, 4.202em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1620" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.849em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1621" class="mi">j</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.474em; border-left: 0px solid; width: 0px; height: 1.464em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>j</mi></msub></math></span></span><script id="MathJax-Element-212" type="math/tex">K_j</script> thì việc tìm kiếm sẽ trở nên khó khăn hơn nhiều. Ví dụ bộ từ khóa gồm 3 từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-213-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.13em; display: inline-block;" role="math" id="MathJax-Span-1622" class="math"><span style="display: inline-block; position: relative; width: 12.112em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1012.05em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1623" class="mrow"><span id="MathJax-Span-1624" class="texatom"><span id="MathJax-Span-1625" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1626" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1627" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1628" class="mo">{</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1629" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1630" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1631" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1632" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1633" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1634" class="mi">e</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1635" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1636" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1637" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1638" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1639" class="mi">e</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1640" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1641" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1642" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1643" class="mi">m</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1644" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1645" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1646" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>h</mi><mi>e</mi><mo>,</mo><mi>s</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>d</mi><mo>,</mo><mi>h</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>s</mi><mi>m</mi><mi>a</mi><mi>n</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-213" type="math/tex">\mathcal{K} = \{he, sherd, herdsman\}</script> và văn bản <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-214-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.911em; display: inline-block;" role="math" id="MathJax-Span-1647" class="math"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1010.43em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1648" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1649" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1650" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1651" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1652" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1653" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1654" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1655" class="mn">5</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1656" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1657" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1658" class="texatom"><span id="MathJax-Span-1659" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1660" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1661" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1662" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1663" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1664" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1665" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1666" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1667" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1668" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>5</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-214" type="math/tex">T[1,\ldots,5] = \mathrm{sherdsman}</script>. Khi tìm kiếm theo thuật toán với khóa độc lập, ta sẽ tìm thấy khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-215-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-1669" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1002.27em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1670" class="mrow"><span id="MathJax-Span-1671" class="texatom"><span id="MathJax-Span-1672" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1673" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1674" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1675" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1676" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1677" class="mi">d</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></mrow></math></span></span><script id="MathJax-Element-215" type="math/tex">\mathrm{sherd}</script> đầu tiền, sau đó đi theo cạnh không khớp và tiếp tục tìm được từ khóa <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-216-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-1678" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1004.13em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1679" class="mrow"><span id="MathJax-Span-1680" class="texatom"><span id="MathJax-Span-1681" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1682" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1683" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1684" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1685" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1686" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1687" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1688" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1689" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-216" type="math/tex">\mathrm{herdsman}</script>. Mặc dù <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-217-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-1690" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1691" class="mrow"><span id="MathJax-Span-1692" class="texatom"><span id="MathJax-Span-1693" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1694" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1695" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-217" type="math/tex">\mathrm{he}</script> có trong văn bản nhưng ta sẽ không tìm ra nó. trong hình dưới đây, mình lược bỏ một số cạnh không khớp để hình nhìn đỡ rối hơn.<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/search-example.png" alt="search-ex" width="500" height="173"></p>
<p>Nếu làm theo từng bước của thuật toán trên, khi ta so sánh kí tự <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-218-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.87em; display: inline-block;" role="math" id="MathJax-Span-1696" class="math"><span style="display: inline-block; position: relative; width: 3.646em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.61em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1697" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1698" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1699" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1700" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1701" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1702" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1703" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo><mo>=</mo><mi>e</mi></math></span></span><script id="MathJax-Element-218" type="math/tex">T[3] = e</script> với trạng thái 5 của FSM, ta nên đi tới cạnh không khớp để tìm ra từ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-219-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-1704" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1705" class="mrow"><span id="MathJax-Span-1706" class="texatom"><span id="MathJax-Span-1707" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1708" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1709" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-219" type="math/tex">\mathrm{he}</script> và sau đó tiếp tuc so sánh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-220-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-1710" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1003.56em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1711" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1712" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1713" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1714" class="mn">4</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1715" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1716" class="mo">=</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-1717" class="mi">r</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>4</mn><mo stretchy="false">]</mo><mo>=</mo><mi>r</mi></math></span></span><script id="MathJax-Element-220" type="math/tex">T[4] = r</script>
 với trạng thái 6 của FSM. Tuy nhiên, làm như vậy thì mỗi lần so kí tự, 
ta lại phải kiểm tra (bằng cách đi theo cạnh không khớp) xem có từ khóa 
nào xuất hiện trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-221-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1718" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.486em, 1000.68em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1719" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1720" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-221" type="math/tex">T</script> hay không. Đó là chưa kể, nếu đi theo cạnh không khớp của nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-222-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-1721" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.42em, 2.738em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1722" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1723" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-222" type="math/tex">j</script> tới nút <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-223-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1724" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.67em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1725" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1726" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1727" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1728" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1729" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-223" type="math/tex">F[j]</script>, ta phải tiếp tục đi theo <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-224-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-1730" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1002.97em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1731" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1732" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1733" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1734" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1735" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1736" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1737" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1738" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-224" type="math/tex">F[F[j]]</script>. Ví dụ với bộ <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-225-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 17.363em; display: inline-block;" role="math" id="MathJax-Span-1739" class="math"><span style="display: inline-block; position: relative; width: 13.039em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1012.97em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1740" class="mrow"><span id="MathJax-Span-1741" class="texatom"><span id="MathJax-Span-1742" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1743" class="mi">K</span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1744" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1745" class="mo">{</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1746" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1747" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1748" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1749" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1750" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1751" class="mi">e</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1752" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1753" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1754" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1755" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1756" class="mi">e</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1757" class="mi">r</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1758" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1759" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1760" class="mi">m</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1761" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1762" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1763" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1764" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1765" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>h</mi><mi>e</mi><mo>,</mo><mi>s</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>d</mi><mo>,</mo><mi>h</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>s</mi><mi>m</mi><mi>a</mi><mi>n</mi><mo>,</mo><mi>e</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-225" type="math/tex">\mathcal{K} = \{he, sherd, herdsman,e\}</script> và <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-226-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.911em; display: inline-block;" role="math" id="MathJax-Span-1766" class="math"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1010.43em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1767" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1768" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1769" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1770" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1771" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1772" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1773" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1774" class="mn">5</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1775" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1776" class="mo">=</span><span style="padding-left: 0.278em;" id="MathJax-Span-1777" class="texatom"><span id="MathJax-Span-1778" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1779" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1780" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1781" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1782" class="mi">r</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1783" class="mi">d</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1784" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1785" class="mi">m</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1786" class="mi">a</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1787" class="mi">n</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>5</mn><mo stretchy="false">]</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi></mrow></math></span></span><script id="MathJax-Element-226" type="math/tex">T[1,\ldots,5] = \mathrm{sherdsman}</script>,<br>
<img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/searc-ex-ex.png" alt="searc-ex-2" width="500" height="193"><br>
Khi ta so sánh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-227-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1788" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.67em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1789" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1790" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1791" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1792" class="mn">3</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1793" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-227" type="math/tex">T[3]</script> với trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-228-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1794" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1795" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1796" class="mn">5</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script id="MathJax-Element-228" type="math/tex">5</script>, ta phải đi theo cạnh không khớp tới trạng thái 2 để in ra <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-229-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-1797" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.96em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1798" class="mrow"><span id="MathJax-Span-1799" class="texatom"><span id="MathJax-Span-1800" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1801" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1802" class="mi">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow></math></span></span><script id="MathJax-Element-229" type="math/tex">\mathrm{he}</script> và sau đó tiếp tục đi theo cạnh không khớp của 2 đi tới 14 để in ra <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-230-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1803" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.721em, 1000.46em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1804" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1805" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></span></span><script id="MathJax-Element-230" type="math/tex">e</script>, và sau đó mới tiếp tục so sánh <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-231-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1806" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.67em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1807" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1808" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1809" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1810" class="mn">4</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1811" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>4</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-231" type="math/tex">T[4]</script> và trạng thái 6. </p>
<p>Để giải quyết vấn đề này, ta sẽ dùng một mảng <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-232-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.308em; display: inline-block;" role="math" id="MathJax-Span-1812" class="math"><span style="display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.86em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1813" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1814" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1815" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1816" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1817" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1818" class="mn">2</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1819" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1820" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1821" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1822" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1823" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1824" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-232" type="math/tex">L[1,2\ldots,s-1]</script> trong đó <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-233-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1825" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1826" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1827" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1828" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1829" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1830" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-233" type="math/tex">L[i]</script> là một tập các từ khóa sao cho mỗi từ khóa trong <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-234-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.24em; display: inline-block;" role="math" id="MathJax-Span-1831" class="math"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.55em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1832" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1833" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1834" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1835" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1836" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-234" type="math/tex">L[i]</script> là hậu tố của nhãn đường đi của trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-235-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-1837" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.502em, 1000.33em, 2.545em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1838" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1839" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-235" type="math/tex">i</script>. Ví dụ trạng thái <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-236-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1840" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1841" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1842" class="mn">5</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script id="MathJax-Element-236" type="math/tex">5</script> sẽ có <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-237-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.24em; display: inline-block;" role="math" id="MathJax-Span-1843" class="math"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.11em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1844" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1845" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1846" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1847" class="mn">5</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1848" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1849" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1850" class="mo">{</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1851" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1852" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1853" class="mi">h</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1854" class="mi">e</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1855" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mn>5</mn><mo stretchy="false">]</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>e</mi><mo>,</mo><mi>h</mi><mi>e</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-237" type="math/tex">L[5] = \{e,he\}</script> vì cả hai từ khóa này đều là hậu tố của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-238-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.144em; display: inline-block;" role="math" id="MathJax-Span-1856" class="math"><span style="display: inline-block; position: relative; width: 2.348em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.28em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1857" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1858" class="mo">{</span><span id="MathJax-Span-1859" class="texatom"><span id="MathJax-Span-1860" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1861" class="mi">s</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1862" class="mi">h</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1863" class="mi">e</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1864" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi></mrow><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-238" type="math/tex">\{\mathrm{she}\}</script> (là nhãn đường đi của <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-239-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-1865" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1000.44em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1866" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1867" class="mn">5</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script id="MathJax-Element-239" type="math/tex">5</script>). Trong hình dưới đây, các từ khóa tương ứng với các nút là danh sách <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-240-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1868" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.65em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1869" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1870" class="mi">L</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script id="MathJax-Element-240" type="math/tex">L</script> của nút đó. Các nút không có gì là các nút có danh sách <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-241-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-1871" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.48em, 1000.65em, 2.534em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1872" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1873" class="mi">L</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script id="MathJax-Element-241" type="math/tex">L</script> rỗng.</p>
<p><img src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/out-func-ex.png" alt="out-func-example" width="500" height="220"></p>
<p>Giả sử ta đã tính được <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-242-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.719em; display: inline-block;" role="math" id="MathJax-Span-1874" class="math"><span style="display: inline-block; position: relative; width: 7.292em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.17em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1875" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1876" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1877" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1878" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1879" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1880" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1881" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1882" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1883" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1884" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1885" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1886" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1887" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-242" type="math/tex">L[1,2,\ldots,s-1]</script> ta chỉ cần thay đổi một chút thủ tục tìm kiếm với bộ từ khóa độc lập ở trên như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> MultiPatternSearch</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-243-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.144em; display: inline-block;" role="math" id="MathJax-Span-1888" class="math"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1006.83em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-1889" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1890" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1891" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1892" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1893" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1894" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1895" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1896" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1897" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1898" class="mi">n</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1899" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1900" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1901" class="texatom"><span id="MathJax-Span-1902" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1903" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-243" type="math/tex">T[1,2,\ldots,n], \mathcal{K}</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-244-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-1904" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1905" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1906" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1907" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-244" type="math/tex">s \leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; <font color="red"><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-245-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.623em; display: inline-block;" role="math" id="MathJax-Span-1908" class="math"><span style="display: inline-block; position: relative; width: 12.483em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1012.43em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1909" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1910" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1911" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1912" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1913" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1914" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1915" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1916" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1917" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1918" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1919" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1920" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1921" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1922" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1923" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1924" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1925" class="texatom"><span id="MathJax-Span-1926" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1927" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1928" class="mi">Σ</span><span id="MathJax-Span-1929" class="texatom"><span id="MathJax-Span-1930" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1931" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1932" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1933" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-245" type="math/tex">G[0,\ldots,s-1][1,\ldots, |\Sigma|] \leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> ConstructTrieAndL</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-246-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-1934" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.273em, 1000.71em, 2.37em, -1000em); top: -2.163em; left: 0em;"><span id="MathJax-Span-1935" class="mrow"><span id="MathJax-Span-1936" class="texatom"><span id="MathJax-Span-1937" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1938" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-246" type="math/tex">\mathcal{K}</script>)<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-247-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.212em; display: inline-block;" role="math" id="MathJax-Span-1939" class="math"><span style="display: inline-block; position: relative; width: 7.663em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.61em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1940" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1941" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1942" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1943" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1944" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1945" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1946" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1947" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1948" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1949" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1950" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1951" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-247" type="math/tex">F[0,\ldots,s-1]\leftarrow</script> <font style="font: normal verdana; font-variant: small-caps"> ConstructFSMAndL</font>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-248-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.541em; display: inline-block;" role="math" id="MathJax-Span-1952" class="math"><span style="display: inline-block; position: relative; width: 12.421em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1012.3em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1953" class="mrow"><span id="MathJax-Span-1954" class="texatom"><span id="MathJax-Span-1955" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-1956" class="mi">K</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1957" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1958" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1959" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1960" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1961" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1962" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1963" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-1964" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1965" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-1966" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1967" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1968" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1969" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1970" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1971" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-1972" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-1973" class="texatom"><span id="MathJax-Span-1974" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1975" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1976" class="mi">Σ</span><span id="MathJax-Span-1977" class="texatom"><span id="MathJax-Span-1978" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-1979" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-1980" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-248" type="math/tex">\mathcal{K},G[0,\ldots,s-1][1,\ldots, |\Sigma|] </script>) </font><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-249-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-1981" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.43em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1982" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1983" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1984" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1985" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-249" type="math/tex">j \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-250-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.226em; display: inline-block;" role="math" id="MathJax-Span-1986" class="math"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.34em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1987" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1988" class="mi">i</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1989" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-1990" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-250" type="math/tex">i \leftarrow 1</script> to <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-251-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.842em; display: inline-block;" role="math" id="MathJax-Span-1991" class="math"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.659em, 1000.6em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1992" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1993" class="mi">n</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.767em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script id="MathJax-Element-251" type="math/tex">n</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; while <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-252-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.062em; display: inline-block;" role="math" id="MathJax-Span-1994" class="math"><span style="display: inline-block; position: relative; width: 6.798em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.72em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-1995" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1996" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1997" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-1998" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-1999" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2000" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2001" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2002" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2003" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2004" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2005" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2006" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2007" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2008" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-252" type="math/tex">G[j][T[i]] = -1</script> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-253-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-2009" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.25em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2010" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2011" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2012" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2013" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-253" type="math/tex">j \geq 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-254-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-2014" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2015" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2016" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2017" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2018" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2019" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2020" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2021" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-254" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-255-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-2022" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1003.02em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2023" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2024" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2025" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2026" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2027" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-255" type="math/tex">j = -1</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-256-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-2028" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.43em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2029" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2030" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2031" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2032" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-256" type="math/tex">j \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-257-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.158em; display: inline-block;" role="math" id="MathJax-Span-2033" class="math"><span style="display: inline-block; position: relative; width: 6.118em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2034" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2035" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2036" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2037" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2038" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2039" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2040" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2041" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2042" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2043" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2044" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2045" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2046" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-257" type="math/tex">j \leftarrow G[j][T[i]]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <font color="red"><b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-258-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.788em; display: inline-block;" role="math" id="MathJax-Span-2047" class="math"><span style="display: inline-block; position: relative; width: 3.584em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.329em, 1003.54em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2048" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2049" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2050" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2051" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2052" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2053" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2054" class="mi">∅</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.524em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>≠</mo><mi mathvariant="normal">∅</mi></math></span></span><script id="MathJax-Element-258" type="math/tex">L[j] \not= \emptyset</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; print the keywords in <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-259-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-2055" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1001.61em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2056" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2057" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2058" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2059" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2060" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-259" type="math/tex">L[j]</script> and their positions in <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-260-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.925em; display: inline-block;" role="math" id="MathJax-Span-2061" class="math"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.424em, 1000.68em, 2.472em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2062" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2063" class="mi">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.065em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script id="MathJax-Element-260" type="math/tex">T</script></font><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-261-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.596em; display: inline-block;" role="math" id="MathJax-Span-2064" class="math"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.42em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2065" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2066" class="mi">j</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script id="MathJax-Element-261" type="math/tex">j</script> is a leaf<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-262-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-2067" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2068" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2069" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2070" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2071" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2072" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2073" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2074" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-262" type="math/tex">j \leftarrow F[j]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_913062" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// search keywords in array Keys in the text T</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the 2D char array holding keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// T:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the pointer to the text array</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// num_states:&nbsp; the number of states in the finite state machine, </code></div><div class="line number5 index4 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this parameter need not to be exact, you can input the maximum number of states</code></div><div class="line number6 index5 alt1"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keys in the keyword set</code></div><div class="line number7 index6 alt2"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet. </code></div><div class="line number8 index7 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">multi_pattern_search(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*T, </code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_states, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G = construct_trie_and_L(Keys, num_keys, num_states, alpb);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*F = construct_fsm_and_L(Keys,G, alpb, num_keys);</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 1;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">n = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(T) - 1; </code><code class="cpp comments">// characters in T are indexed from 1</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; i &lt;= n; i++){</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(j &gt;= 0 &amp;&amp; G[j][id(T[i])] == -1){</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = F[j];</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(j == -1) j = 0;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp plain">{</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = G[j][id(T[i])];</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(</code><code class="cpp functions bold">strlen</code><code class="cpp plain">(L[j]) &gt; 0){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the keyword found at state %d is: "</code><code class="cpp plain">, j);</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">print_char_arr(L[j]);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\n"</code><code class="cpp plain">);</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">keylen = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(L[j])-1; </code><code class="cpp comments">// ignore the first empty character</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the last pos of the text containing the keywords is:&nbsp; %d\n"</code><code class="cpp plain">, i);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(is_leaf(j, G, alpb)){</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = F[j];</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number33 index32 alt2"><code class="cpp plain">}</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="cpp comments">// check whether a state is a leaf of the Trie</code></div><div class="line number36 index35 alt1"><code class="cpp comments">// x:&nbsp;&nbsp; the state </code></div><div class="line number37 index36 alt2"><code class="cpp comments">// G:&nbsp;&nbsp; the Trie</code></div><div class="line number38 index37 alt1"><code class="cpp comments">// alpb:the size of the alphabet</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">is_leaf(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; j &lt; alpb; j++){</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(G[x][j] != -1){</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">1;</code></div><div class="line number48 index47 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Để tính mảng  <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-263-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.719em; display: inline-block;" role="math" id="MathJax-Span-2075" class="math"><span style="display: inline-block; position: relative; width: 7.292em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1007.17em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2076" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2077" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2078" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2079" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2080" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2081" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2082" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2083" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2084" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2085" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2086" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2087" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2088" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-263" type="math/tex">L[1,2,\ldots,s-1]</script>, ta sẽ sửa đổi thủ tục  <font style="font: normal verdana; font-variant: small-caps"> ConstructTrie</font> và <font style="font: normal verdana; font-variant: small-caps"> ConstructFSM</font> như sau:</p>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> ConstructTrieAndL</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-264-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-2089" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1000.71em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2090" class="mrow"><span id="MathJax-Span-2091" class="texatom"><span id="MathJax-Span-2092" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-2093" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-264" type="math/tex">\mathcal{K}</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-265-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-2094" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2095" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2096" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2097" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-265" type="math/tex">s\leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; set all entries of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-266-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 14.897em; display: inline-block;" role="math" id="MathJax-Span-2098" class="math"><span style="display: inline-block; position: relative; width: 11.185em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1011.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2099" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2100" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2101" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2102" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2103" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2104" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2105" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2106" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2107" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2108" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2109" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2110" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2111" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2112" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2113" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2114" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2115" class="texatom"><span id="MathJax-Span-2116" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2117" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2118" class="mi">Σ</span><span id="MathJax-Span-2119" class="texatom"><span id="MathJax-Span-2120" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2121" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2122" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-266" type="math/tex">G[0,\ldots, s-1][1,\ldots, |\Sigma|]</script> to <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-267-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.747em; display: inline-block;" role="math" id="MathJax-Span-2123" class="math"><span style="display: inline-block; position: relative; width: 1.298em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.373em, 1001.22em, 2.41em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2124" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2125" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2126" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.05em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-267" type="math/tex">-1</script><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-268-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.774em; display: inline-block;" role="math" id="MathJax-Span-2127" class="math"><span style="display: inline-block; position: relative; width: 4.326em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.29em, 2.494em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2128" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2129" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2130" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2131" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2132" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2133" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2134" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2135" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.079em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-268" type="math/tex">state \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp; <b>for each</b> key <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-269-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-2136" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.37em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2137" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2138" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2139" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2140" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2141" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2142" class="mn">2</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2143" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2144" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2145" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2146" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2147" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2148" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2149" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-269" type="math/tex">K[1,2,\ldots,m_i]</script> in <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-270-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.007em; display: inline-block;" role="math" id="MathJax-Span-2150" class="math"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.273em, 1000.71em, 2.37em, -1000em); top: -2.163em; left: 0em;"><span id="MathJax-Span-2151" class="mrow"><span id="MathJax-Span-2152" class="texatom"><span id="MathJax-Span-2153" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-2154" class="mi">K</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.163em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow></math></span></span><script id="MathJax-Element-270" type="math/tex">\mathcal{K}</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-271-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-2155" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.334em, 1002.43em, 2.432em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2156" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2157" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2158" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2159" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.111em; border-left: 0px solid; width: 0px; height: 1.131em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-271" type="math/tex">\ell \leftarrow 0</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-272-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.308em; display: inline-block;" role="math" id="MathJax-Span-2160" class="math"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.4em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2161" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2162" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2163" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2164" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-272" type="math/tex">j \leftarrow 1</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-273-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 9.473em; display: inline-block;" role="math" id="MathJax-Span-2165" class="math"><span style="display: inline-block; position: relative; width: 7.107em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1007.03em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2166" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2167" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2168" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2169" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2170" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2171" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2172" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2173" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2174" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2175" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2176" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2177" class="mo">≠</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2178" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2179" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>≠</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-273" type="math/tex">G[\ell][K[j]] \not= -1</script><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-274-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.568em; display: inline-block;" role="math" id="MathJax-Span-2180" class="math"><span style="display: inline-block; position: relative; width: 6.427em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.31em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2181" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2182" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2183" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2184" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2185" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2186" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2187" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2188" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2189" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2190" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2191" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2192" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2193" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-274" type="math/tex">\ell \leftarrow G[\ell][K[j]]</script>     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <i><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-275-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-2194" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.471em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2195" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2196" class="mo">≪</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≪</mo></math></span></span><script id="MathJax-Element-275" type="math/tex">\ll</script> go to the next state in the Trie <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-276-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-2197" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.472em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2198" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2199" class="mo">≫</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≫</mo></math></span></span><script id="MathJax-Element-276" type="math/tex">\gg</script></i><br>
    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-277-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-2200" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.07em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2201" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2202" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2203" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2204" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2205" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2206" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-277" type="math/tex">j\leftarrow j+1</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <b>while</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-278-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.966em; display: inline-block;" role="math" id="MathJax-Span-2207" class="math"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1002.97em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2208" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2209" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2210" class="mo">≤</span><span style="padding-left: 0.278em;" id="MathJax-Span-2211" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2212" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2213" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≤</mo><msub><mi>m</mi><mi>i</mi></msub></math></span></span><script id="MathJax-Element-278" type="math/tex">j \leq m_i</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-279-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 10.459em; display: inline-block;" role="math" id="MathJax-Span-2214" class="math"><span style="display: inline-block; position: relative; width: 7.848em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1007.78em, 2.554em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2215" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2216" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2217" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2218" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2219" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2220" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2221" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2222" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2223" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2224" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2225" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2226" class="mi">e</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2227" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2228" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.191em; border-left: 0px solid; width: 0px; height: 1.159em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-279" type="math/tex">state \leftarrow state + 1</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-280-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 11.034em; display: inline-block;" role="math" id="MathJax-Span-2229" class="math"><span style="display: inline-block; position: relative; width: 8.281em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.24em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2230" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2231" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2232" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2233" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2234" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2235" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2236" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2237" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2238" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2239" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2240" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2241" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2242" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2243" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2244" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2245" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2246" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></math></span></span><script id="MathJax-Element-280" type="math/tex">G[\ell][K[j]] \leftarrow state</script>      &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <i><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-281-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-2247" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.471em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2248" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2249" class="mo">≪</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≪</mo></math></span></span><script id="MathJax-Element-281" type="math/tex">\ll</script> attach the new state to the Trie <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-282-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-2250" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.472em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2251" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2252" class="mo">≫</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.008em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≫</mo></math></span></span><script id="MathJax-Element-282" type="math/tex">\gg</script></i><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-283-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.527em; display: inline-block;" role="math" id="MathJax-Span-2253" class="math"><span style="display: inline-block; position: relative; width: 4.14em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1004.07em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2254" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2255" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2256" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2257" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2258" class="mo">+</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2259" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script id="MathJax-Element-283" type="math/tex">j \leftarrow j+1</script><br>
    &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp;     &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-284-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.692em; display: inline-block;" role="math" id="MathJax-Span-2260" class="math"><span style="display: inline-block; position: relative; width: 4.264em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.396em, 1004.23em, 2.492em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2261" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2262" class="mi">ℓ</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2263" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2264" class="mi">s</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2265" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2266" class="mi">a</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2267" class="mi">t</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2268" class="mi">e</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.109em; border-left: 0px solid; width: 0px; height: 1.129em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi><mo stretchy="false">←</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></math></span></span><script id="MathJax-Element-284" type="math/tex">\ell \leftarrow state</script><br>
   &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="red"><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-285-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 13.007em; display: inline-block;" role="math" id="MathJax-Span-2269" class="math"><span style="display: inline-block; position: relative; width: 9.764em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1009.7em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2270" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2271" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2272" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2273" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2274" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2275" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2276" class="mo">{</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2277" class="mi">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2278" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2279" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2280" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2281" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2282" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2283" class="msubsup"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.86em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2284" class="mi">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.878em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2285" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2286" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2287" class="mo">}</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mo fence="false" stretchy="false">{</mo><mi>K</mi><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo fence="false" stretchy="false">}</mo></math></span></span><script id="MathJax-Element-285" type="math/tex">L[\ell] \leftarrow \{K[1,\ldots,m_i]\}</script></font>    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;<i><span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-286-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 1.336em; display: inline-block;" role="math" id="MathJax-Span-2288" class="math"><span style="display: inline-block; position: relative; width: 0.989em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.471em, 1000.93em, 2.477em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2289" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2290" class="mo">≪</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.171em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≪</mo></math></span></span><script id="MathJax-Element-286" type="math/tex">\ll</script> put the keyword to the list <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x226B;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-287-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.048em; display: inline-block;" role="math" id="MathJax-Span-2291" class="math"><span style="display: inline-block; position: relative; width: 3.028em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.97em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2292" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2293" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2294" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2295" class="mi">ℓ</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2296" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2297" class="mo">≫</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>ℓ</mi><mo stretchy="false">]</mo><mo>≫</mo></math></span></span><script id="MathJax-Element-287" type="math/tex">L[\ell] \gg</script></i><br>
    &nbsp;&nbsp;&nbsp;  return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-288-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 14.897em; display: inline-block;" role="math" id="MathJax-Span-2298" class="math"><span style="display: inline-block; position: relative; width: 11.185em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1011.07em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2299" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2300" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2301" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2302" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2303" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2304" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2305" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2306" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2307" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2308" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2309" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2310" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2311" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2312" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2313" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2314" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2315" class="texatom"><span id="MathJax-Span-2316" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2317" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2318" class="mi">Σ</span><span id="MathJax-Span-2319" class="texatom"><span id="MathJax-Span-2320" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2321" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2322" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-288" type="math/tex">G[0,\ldots,s-1][1,\ldots, |\Sigma|]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_785808" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// Construct the Trie and stores its structure in a 2D array</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the set of keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keywords in Keys</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// num_state:&nbsp;&nbsp; the number of states in the finite state machine, this parameter need not to be exact</code></div><div class="line number5 index4 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; any upper bound of this parameter is ok</code></div><div class="line number6 index5 alt1"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">**construct_trie_and_L(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_state, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">**)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(num_state*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">*));</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; i &lt; num_state; i++){</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G[i] = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(alpb*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">)); </code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memset</code><code class="cpp plain">(G[i],-1, alpb*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">));</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">state&nbsp; = 0;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 1;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 0; i &lt; num_keys; i++){</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">klen = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(Keys[i])-1; </code><code class="cpp comments">// -1 since each string is added a space char at the beginning</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">ell = 0;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j = 1;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(G[ell][id(Keys[i][j])] != -1){</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ell = G[ell][id(Keys[i][j])];</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j ++;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(j &lt;= klen){</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">state++;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">G[ell][id(Keys[i][j])] = state;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j++;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ell = state;</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"key '"</code><code class="cpp plain">);</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">print_char_arr(Keys[i]);</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"' is added to state %d\n"</code><code class="cpp plain">,ell);</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">L[ell] = (</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(MAX_STR_LEN);</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcat</code><code class="cpp plain">(L[ell], Keys[i]);</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">nstates = state+1;</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the numer of state is %d\n"</code><code class="cpp plain">, nstates);</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="cpp comments">// print out the Trie</code></div><div class="line number42 index41 alt1"><code class="cpp comments">//&nbsp; for(i = 0; i &lt; nstates; i++){</code></div><div class="line number43 index42 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(j = 0; j &lt; alpb; j++){</code></div><div class="line number44 index43 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d ", G[i][j]);</code></div><div class="line number45 index44 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</code></div><div class="line number46 index45 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\n");</code></div><div class="line number47 index46 alt2"><code class="cpp comments">//&nbsp; }</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">G;</code></div><div class="line number49 index48 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<div style="padding: 6px; color: black; background-color: white; border: black 2px solid;"><a id="partition"> <u style="font: normal verdana; font-variant: small-caps"> ConstructFSMAndL</u>(<span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-289-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 16.541em; display: inline-block;" role="math" id="MathJax-Span-2323" class="math"><span style="display: inline-block; position: relative; width: 12.421em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1012.3em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2324" class="mrow"><span id="MathJax-Span-2325" class="texatom"><span id="MathJax-Span-2326" class="mrow"><span style="font-family: MathJax_Caligraphic;" id="MathJax-Span-2327" class="mi">K</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2328" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2329" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2330" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2331" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2332" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2333" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2334" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2335" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2336" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2337" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2338" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2339" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2340" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2341" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2342" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2343" class="mo">,</span><span style="padding-left: 0.167em;" id="MathJax-Span-2344" class="texatom"><span id="MathJax-Span-2345" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2346" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2347" class="mi">Σ</span><span id="MathJax-Span-2348" class="texatom"><span id="MathJax-Span-2349" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2350" class="mo">|</span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2351" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">K</mi></mrow><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-289" type="math/tex">\mathcal{K}, G[0,\ldots,s-1][1,\ldots,|\Sigma|]</script>):</a> <font face="verdana"><br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-290-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.404em; display: inline-block;" role="math" id="MathJax-Span-2352" class="math"><span style="display: inline-block; position: relative; width: 1.792em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.59em, 1001.74em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2353" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2354" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2355" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 0.859em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-290" type="math/tex">s \leftarrow</script> the number of states<br>
   &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-291-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 6.267em; display: inline-block;" role="math" id="MathJax-Span-2356" class="math"><span style="display: inline-block; position: relative; width: 4.697em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1004.62em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2357" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2358" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2359" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2360" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2361" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2362" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2363" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2364" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-291" type="math/tex">F[0] \leftarrow -1</script><br>
   &nbsp;&nbsp;&nbsp; <b>for</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-292-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.39em; display: inline-block;" role="math" id="MathJax-Span-2365" class="math"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1002.46em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2366" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2367" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2368" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2369" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.102em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">←</mo><mn>1</mn></math></span></span><script id="MathJax-Element-292" type="math/tex">d \leftarrow 1</script> to max depth<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>for each</b> state <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-293-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-2370" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2371" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2372" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-293" type="math/tex">i</script> at depth <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-294-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.678em; display: inline-block;" role="math" id="MathJax-Span-2373" class="math"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.407em, 1000.49em, 2.482em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2374" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2375" class="mi">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.101em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script id="MathJax-Element-294" type="math/tex">d</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-295-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.322em; display: inline-block;" role="math" id="MathJax-Span-2376" class="math"><span style="display: inline-block; position: relative; width: 1.73em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1001.67em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2377" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2378" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2379" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-295" type="math/tex">j \leftarrow</script> parent of <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-296-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 0.514em; display: inline-block;" role="math" id="MathJax-Span-2380" class="math"><span style="display: inline-block; position: relative; width: 0.371em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.44em, 1000.33em, 2.483em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2381" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2382" class="mi">i</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.097em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script id="MathJax-Element-296" type="math/tex">i</script> in the Trie<br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-297-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.733em; display: inline-block;" role="math" id="MathJax-Span-2383" class="math"><span style="display: inline-block; position: relative; width: 2.039em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.528em, 1001.98em, 2.568em, -1000em); top: -2.225em; left: 0em;"><span id="MathJax-Span-2384" class="mrow"><span id="MathJax-Span-2385" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2386" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2387" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2388" class="mo">←</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.292em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">←</mo></math></span></span><script id="MathJax-Element-297" type="math/tex">c_i \leftarrow</script>  the label of the edge <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-298-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-2389" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1002.99em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2390" class="mrow"><span style="font-family: MathJax_Main;" id="MathJax-Span-2391" class="mo">(</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2392" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2393" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2394" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2395" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">←</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-298" type="math/tex">(j \leftarrow i)</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-299-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-2396" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2397" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2398" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2399" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2400" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2401" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2402" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2403" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-299" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>while <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-300-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 7.829em; display: inline-block;" role="math" id="MathJax-Span-2404" class="math"><span style="display: inline-block; position: relative; width: 5.871em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1005.8em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2405" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2406" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2407" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2408" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2409" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2410" class="mo">[</span><span id="MathJax-Span-2411" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2412" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2413" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2414" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2415" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2416" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2417" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-300" type="math/tex">G[j][c_i] = -1</script> and <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-301-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 3.062em; display: inline-block;" role="math" id="MathJax-Span-2418" class="math"><span style="display: inline-block; position: relative; width: 2.287em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1002.25em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2419" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2420" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2421" class="mo">≥</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2422" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≥</mo><mn>0</mn></math></span></span><script id="MathJax-Element-301" type="math/tex">j \geq 0</script></b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-302-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-2423" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.65em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2424" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2425" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2426" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2427" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2428" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2429" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2430" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo stretchy="false">←</mo><mi>F</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-302" type="math/tex">j \leftarrow F[j]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>if</b> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-303-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 4.13em; display: inline-block;" role="math" id="MathJax-Span-2431" class="math"><span style="display: inline-block; position: relative; width: 3.09em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.435em, 1003.02em, 2.676em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2432" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2433" class="mi">j</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2434" class="mo">=</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2435" class="mo">−</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2436" class="mn">1</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.321em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id="MathJax-Element-303" type="math/tex">j = -1</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-304-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 5.034em; display: inline-block;" role="math" id="MathJax-Span-2437" class="math"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1003.73em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2438" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2439" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2440" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2441" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2442" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2443" class="mo">←</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2444" class="mn">0</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mn>0</mn></math></span></span><script id="MathJax-Element-304" type="math/tex">F[i] \leftarrow 0</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <b>else</b><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp; <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-305-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.651em; display: inline-block;" role="math" id="MathJax-Span-2445" class="math"><span style="display: inline-block; position: relative; width: 6.489em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.37em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2446" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2447" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2448" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2449" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2450" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2451" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2452" class="mi">G</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2453" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2454" class="mi">j</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2455" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2456" class="mo">[</span><span id="MathJax-Span-2457" class="msubsup"><span style="display: inline-block; position: relative; width: 0.752em; height: 0px;"><span style="position: absolute; clip: rect(3.389em, 1000.43em, 4.213em, -1000em); top: -4.017em; left: 0em;"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2458" class="mi">c</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.867em; left: 0.433em;"><span style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2459" class="mi">i</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2460" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>G</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-305" type="math/tex">F[i] \leftarrow G[j][c_i]</script><br>
   &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;<font color="red"> <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-306-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 12.021em; display: inline-block;" role="math" id="MathJax-Span-2461" class="math"><span style="display: inline-block; position: relative; width: 9.023em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1008.9em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2462" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2463" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2464" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2465" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2466" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2467" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2468" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2469" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2470" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2471" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2472" class="mo">∪</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2473" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2474" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2475" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2476" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2477" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2478" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2479" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>∪</mo><mi>L</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-306" type="math/tex">L[i] \leftarrow L[i] \cup L[F[i]]</script> </font><br>
   &nbsp;&nbsp;&nbsp;  return <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-307-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 8.486em; display: inline-block;" role="math" id="MathJax-Span-2480" class="math"><span style="display: inline-block; position: relative; width: 6.365em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.351em, 1006.25em, 2.722em, -1000em); top: -2.287em; left: 0em;"><span id="MathJax-Span-2481" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2482" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2483" class="mo">[</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2484" class="mn">0</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2485" class="mo">,</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2486" class="mo">…</span><span style="font-family: MathJax_Main; padding-left: 0.167em;" id="MathJax-Span-2487" class="mo">,</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;" id="MathJax-Span-2488" class="mi">s</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2489" class="mo">−</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2490" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2491" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.287em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-307" type="math/tex">F[0,\ldots,s-1]</script><br>
 </font>
</div>
<p>&nbsp;<br>
Code C:</p>
<div><div id="highlighter_717247" class="syntaxhighlighter   cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// Construct the finite state machine for the set of keywords</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// Keys:&nbsp;&nbsp;&nbsp; the set of keywords</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// G:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the 2D array represents the Trie for the keyword set Keys</code></div><div class="line number4 index3 alt1"><code class="cpp comments">// alpb:&nbsp;&nbsp;&nbsp; the size of the alphabet</code></div><div class="line number5 index4 alt2"><code class="cpp comments">// num_keys:&nbsp;&nbsp;&nbsp; the number of keys in the keyword set Keys</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">*construct_fsm_and_L(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">**Keys, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">**G, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">alpb, </code><code class="cpp color1 bold">int</code> <code class="cpp plain">num_keys){</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*F;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F = (</code><code class="cpp color1 bold">int</code> <code class="cpp plain">*)</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(nstates*</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code><code class="cpp plain">));</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[0] = -1;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">enqueue(0);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(is_empty() == 0){</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = dequeue();</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">c = 0;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(; c &lt; alpb; c++){</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(G[j] != -1){</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// j is the parent of i</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">i = G[j];</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">k = F[j];</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(k &gt;= 0 &amp;&amp; G[k] == -1){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">k&nbsp; = F[k];</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(k == -1){</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[i] = 0;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(L[i] == NULL) L[i] = (</code><code class="cpp color1 bold">char</code><code class="cpp plain">*) </code><code class="cpp functions bold">malloc</code><code class="cpp plain">(MAX_STR_LEN);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">else</code><code class="cpp plain">{</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">F[i] = G[k];</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// union L[i] and L[F[i]]</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(L[i] == NULL) L[i] = (</code><code class="cpp color1 bold">char</code><code class="cpp plain">*) </code><code class="cpp functions bold">malloc</code><code class="cpp plain">(MAX_STR_LEN);</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">len2 = </code><code class="cpp functions bold">strlen</code><code class="cpp plain">(L[F[i]]);</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(len2 != 0){</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcat</code><code class="cpp plain">(L[i],</code><code class="cpp string">","</code><code class="cpp plain">);</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcat</code><code class="cpp plain">(L[i], L[F[i]]);</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">enqueue(i);</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp comments">// end while</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"the failure array: \n"</code><code class="cpp plain">);</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i = 0; i &lt; nstates; i++){</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d "</code><code class="cpp plain">, F[i]);</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\n"</code><code class="cpp plain">);</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">F;</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Sử dụng danh sách liên kết, ta có thể thực hiên <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-308-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 12.021em; display: inline-block;" role="math" id="MathJax-Span-2492" class="math"><span style="display: inline-block; position: relative; width: 9.023em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1008.9em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2493" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2494" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2495" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2496" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2497" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.278em;" id="MathJax-Span-2498" class="mo">←</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;" id="MathJax-Span-2499" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2500" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2501" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2502" class="mo">]</span><span style="font-family: MathJax_Main; padding-left: 0.222em;" id="MathJax-Span-2503" class="mo">∪</span><span style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;" id="MathJax-Span-2504" class="mi">L</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2505" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2506" class="mi">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="font-family: MathJax_Main;" id="MathJax-Span-2507" class="mo">[</span><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2508" class="mi">i</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2509" class="mo">]</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2510" class="mo">]</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mi>L</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>∪</mo><mi>L</mi><mo stretchy="false">[</mo><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script id="MathJax-Element-308" type="math/tex">L[i] \leftarrow L[i] \cup L[F[i]]</script>  trong thời gian <span style="color: inherit;" class="MathJax_Preview"></span><span role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" style="position: relative;" tabindex="0" id="MathJax-Element-309-Frame" class="MathJax"><nobr aria-hidden="true"><span style="width: 2.651em; display: inline-block;" role="math" id="MathJax-Span-2511" class="math"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; font-size: 133%;"><span style="position: absolute; clip: rect(1.413em, 1001.88em, 2.784em, -1000em); top: -2.348em; left: 0em;"><span id="MathJax-Span-2512" class="mrow"><span style="font-family: MathJax_Math; font-style: italic;" id="MathJax-Span-2513" class="mi">O</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2514" class="mo">(</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2515" class="mn">1</span><span style="font-family: MathJax_Main;" id="MathJax-Span-2516" class="mo">)</span></span><span style="display: inline-block; width: 0px; height: 2.348em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.415em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span role="presentation" class="MJX_Assistive_MathML"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script id="MathJax-Element-309" type="math/tex">O(1)</script>. Từ đó ta suy ra Theorem 1.</p>
<p>Code của bài viết: <a href="http://www.giaithuatlaptrinh.com/wp-content/uploads/2016/01/ac_ind_mult_pat.c" target="_blank">aho-corasick with independent keywords</a>,<a href="http://www.giaithuatlaptrinh.com/wp-content/uploads/2016/01/ac_mult_pat.c" target="_blank"> aho-corasick with non-indenpendent keywords</a>.</p>
<p><strong><font size="4">Tham khảo</font> </strong></p>
<p>[1] Aho, Alfred V., and Margaret J. Corasick. <i>Efficient string matching: an aid to bibliographic search </i>. Communications of the ACM 18.6 (1975): 333-340. </p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-703" class="share-twitter sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=703&amp;share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-703" class="share-facebook sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=703&amp;share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-703" class="share-google-plus-1 sd-button share-icon no-text" href="http://www.giaithuatlaptrinh.com/?p=703&amp;share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span></span><span class="sharing-screen-reader-text">Click to share on Google+ (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div style="display: block;" id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="112" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="0" data-origin="703" rel="nofollow" title="Quy hoạch động -- Dynamic Programming IV

Trong bài này chúng ta sẽ thảo luận bài toán xây dựng cây nhị phân tìm kiếm tối ưu. Chúng ta cũng thảo luận giải thuật cuả Knuth trong bài toán này. Ý tưởng của Knuth sau này được Yao[4] mở rộng với trường hợp Bất Đẳng Thức Hình Chữ…" href="http://www.giaithuatlaptrinh.com/?p=112" class="jp-relatedposts-post-a">Quy hoạch động -- Dynamic Programming IV</a></span><span class="jp-relatedposts-post-date">June 6, 2015</span><span class="jp-relatedposts-post-context">In "binary search tree"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="420" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="1" data-origin="703" rel="nofollow" title="Cây hậu tố -- Suffix Tree

Trong bài trước ta đã tìm hiểu các thuật toán tìm kiếm xâu với thời gian $$O(n+m)$$ trong đó $$n$$ là độ dài của văn bản và $$m$$ là độ dài của xâu tìm kiếm. Mỗi thuật toán có đặc tính và ứng dụng riêng [2]: thuật toán Z là…" href="http://www.giaithuatlaptrinh.com/?p=420" class="jp-relatedposts-post-a">Cây hậu tố -- Suffix Tree</a></span><span class="jp-relatedposts-post-date">August 18, 2015</span><span class="jp-relatedposts-post-context">In "string matching"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="290" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="2" data-origin="703" rel="nofollow" title="Thuật toán Rabin-Karp--- Rabin-Karp algorithm

Trong bài này chúng ta sẽ tìm hiểu thuật toán Rabin-Karp áp dụng trong bài toán tìm kiếm xâu. Thuật toán được phát triển bởi Richard Karp và Michael Rabin [1] vào năm 1987. Ý tưởng trung tâm của thuật toán là coi mỗi xâu là một số nguyên và…" href="http://www.giaithuatlaptrinh.com/?p=290" class="jp-relatedposts-post-a">Thuật toán Rabin-Karp--- Rabin-Karp algorithm</a></span><span class="jp-relatedposts-post-date">August 4, 2015</span><span class="jp-relatedposts-post-context">In "Rabin Karp"</span></p></div></div>                    </div>
                    
                    <p class="tagdata"><strong>Tags:</strong> <a href="http://www.giaithuatlaptrinh.com/?tag=aho-corasick" rel="tag">aho-corasick</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=finite-state-machine" rel="tag">finite-state machine</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=knuth" rel="tag">Knuth</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=linear-time-algorithm" rel="tag">linear time algorithm</a>, <a href="http://www.giaithuatlaptrinh.com/?tag=string-matching" rel="tag">string matching</a></p>
                
                </div> <!-- /entry -->
            
                    
            
        
        <div id="comments-header">
        <div class="clearfix">
            <h2 class="title">No comments</h2>
                      <p class="comments-feed"><a href="http://www.giaithuatlaptrinh.com/?feed=rss2&amp;p=703">Comments feed for this article</a></p>
                    </div>
                  <p class="trackback-link">Trackback link: <a href="http://www.giaithuatlaptrinh.com/wp-trackback.php?p=703">http://www.giaithuatlaptrinh.com/wp-trackback.php?p=703</a></p>
            </div>
    
            				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.giaithuatlaptrinh.com/?p=703#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="http://www.giaithuatlaptrinh.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>    <div class="response textarea-wrap">
        <label for="comment">Your comment</label>
        <textarea name="comment" id="comment" cols="60" rows="10" aria-required="true" aria-multiline="true"></textarea>
    </div><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="703" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="e91b7b24d5" type="hidden"></p><p class="comment-subscription-form"><input name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1465414664387" type="hidden"></form>
					</div><!-- #respond -->
		    </div>

<div id="sidebar" class="secondary">

        
</div>
</div> <!-- /main content -->



<div id="footer" class="clearfix">
    
    <div class="secondary">
        
                
    </div> <!-- /secondary -->
    
    <div class="primary">
        
                
    </div> <!-- /primary -->
    
    <div id="theme-info" class="clearfix">
        
        <div class="secondary">
    <p><a class="feed" href="http://www.giaithuatlaptrinh.com/?feed=rss2">Subscribe to feed</a></p>
</div><div class="primary content">
    <p>Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://tarskitheme.com/">Tarski</a></p>
</div>
        
    </div> <!-- /theme-info -->
    
</div> <!-- /footer -->

</div><script type="text/x-mathjax-config;executed=true"> 
        MathJax.Hub.Config({ 
                TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}}, 
                "HTML-CSS": {linebreaks: {automatic: true}}, 
                SVG: {linebreaks: {automatic: true}}
        }); 
</script><script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/MathJax.js">MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>	<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/www.giaithuatlaptrinh.com\/?p=703":703};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/form.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/shCore.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/shBrushCpp.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.giaithuatlaptrinh.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/photon.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_add_to_cart_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=703&wc-ajax=%%endpoint%%","i18n_view_cart":"View Cart","cart_url":"","is_cart":"","cart_redirect_after_add":"no"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/add-to-cart.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jquery_003.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var woocommerce_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=703&wc-ajax=%%endpoint%%"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/woocommerce.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wc_cart_fragments_params = {"ajax_url":"\/wp-admin\/admin-ajax.php","wc_ajax_url":"\/?p=703&wc-ajax=%%endpoint%%","fragment_name":"wc_fragments"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/cart-fragments.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/devicepx-jetpack.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/wpgroho.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/comment-reply.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/wp-embed.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/sharing.js"></script>
<script type="text/javascript" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/e-201623.js" async="" defer="defer"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.0.3',blog:'97171708',post:'703',tz:'0',srv:'www.giaithuatlaptrinh.com'} ]);
	_stq.push([ 'clickTrackerInit', '97171708', '703' ]);
</script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1,sans-serif;" id="MathJax_Font_Test"></div></div><img id="wpstats" alt=":)" src="Gi%E1%BA%A3i%20Thu%E1%BA%ADt%20L%E1%BA%ADp%20Tr%C3%ACnh%20%C2%B7%20T%C3%ACm%20ki%E1%BA%BFm%20%C4%91a%20m%E1%BA%ABu%20b%E1%BA%B1ng%20thu%E1%BA%ADt%20to%C3%A1n%20Aho-Corasick%20%E2%80%94%20Aho-Corasick%20Algorithm_files/g.gif" width="6" height="5"></body></html>